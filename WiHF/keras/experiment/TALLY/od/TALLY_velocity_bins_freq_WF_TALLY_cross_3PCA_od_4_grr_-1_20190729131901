argsï¼š Namespace(datasource='wf_tally_slice', domaintype=3, envdomain=1, gesturelist=[1, 2, 3, 4, 5, 6], gpuloadratio=0.2, gradientreversalrate=-1.0, instancelist=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10], matlabname=['velocity_bins_freq'], mode='train', nettype='WF_TALLY_cross', numberofpath=5, orientationdomain=4, pathtype='TALLY', patience=10, pcalist=[0, 1, 2], positiondomain=4, receiverlist=[0, 1, 2, 3, 4, 5], serverset='remote', sizeoffeature=64, targettype=1, timelimit=58, traintestratio=0.8, userlist=[1, 2, 3, 4, 5, 6], yaxislength=20)
ed:  [1, 2, 3, 4, 5, 6] pd:  [1, 2, 3, 4, 5] od:  [1, 2, 3, 4, 5]
Loading Data...
domain_type: 3
Loaded Data wf_tally_slice 2 (7200, 29, 6, 20, 3) 4 (7200, 6) 2 (1800, 29, 6, 20, 3)
n_timesteps: 29
Train on 6480 samples, validate on 720 samples
Epoch 1/1000
 - 24s - loss: 3.2725 - classifier_output_aux_loss: 1.6097 - classifier_output_main_loss: 1.6628 - classifier_output_aux_acc: 0.3157 - classifier_output_main_acc: 0.2761 - val_loss: 3.1004 - val_classifier_output_aux_loss: 1.5856 - val_classifier_output_main_loss: 1.5148 - val_classifier_output_aux_acc: 0.3847 - val_classifier_output_main_acc: 0.3722
Epoch 2/1000
 - 56s - loss: 2.6940 - classifier_output_aux_loss: 1.3350 - classifier_output_main_loss: 1.3590 - classifier_output_aux_acc: 0.4719 - classifier_output_main_acc: 0.4670 - val_loss: 2.2429 - val_classifier_output_aux_loss: 1.1224 - val_classifier_output_main_loss: 1.1205 - val_classifier_output_aux_acc: 0.5722 - val_classifier_output_main_acc: 0.5764
Epoch 3/1000
 - 51s - loss: 2.2798 - classifier_output_aux_loss: 1.0929 - classifier_output_main_loss: 1.1868 - classifier_output_aux_acc: 0.5844 - classifier_output_main_acc: 0.5492 - val_loss: 1.9550 - val_classifier_output_aux_loss: 0.9289 - val_classifier_output_main_loss: 1.0261 - val_classifier_output_aux_acc: 0.6528 - val_classifier_output_main_acc: 0.6375
Epoch 4/1000
 - 48s - loss: 1.9574 - classifier_output_aux_loss: 0.9441 - classifier_output_main_loss: 1.0133 - classifier_output_aux_acc: 0.6434 - classifier_output_main_acc: 0.6227 - val_loss: 1.6604 - val_classifier_output_aux_loss: 0.7296 - val_classifier_output_main_loss: 0.9308 - val_classifier_output_aux_acc: 0.7194 - val_classifier_output_main_acc: 0.6375
Epoch 5/1000
 - 22s - loss: 1.6869 - classifier_output_aux_loss: 0.8130 - classifier_output_main_loss: 0.8739 - classifier_output_aux_acc: 0.6966 - classifier_output_main_acc: 0.6782 - val_loss: 1.4436 - val_classifier_output_aux_loss: 0.6802 - val_classifier_output_main_loss: 0.7634 - val_classifier_output_aux_acc: 0.7347 - val_classifier_output_main_acc: 0.7264
Epoch 6/1000
 - 22s - loss: 1.4344 - classifier_output_aux_loss: 0.7008 - classifier_output_main_loss: 0.7335 - classifier_output_aux_acc: 0.7434 - classifier_output_main_acc: 0.7347 - val_loss: 1.1895 - val_classifier_output_aux_loss: 0.5473 - val_classifier_output_main_loss: 0.6422 - val_classifier_output_aux_acc: 0.7958 - val_classifier_output_main_acc: 0.7708
Epoch 7/1000
 - 97s - loss: 1.2331 - classifier_output_aux_loss: 0.6188 - classifier_output_main_loss: 0.6143 - classifier_output_aux_acc: 0.7694 - classifier_output_main_acc: 0.7813 - val_loss: 1.0517 - val_classifier_output_aux_loss: 0.5374 - val_classifier_output_main_loss: 0.5143 - val_classifier_output_aux_acc: 0.8014 - val_classifier_output_main_acc: 0.8264
Epoch 8/1000
 - 90s - loss: 1.0755 - classifier_output_aux_loss: 0.5539 - classifier_output_main_loss: 0.5216 - classifier_output_aux_acc: 0.7965 - classifier_output_main_acc: 0.8181 - val_loss: 0.9889 - val_classifier_output_aux_loss: 0.4839 - val_classifier_output_main_loss: 0.5050 - val_classifier_output_aux_acc: 0.8319 - val_classifier_output_main_acc: 0.8153
Epoch 9/1000
 - 75s - loss: 0.9206 - classifier_output_aux_loss: 0.4724 - classifier_output_main_loss: 0.4482 - classifier_output_aux_acc: 0.8309 - classifier_output_main_acc: 0.8400 - val_loss: 0.8326 - val_classifier_output_aux_loss: 0.4304 - val_classifier_output_main_loss: 0.4022 - val_classifier_output_aux_acc: 0.8472 - val_classifier_output_main_acc: 0.8611
Epoch 10/1000
 - 26s - loss: 0.8449 - classifier_output_aux_loss: 0.4355 - classifier_output_main_loss: 0.4095 - classifier_output_aux_acc: 0.8438 - classifier_output_main_acc: 0.8566 - val_loss: 0.8880 - val_classifier_output_aux_loss: 0.3760 - val_classifier_output_main_loss: 0.5120 - val_classifier_output_aux_acc: 0.8625 - val_classifier_output_main_acc: 0.8222
Epoch 11/1000
 - 22s - loss: 0.7520 - classifier_output_aux_loss: 0.4117 - classifier_output_main_loss: 0.3403 - classifier_output_aux_acc: 0.8548 - classifier_output_main_acc: 0.8816 - val_loss: 0.6411 - val_classifier_output_aux_loss: 0.3433 - val_classifier_output_main_loss: 0.2978 - val_classifier_output_aux_acc: 0.8764 - val_classifier_output_main_acc: 0.9111
Epoch 12/1000
 - 22s - loss: 0.6672 - classifier_output_aux_loss: 0.3537 - classifier_output_main_loss: 0.3135 - classifier_output_aux_acc: 0.8779 - classifier_output_main_acc: 0.8932 - val_loss: 0.6287 - val_classifier_output_aux_loss: 0.3904 - val_classifier_output_main_loss: 0.2383 - val_classifier_output_aux_acc: 0.8597 - val_classifier_output_main_acc: 0.9250
Epoch 13/1000
 - 45s - loss: 0.5750 - classifier_output_aux_loss: 0.3114 - classifier_output_main_loss: 0.2636 - classifier_output_aux_acc: 0.8910 - classifier_output_main_acc: 0.9148 - val_loss: 0.7475 - val_classifier_output_aux_loss: 0.4926 - val_classifier_output_main_loss: 0.2549 - val_classifier_output_aux_acc: 0.8236 - val_classifier_output_main_acc: 0.9194
Epoch 14/1000
 - 52s - loss: 0.5744 - classifier_output_aux_loss: 0.3149 - classifier_output_main_loss: 0.2595 - classifier_output_aux_acc: 0.8880 - classifier_output_main_acc: 0.9156 - val_loss: 0.5943 - val_classifier_output_aux_loss: 0.3584 - val_classifier_output_main_loss: 0.2359 - val_classifier_output_aux_acc: 0.8889 - val_classifier_output_main_acc: 0.9194
Epoch 15/1000
 - 48s - loss: 0.4885 - classifier_output_aux_loss: 0.2768 - classifier_output_main_loss: 0.2118 - classifier_output_aux_acc: 0.9049 - classifier_output_main_acc: 0.9284 - val_loss: 0.4776 - val_classifier_output_aux_loss: 0.2618 - val_classifier_output_main_loss: 0.2158 - val_classifier_output_aux_acc: 0.9069 - val_classifier_output_main_acc: 0.9278
Epoch 16/1000
 - 30s - loss: 0.4723 - classifier_output_aux_loss: 0.2589 - classifier_output_main_loss: 0.2134 - classifier_output_aux_acc: 0.9102 - classifier_output_main_acc: 0.9281 - val_loss: 0.5135 - val_classifier_output_aux_loss: 0.2721 - val_classifier_output_main_loss: 0.2414 - val_classifier_output_aux_acc: 0.9111 - val_classifier_output_main_acc: 0.9250
Epoch 17/1000
 - 23s - loss: 0.4290 - classifier_output_aux_loss: 0.2392 - classifier_output_main_loss: 0.1897 - classifier_output_aux_acc: 0.9174 - classifier_output_main_acc: 0.9380 - val_loss: 0.5026 - val_classifier_output_aux_loss: 0.3132 - val_classifier_output_main_loss: 0.1893 - val_classifier_output_aux_acc: 0.8958 - val_classifier_output_main_acc: 0.9389
Epoch 18/1000
 - 51s - loss: 0.3703 - classifier_output_aux_loss: 0.2062 - classifier_output_main_loss: 0.1640 - classifier_output_aux_acc: 0.9290 - classifier_output_main_acc: 0.9441 - val_loss: 0.5186 - val_classifier_output_aux_loss: 0.3602 - val_classifier_output_main_loss: 0.1584 - val_classifier_output_aux_acc: 0.8931 - val_classifier_output_main_acc: 0.9333
Epoch 19/1000
 - 54s - loss: 0.3647 - classifier_output_aux_loss: 0.2108 - classifier_output_main_loss: 0.1539 - classifier_output_aux_acc: 0.9282 - classifier_output_main_acc: 0.9508 - val_loss: 0.4626 - val_classifier_output_aux_loss: 0.2834 - val_classifier_output_main_loss: 0.1792 - val_classifier_output_aux_acc: 0.9139 - val_classifier_output_main_acc: 0.9458
Epoch 20/1000
 - 55s - loss: 0.3527 - classifier_output_aux_loss: 0.2001 - classifier_output_main_loss: 0.1526 - classifier_output_aux_acc: 0.9335 - classifier_output_main_acc: 0.9519 - val_loss: 0.3870 - val_classifier_output_aux_loss: 0.2193 - val_classifier_output_main_loss: 0.1677 - val_classifier_output_aux_acc: 0.9250 - val_classifier_output_main_acc: 0.9431
Epoch 21/1000
 - 54s - loss: 0.3161 - classifier_output_aux_loss: 0.1799 - classifier_output_main_loss: 0.1362 - classifier_output_aux_acc: 0.9418 - classifier_output_main_acc: 0.9563 - val_loss: 0.5755 - val_classifier_output_aux_loss: 0.4302 - val_classifier_output_main_loss: 0.1453 - val_classifier_output_aux_acc: 0.8778 - val_classifier_output_main_acc: 0.9653
Epoch 22/1000
 - 54s - loss: 0.2909 - classifier_output_aux_loss: 0.1663 - classifier_output_main_loss: 0.1247 - classifier_output_aux_acc: 0.9452 - classifier_output_main_acc: 0.9620 - val_loss: 0.3973 - val_classifier_output_aux_loss: 0.2376 - val_classifier_output_main_loss: 0.1597 - val_classifier_output_aux_acc: 0.9333 - val_classifier_output_main_acc: 0.9569
Epoch 23/1000
 - 54s - loss: 0.2815 - classifier_output_aux_loss: 0.1588 - classifier_output_main_loss: 0.1227 - classifier_output_aux_acc: 0.9480 - classifier_output_main_acc: 0.9610 - val_loss: 0.6139 - val_classifier_output_aux_loss: 0.3780 - val_classifier_output_main_loss: 0.2358 - val_classifier_output_aux_acc: 0.9000 - val_classifier_output_main_acc: 0.9319
Epoch 24/1000
 - 51s - loss: 0.2740 - classifier_output_aux_loss: 0.1553 - classifier_output_main_loss: 0.1187 - classifier_output_aux_acc: 0.9506 - classifier_output_main_acc: 0.9610 - val_loss: 0.3515 - val_classifier_output_aux_loss: 0.2237 - val_classifier_output_main_loss: 0.1278 - val_classifier_output_aux_acc: 0.9319 - val_classifier_output_main_acc: 0.9569
Epoch 25/1000
 - 22s - loss: 0.2374 - classifier_output_aux_loss: 0.1265 - classifier_output_main_loss: 0.1109 - classifier_output_aux_acc: 0.9588 - classifier_output_main_acc: 0.9636 - val_loss: 0.3401 - val_classifier_output_aux_loss: 0.2020 - val_classifier_output_main_loss: 0.1381 - val_classifier_output_aux_acc: 0.9500 - val_classifier_output_main_acc: 0.9639
Epoch 26/1000
 - 22s - loss: 0.2497 - classifier_output_aux_loss: 0.1386 - classifier_output_main_loss: 0.1111 - classifier_output_aux_acc: 0.9557 - classifier_output_main_acc: 0.9656 - val_loss: 0.3880 - val_classifier_output_aux_loss: 0.2432 - val_classifier_output_main_loss: 0.1449 - val_classifier_output_aux_acc: 0.9375 - val_classifier_output_main_acc: 0.9569
Epoch 27/1000
 - 22s - loss: 0.2181 - classifier_output_aux_loss: 0.1287 - classifier_output_main_loss: 0.0894 - classifier_output_aux_acc: 0.9573 - classifier_output_main_acc: 0.9715 - val_loss: 0.3610 - val_classifier_output_aux_loss: 0.2171 - val_classifier_output_main_loss: 0.1439 - val_classifier_output_aux_acc: 0.9444 - val_classifier_output_main_acc: 0.9583
Epoch 28/1000
 - 22s - loss: 0.2267 - classifier_output_aux_loss: 0.1188 - classifier_output_main_loss: 0.1079 - classifier_output_aux_acc: 0.9623 - classifier_output_main_acc: 0.9671 - val_loss: 0.3143 - val_classifier_output_aux_loss: 0.2023 - val_classifier_output_main_loss: 0.1120 - val_classifier_output_aux_acc: 0.9472 - val_classifier_output_main_acc: 0.9569
Epoch 29/1000
 - 22s - loss: 0.2024 - classifier_output_aux_loss: 0.1204 - classifier_output_main_loss: 0.0820 - classifier_output_aux_acc: 0.9639 - classifier_output_main_acc: 0.9728 - val_loss: 0.4188 - val_classifier_output_aux_loss: 0.2557 - val_classifier_output_main_loss: 0.1631 - val_classifier_output_aux_acc: 0.9319 - val_classifier_output_main_acc: 0.9542
Epoch 30/1000
 - 22s - loss: 0.2202 - classifier_output_aux_loss: 0.1273 - classifier_output_main_loss: 0.0928 - classifier_output_aux_acc: 0.9611 - classifier_output_main_acc: 0.9694 - val_loss: 0.4108 - val_classifier_output_aux_loss: 0.2784 - val_classifier_output_main_loss: 0.1325 - val_classifier_output_aux_acc: 0.9222 - val_classifier_output_main_acc: 0.9653
Epoch 31/1000
 - 22s - loss: 0.1811 - classifier_output_aux_loss: 0.1000 - classifier_output_main_loss: 0.0811 - classifier_output_aux_acc: 0.9684 - classifier_output_main_acc: 0.9748 - val_loss: 0.3632 - val_classifier_output_aux_loss: 0.2152 - val_classifier_output_main_loss: 0.1480 - val_classifier_output_aux_acc: 0.9583 - val_classifier_output_main_acc: 0.9681
Epoch 32/1000
 - 22s - loss: 0.1849 - classifier_output_aux_loss: 0.1034 - classifier_output_main_loss: 0.0815 - classifier_output_aux_acc: 0.9636 - classifier_output_main_acc: 0.9762 - val_loss: 0.3057 - val_classifier_output_aux_loss: 0.1663 - val_classifier_output_main_loss: 0.1394 - val_classifier_output_aux_acc: 0.9528 - val_classifier_output_main_acc: 0.9653
Epoch 33/1000
 - 22s - loss: 0.1723 - classifier_output_aux_loss: 0.1056 - classifier_output_main_loss: 0.0667 - classifier_output_aux_acc: 0.9664 - classifier_output_main_acc: 0.9776 - val_loss: 0.2871 - val_classifier_output_aux_loss: 0.1787 - val_classifier_output_main_loss: 0.1084 - val_classifier_output_aux_acc: 0.9472 - val_classifier_output_main_acc: 0.9708
Epoch 34/1000
 - 22s - loss: 0.1879 - classifier_output_aux_loss: 0.0993 - classifier_output_main_loss: 0.0886 - classifier_output_aux_acc: 0.9656 - classifier_output_main_acc: 0.9725 - val_loss: 0.3046 - val_classifier_output_aux_loss: 0.1969 - val_classifier_output_main_loss: 0.1076 - val_classifier_output_aux_acc: 0.9431 - val_classifier_output_main_acc: 0.9653
Epoch 35/1000
 - 22s - loss: 0.1822 - classifier_output_aux_loss: 0.1029 - classifier_output_main_loss: 0.0793 - classifier_output_aux_acc: 0.9688 - classifier_output_main_acc: 0.9790 - val_loss: 0.3110 - val_classifier_output_aux_loss: 0.1815 - val_classifier_output_main_loss: 0.1296 - val_classifier_output_aux_acc: 0.9611 - val_classifier_output_main_acc: 0.9667
Epoch 36/1000
 - 23s - loss: 0.1783 - classifier_output_aux_loss: 0.1066 - classifier_output_main_loss: 0.0717 - classifier_output_aux_acc: 0.9673 - classifier_output_main_acc: 0.9778 - val_loss: 0.3178 - val_classifier_output_aux_loss: 0.2035 - val_classifier_output_main_loss: 0.1143 - val_classifier_output_aux_acc: 0.9556 - val_classifier_output_main_acc: 0.9694
Epoch 37/1000
 - 22s - loss: 0.1557 - classifier_output_aux_loss: 0.0917 - classifier_output_main_loss: 0.0640 - classifier_output_aux_acc: 0.9713 - classifier_output_main_acc: 0.9802 - val_loss: 0.3343 - val_classifier_output_aux_loss: 0.2250 - val_classifier_output_main_loss: 0.1092 - val_classifier_output_aux_acc: 0.9486 - val_classifier_output_main_acc: 0.9750
Epoch 38/1000
 - 22s - loss: 0.1547 - classifier_output_aux_loss: 0.0835 - classifier_output_main_loss: 0.0711 - classifier_output_aux_acc: 0.9753 - classifier_output_main_acc: 0.9789 - val_loss: 0.2860 - val_classifier_output_aux_loss: 0.1727 - val_classifier_output_main_loss: 0.1134 - val_classifier_output_aux_acc: 0.9639 - val_classifier_output_main_acc: 0.9667
Epoch 39/1000
 - 22s - loss: 0.1652 - classifier_output_aux_loss: 0.0846 - classifier_output_main_loss: 0.0807 - classifier_output_aux_acc: 0.9730 - classifier_output_main_acc: 0.9773 - val_loss: 0.3735 - val_classifier_output_aux_loss: 0.2280 - val_classifier_output_main_loss: 0.1455 - val_classifier_output_aux_acc: 0.9514 - val_classifier_output_main_acc: 0.9583
Epoch 40/1000
 - 22s - loss: 0.1502 - classifier_output_aux_loss: 0.0822 - classifier_output_main_loss: 0.0681 - classifier_output_aux_acc: 0.9739 - classifier_output_main_acc: 0.9809 - val_loss: 0.3299 - val_classifier_output_aux_loss: 0.2013 - val_classifier_output_main_loss: 0.1285 - val_classifier_output_aux_acc: 0.9583 - val_classifier_output_main_acc: 0.9708
Epoch 41/1000
 - 20s - loss: 0.1375 - classifier_output_aux_loss: 0.0788 - classifier_output_main_loss: 0.0586 - classifier_output_aux_acc: 0.9769 - classifier_output_main_acc: 0.9830 - val_loss: 0.4747 - val_classifier_output_aux_loss: 0.3050 - val_classifier_output_main_loss: 0.1697 - val_classifier_output_aux_acc: 0.9361 - val_classifier_output_main_acc: 0.9597
Epoch 42/1000
 - 20s - loss: 0.1500 - classifier_output_aux_loss: 0.0779 - classifier_output_main_loss: 0.0720 - classifier_output_aux_acc: 0.9753 - classifier_output_main_acc: 0.9781 - val_loss: 0.3500 - val_classifier_output_aux_loss: 0.1992 - val_classifier_output_main_loss: 0.1508 - val_classifier_output_aux_acc: 0.9583 - val_classifier_output_main_acc: 0.9667
Epoch 43/1000
 - 19s - loss: 0.1317 - classifier_output_aux_loss: 0.0743 - classifier_output_main_loss: 0.0575 - classifier_output_aux_acc: 0.9790 - classifier_output_main_acc: 0.9830 - val_loss: 0.3240 - val_classifier_output_aux_loss: 0.2306 - val_classifier_output_main_loss: 0.0934 - val_classifier_output_aux_acc: 0.9611 - val_classifier_output_main_acc: 0.9750
Epoch 44/1000
 - 19s - loss: 0.1432 - classifier_output_aux_loss: 0.0838 - classifier_output_main_loss: 0.0595 - classifier_output_aux_acc: 0.9761 - classifier_output_main_acc: 0.9836 - val_loss: 0.3296 - val_classifier_output_aux_loss: 0.2586 - val_classifier_output_main_loss: 0.0710 - val_classifier_output_aux_acc: 0.9556 - val_classifier_output_main_acc: 0.9819
Epoch 45/1000
 - 20s - loss: 0.1366 - classifier_output_aux_loss: 0.0722 - classifier_output_main_loss: 0.0645 - classifier_output_aux_acc: 0.9769 - classifier_output_main_acc: 0.9843 - val_loss: 0.2168 - val_classifier_output_aux_loss: 0.1343 - val_classifier_output_main_loss: 0.0826 - val_classifier_output_aux_acc: 0.9611 - val_classifier_output_main_acc: 0.9806
Epoch 46/1000
 - 20s - loss: 0.1370 - classifier_output_aux_loss: 0.0784 - classifier_output_main_loss: 0.0587 - classifier_output_aux_acc: 0.9781 - classifier_output_main_acc: 0.9847 - val_loss: 0.3881 - val_classifier_output_aux_loss: 0.2251 - val_classifier_output_main_loss: 0.1629 - val_classifier_output_aux_acc: 0.9556 - val_classifier_output_main_acc: 0.9625
Epoch 47/1000
 - 20s - loss: 0.1318 - classifier_output_aux_loss: 0.0691 - classifier_output_main_loss: 0.0627 - classifier_output_aux_acc: 0.9799 - classifier_output_main_acc: 0.9824 - val_loss: 0.3109 - val_classifier_output_aux_loss: 0.1592 - val_classifier_output_main_loss: 0.1517 - val_classifier_output_aux_acc: 0.9542 - val_classifier_output_main_acc: 0.9694
Epoch 48/1000
 - 21s - loss: 0.1362 - classifier_output_aux_loss: 0.0754 - classifier_output_main_loss: 0.0608 - classifier_output_aux_acc: 0.9793 - classifier_output_main_acc: 0.9838 - val_loss: 0.2846 - val_classifier_output_aux_loss: 0.1568 - val_classifier_output_main_loss: 0.1278 - val_classifier_output_aux_acc: 0.9639 - val_classifier_output_main_acc: 0.9722
Epoch 49/1000
 - 21s - loss: 0.1229 - classifier_output_aux_loss: 0.0621 - classifier_output_main_loss: 0.0608 - classifier_output_aux_acc: 0.9812 - classifier_output_main_acc: 0.9829 - val_loss: 0.3449 - val_classifier_output_aux_loss: 0.1858 - val_classifier_output_main_loss: 0.1591 - val_classifier_output_aux_acc: 0.9653 - val_classifier_output_main_acc: 0.9653
Epoch 50/1000
 - 20s - loss: 0.1184 - classifier_output_aux_loss: 0.0640 - classifier_output_main_loss: 0.0544 - classifier_output_aux_acc: 0.9807 - classifier_output_main_acc: 0.9853 - val_loss: 0.3913 - val_classifier_output_aux_loss: 0.2674 - val_classifier_output_main_loss: 0.1239 - val_classifier_output_aux_acc: 0.9375 - val_classifier_output_main_acc: 0.9778
Epoch 51/1000
 - 21s - loss: 0.1264 - classifier_output_aux_loss: 0.0700 - classifier_output_main_loss: 0.0564 - classifier_output_aux_acc: 0.9784 - classifier_output_main_acc: 0.9840 - val_loss: 0.2305 - val_classifier_output_aux_loss: 0.1542 - val_classifier_output_main_loss: 0.0763 - val_classifier_output_aux_acc: 0.9653 - val_classifier_output_main_acc: 0.9806
Epoch 52/1000
 - 21s - loss: 0.1215 - classifier_output_aux_loss: 0.0730 - classifier_output_main_loss: 0.0485 - classifier_output_aux_acc: 0.9799 - classifier_output_main_acc: 0.9861 - val_loss: 0.2846 - val_classifier_output_aux_loss: 0.2004 - val_classifier_output_main_loss: 0.0841 - val_classifier_output_aux_acc: 0.9750 - val_classifier_output_main_acc: 0.9764
Epoch 53/1000
 - 21s - loss: 0.1227 - classifier_output_aux_loss: 0.0636 - classifier_output_main_loss: 0.0591 - classifier_output_aux_acc: 0.9819 - classifier_output_main_acc: 0.9856 - val_loss: 0.3182 - val_classifier_output_aux_loss: 0.1594 - val_classifier_output_main_loss: 0.1588 - val_classifier_output_aux_acc: 0.9694 - val_classifier_output_main_acc: 0.9681
Epoch 54/1000
 - 21s - loss: 0.1294 - classifier_output_aux_loss: 0.0777 - classifier_output_main_loss: 0.0517 - classifier_output_aux_acc: 0.9792 - classifier_output_main_acc: 0.9860 - val_loss: 0.2634 - val_classifier_output_aux_loss: 0.1485 - val_classifier_output_main_loss: 0.1149 - val_classifier_output_aux_acc: 0.9708 - val_classifier_output_main_acc: 0.9722
Epoch 55/1000
 - 21s - loss: 0.1296 - classifier_output_aux_loss: 0.0718 - classifier_output_main_loss: 0.0578 - classifier_output_aux_acc: 0.9785 - classifier_output_main_acc: 0.9843 - val_loss: 0.2464 - val_classifier_output_aux_loss: 0.1582 - val_classifier_output_main_loss: 0.0882 - val_classifier_output_aux_acc: 0.9736 - val_classifier_output_main_acc: 0.9708
cm_aux: [[ 85  34   4   0 168   9]
 [ 36 139   3   9 103  10]
 [ 16  56 116  11  82  19]
 [  3   1  13 183  87  13]
 [  3  12   3   2 277   3]
 [  2  26   2  18  62 190]]
cm_main: [[218  20   5   1  17  39]
 [  3 239   1  20  23  14]
 [  4  21 244  22   1   8]
 [  6  22   6 252  12   2]
 [  4  52   1   3 194  46]
 [ 16  45   2   7  21 209]]
normalized cm_main: [[0.72666667 0.06666667 0.01666667 0.00333333 0.05666667 0.13      ]
 [0.01       0.79666667 0.00333333 0.06666667 0.07666667 0.04666667]
 [0.01333333 0.07       0.81333333 0.07333333 0.00333333 0.02666667]
 [0.02       0.07333333 0.02       0.84       0.04       0.00666667]
 [0.01333333 0.17333333 0.00333333 0.01       0.64666667 0.15333333]
 [0.05333333 0.15       0.00666667 0.02333333 0.07       0.69666667]]
metrics: ['loss', 'classifier_output_aux_loss', 'classifier_output_main_loss', 'classifier_output_aux_acc', 'classifier_output_main_acc']
Test score: [5.251789603994952, 3.7142964278327093, 1.5374931503992735, 0.55, 0.7533333333333333]
Test loss: 3.7142964278327093
Test accuracy of aux: 0.55
Test accuracy of main: 0.7533333333333333
Saving model to disk 

__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
main_input_1 (InputLayer)       (None, 29, 6, 20, 3) 0                                            
__________________________________________________________________________________________________
main_input_2 (InputLayer)       (None, 29, 6, 20, 3) 0                                            
__________________________________________________________________________________________________
feature_output_aux (TimeDistrib (None, 29, 64)       78400       main_input_1[0][0]               
__________________________________________________________________________________________________
feature_output_main (TimeDistri (None, 29, 64)       78400       main_input_2[0][0]               
__________________________________________________________________________________________________
gru_1 (GRU)                     (None, 128)          74112       feature_output_aux[0][0]         
__________________________________________________________________________________________________
gru_2 (GRU)                     (None, 128)          74112       feature_output_main[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 128)          0           gru_1[0][0]                      
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 128)          0           gru_2[0][0]                      
__________________________________________________________________________________________________
gradient_reversal_1 (GradientRe (None, 128)          0           dropout_4[0][0]                  
__________________________________________________________________________________________________
gradient_reversal_2 (GradientRe (None, 128)          0           dropout_2[0][0]                  
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 256)          0           dropout_2[0][0]                  
                                                                 gradient_reversal_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 256)          0           dropout_4[0][0]                  
                                                                 gradient_reversal_2[0][0]        
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 128)          32896       concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_6 (Dense)                 (None, 128)          32896       concatenate_2[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 128)          0           dense_5[0][0]                    
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 128)          0           dense_6[0][0]                    
__________________________________________________________________________________________________
classifier_output_aux (Dense)   (None, 6)            774         dropout_5[0][0]                  
__________________________________________________________________________________________________
classifier_output_main (Dense)  (None, 6)            774         dropout_6[0][0]                  
==================================================================================================
Total params: 372,364
Trainable params: 372,364
Non-trainable params: 0
__________________________________________________________________________________________________
None
Loading Data...
domain_type: 3
Loaded Data wf_tally_slice 2 (7200, 29, 6, 20, 3) 4 (7200, 6) 2 (1800, 29, 6, 20, 3)
n_timesteps: 29
Train on 6480 samples, validate on 720 samples
Epoch 1/1000
 - 25s - loss: 3.2576 - classifier_output_aux_loss: 1.5969 - classifier_output_main_loss: 1.6607 - classifier_output_aux_acc: 0.3285 - classifier_output_main_acc: 0.2816 - val_loss: 2.7785 - val_classifier_output_aux_loss: 1.3854 - val_classifier_output_main_loss: 1.3931 - val_classifier_output_aux_acc: 0.4444 - val_classifier_output_main_acc: 0.4708
Epoch 2/1000
 - 22s - loss: 2.6919 - classifier_output_aux_loss: 1.3587 - classifier_output_main_loss: 1.3333 - classifier_output_aux_acc: 0.4535 - classifier_output_main_acc: 0.4801 - val_loss: 2.3745 - val_classifier_output_aux_loss: 1.1521 - val_classifier_output_main_loss: 1.2224 - val_classifier_output_aux_acc: 0.5542 - val_classifier_output_main_acc: 0.5083
Epoch 3/1000
 - 21s - loss: 2.2647 - classifier_output_aux_loss: 1.1407 - classifier_output_main_loss: 1.1240 - classifier_output_aux_acc: 0.5586 - classifier_output_main_acc: 0.5625 - val_loss: 2.1074 - val_classifier_output_aux_loss: 1.0023 - val_classifier_output_main_loss: 1.1051 - val_classifier_output_aux_acc: 0.6181 - val_classifier_output_main_acc: 0.5889
Epoch 4/1000
 - 21s - loss: 1.9768 - classifier_output_aux_loss: 0.9692 - classifier_output_main_loss: 1.0076 - classifier_output_aux_acc: 0.6341 - classifier_output_main_acc: 0.6326 - val_loss: 1.8001 - val_classifier_output_aux_loss: 0.8527 - val_classifier_output_main_loss: 0.9474 - val_classifier_output_aux_acc: 0.6653 - val_classifier_output_main_acc: 0.6556
Epoch 5/1000
 - 21s - loss: 1.6890 - classifier_output_aux_loss: 0.8216 - classifier_output_main_loss: 0.8674 - classifier_output_aux_acc: 0.6903 - classifier_output_main_acc: 0.6901 - val_loss: 1.5493 - val_classifier_output_aux_loss: 0.9045 - val_classifier_output_main_loss: 0.6449 - val_classifier_output_aux_acc: 0.6736 - val_classifier_output_main_acc: 0.7806
Epoch 6/1000
 - 21s - loss: 1.4116 - classifier_output_aux_loss: 0.7137 - classifier_output_main_loss: 0.6979 - classifier_output_aux_acc: 0.7335 - classifier_output_main_acc: 0.7532 - val_loss: 1.2138 - val_classifier_output_aux_loss: 0.6312 - val_classifier_output_main_loss: 0.5826 - val_classifier_output_aux_acc: 0.7597 - val_classifier_output_main_acc: 0.7889
Epoch 7/1000
 - 21s - loss: 1.2034 - classifier_output_aux_loss: 0.6242 - classifier_output_main_loss: 0.5792 - classifier_output_aux_acc: 0.7694 - classifier_output_main_acc: 0.7934 - val_loss: 0.9105 - val_classifier_output_aux_loss: 0.4597 - val_classifier_output_main_loss: 0.4509 - val_classifier_output_aux_acc: 0.8333 - val_classifier_output_main_acc: 0.8444
Epoch 8/1000
 - 21s - loss: 1.0423 - classifier_output_aux_loss: 0.5530 - classifier_output_main_loss: 0.4892 - classifier_output_aux_acc: 0.8019 - classifier_output_main_acc: 0.8298 - val_loss: 0.7999 - val_classifier_output_aux_loss: 0.3974 - val_classifier_output_main_loss: 0.4025 - val_classifier_output_aux_acc: 0.8583 - val_classifier_output_main_acc: 0.8611
Epoch 9/1000
 - 21s - loss: 0.9051 - classifier_output_aux_loss: 0.4910 - classifier_output_main_loss: 0.4142 - classifier_output_aux_acc: 0.8281 - classifier_output_main_acc: 0.8534 - val_loss: 0.7761 - val_classifier_output_aux_loss: 0.3831 - val_classifier_output_main_loss: 0.3930 - val_classifier_output_aux_acc: 0.8569 - val_classifier_output_main_acc: 0.8681
Epoch 10/1000
 - 21s - loss: 0.8053 - classifier_output_aux_loss: 0.4410 - classifier_output_main_loss: 0.3642 - classifier_output_aux_acc: 0.8403 - classifier_output_main_acc: 0.8744 - val_loss: 0.7900 - val_classifier_output_aux_loss: 0.4407 - val_classifier_output_main_loss: 0.3493 - val_classifier_output_aux_acc: 0.8528 - val_classifier_output_main_acc: 0.8694
Epoch 11/1000
 - 20s - loss: 0.7172 - classifier_output_aux_loss: 0.4026 - classifier_output_main_loss: 0.3146 - classifier_output_aux_acc: 0.8603 - classifier_output_main_acc: 0.8932 - val_loss: 0.5274 - val_classifier_output_aux_loss: 0.2895 - val_classifier_output_main_loss: 0.2378 - val_classifier_output_aux_acc: 0.8958 - val_classifier_output_main_acc: 0.9181
Epoch 12/1000
 - 21s - loss: 0.6280 - classifier_output_aux_loss: 0.3489 - classifier_output_main_loss: 0.2791 - classifier_output_aux_acc: 0.8752 - classifier_output_main_acc: 0.9049 - val_loss: 0.6376 - val_classifier_output_aux_loss: 0.3743 - val_classifier_output_main_loss: 0.2633 - val_classifier_output_aux_acc: 0.8750 - val_classifier_output_main_acc: 0.9167
Epoch 13/1000
 - 21s - loss: 0.5681 - classifier_output_aux_loss: 0.3294 - classifier_output_main_loss: 0.2387 - classifier_output_aux_acc: 0.8806 - classifier_output_main_acc: 0.9213 - val_loss: 0.4380 - val_classifier_output_aux_loss: 0.2319 - val_classifier_output_main_loss: 0.2061 - val_classifier_output_aux_acc: 0.9236 - val_classifier_output_main_acc: 0.9403
Epoch 14/1000
 - 21s - loss: 0.5525 - classifier_output_aux_loss: 0.3150 - classifier_output_main_loss: 0.2374 - classifier_output_aux_acc: 0.8926 - classifier_output_main_acc: 0.9213 - val_loss: 0.4351 - val_classifier_output_aux_loss: 0.2897 - val_classifier_output_main_loss: 0.1454 - val_classifier_output_aux_acc: 0.9028 - val_classifier_output_main_acc: 0.9514
Epoch 15/1000
 - 21s - loss: 0.5027 - classifier_output_aux_loss: 0.3051 - classifier_output_main_loss: 0.1977 - classifier_output_aux_acc: 0.9000 - classifier_output_main_acc: 0.9343 - val_loss: 0.4727 - val_classifier_output_aux_loss: 0.2665 - val_classifier_output_main_loss: 0.2062 - val_classifier_output_aux_acc: 0.9097 - val_classifier_output_main_acc: 0.9417
Epoch 16/1000
 - 21s - loss: 0.4384 - classifier_output_aux_loss: 0.2561 - classifier_output_main_loss: 0.1823 - classifier_output_aux_acc: 0.9065 - classifier_output_main_acc: 0.9397 - val_loss: 0.5111 - val_classifier_output_aux_loss: 0.3916 - val_classifier_output_main_loss: 0.1195 - val_classifier_output_aux_acc: 0.8847 - val_classifier_output_main_acc: 0.9625
Epoch 17/1000
 - 21s - loss: 0.3990 - classifier_output_aux_loss: 0.2370 - classifier_output_main_loss: 0.1620 - classifier_output_aux_acc: 0.9182 - classifier_output_main_acc: 0.9477 - val_loss: 0.3034 - val_classifier_output_aux_loss: 0.1533 - val_classifier_output_main_loss: 0.1502 - val_classifier_output_aux_acc: 0.9528 - val_classifier_output_main_acc: 0.9472
Epoch 18/1000
 - 21s - loss: 0.3775 - classifier_output_aux_loss: 0.2265 - classifier_output_main_loss: 0.1510 - classifier_output_aux_acc: 0.9225 - classifier_output_main_acc: 0.9508 - val_loss: 0.5169 - val_classifier_output_aux_loss: 0.3809 - val_classifier_output_main_loss: 0.1359 - val_classifier_output_aux_acc: 0.8764 - val_classifier_output_main_acc: 0.9569
Epoch 19/1000
 - 21s - loss: 0.3392 - classifier_output_aux_loss: 0.2078 - classifier_output_main_loss: 0.1314 - classifier_output_aux_acc: 0.9282 - classifier_output_main_acc: 0.9552 - val_loss: 0.3015 - val_classifier_output_aux_loss: 0.1627 - val_classifier_output_main_loss: 0.1388 - val_classifier_output_aux_acc: 0.9444 - val_classifier_output_main_acc: 0.9597
Epoch 20/1000
 - 21s - loss: 0.3039 - classifier_output_aux_loss: 0.1782 - classifier_output_main_loss: 0.1257 - classifier_output_aux_acc: 0.9372 - classifier_output_main_acc: 0.9596 - val_loss: 0.2922 - val_classifier_output_aux_loss: 0.1765 - val_classifier_output_main_loss: 0.1157 - val_classifier_output_aux_acc: 0.9514 - val_classifier_output_main_acc: 0.9653
Epoch 21/1000
 - 21s - loss: 0.2981 - classifier_output_aux_loss: 0.1802 - classifier_output_main_loss: 0.1180 - classifier_output_aux_acc: 0.9389 - classifier_output_main_acc: 0.9630 - val_loss: 0.2904 - val_classifier_output_aux_loss: 0.2156 - val_classifier_output_main_loss: 0.0748 - val_classifier_output_aux_acc: 0.9347 - val_classifier_output_main_acc: 0.9750
Epoch 22/1000
 - 21s - loss: 0.2825 - classifier_output_aux_loss: 0.1713 - classifier_output_main_loss: 0.1112 - classifier_output_aux_acc: 0.9407 - classifier_output_main_acc: 0.9640 - val_loss: 0.2958 - val_classifier_output_aux_loss: 0.1845 - val_classifier_output_main_loss: 0.1114 - val_classifier_output_aux_acc: 0.9458 - val_classifier_output_main_acc: 0.9736
Epoch 23/1000
 - 20s - loss: 0.2806 - classifier_output_aux_loss: 0.1635 - classifier_output_main_loss: 0.1171 - classifier_output_aux_acc: 0.9471 - classifier_output_main_acc: 0.9639 - val_loss: 0.3933 - val_classifier_output_aux_loss: 0.2781 - val_classifier_output_main_loss: 0.1152 - val_classifier_output_aux_acc: 0.9083 - val_classifier_output_main_acc: 0.9708
Epoch 24/1000
 - 21s - loss: 0.2637 - classifier_output_aux_loss: 0.1575 - classifier_output_main_loss: 0.1061 - classifier_output_aux_acc: 0.9495 - classifier_output_main_acc: 0.9670 - val_loss: 0.4988 - val_classifier_output_aux_loss: 0.2173 - val_classifier_output_main_loss: 0.2815 - val_classifier_output_aux_acc: 0.9250 - val_classifier_output_main_acc: 0.9278
Epoch 25/1000
 - 21s - loss: 0.2612 - classifier_output_aux_loss: 0.1608 - classifier_output_main_loss: 0.1003 - classifier_output_aux_acc: 0.9488 - classifier_output_main_acc: 0.9711 - val_loss: 0.2723 - val_classifier_output_aux_loss: 0.1572 - val_classifier_output_main_loss: 0.1151 - val_classifier_output_aux_acc: 0.9569 - val_classifier_output_main_acc: 0.9708
Epoch 26/1000
 - 21s - loss: 0.2160 - classifier_output_aux_loss: 0.1257 - classifier_output_main_loss: 0.0903 - classifier_output_aux_acc: 0.9551 - classifier_output_main_acc: 0.9727 - val_loss: 0.2780 - val_classifier_output_aux_loss: 0.1898 - val_classifier_output_main_loss: 0.0882 - val_classifier_output_aux_acc: 0.9444 - val_classifier_output_main_acc: 0.9750
Epoch 27/1000
 - 21s - loss: 0.2161 - classifier_output_aux_loss: 0.1282 - classifier_output_main_loss: 0.0879 - classifier_output_aux_acc: 0.9613 - classifier_output_main_acc: 0.9724 - val_loss: 0.2995 - val_classifier_output_aux_loss: 0.2225 - val_classifier_output_main_loss: 0.0770 - val_classifier_output_aux_acc: 0.9472 - val_classifier_output_main_acc: 0.9792
Epoch 28/1000
 - 20s - loss: 0.2195 - classifier_output_aux_loss: 0.1290 - classifier_output_main_loss: 0.0905 - classifier_output_aux_acc: 0.9588 - classifier_output_main_acc: 0.9741 - val_loss: 0.2137 - val_classifier_output_aux_loss: 0.1305 - val_classifier_output_main_loss: 0.0832 - val_classifier_output_aux_acc: 0.9653 - val_classifier_output_main_acc: 0.9736
Epoch 29/1000
 - 20s - loss: 0.2044 - classifier_output_aux_loss: 0.1179 - classifier_output_main_loss: 0.0865 - classifier_output_aux_acc: 0.9617 - classifier_output_main_acc: 0.9756 - val_loss: 0.2386 - val_classifier_output_aux_loss: 0.1749 - val_classifier_output_main_loss: 0.0638 - val_classifier_output_aux_acc: 0.9528 - val_classifier_output_main_acc: 0.9847
Epoch 30/1000
 - 20s - loss: 0.2032 - classifier_output_aux_loss: 0.1199 - classifier_output_main_loss: 0.0833 - classifier_output_aux_acc: 0.9600 - classifier_output_main_acc: 0.9764 - val_loss: 0.2551 - val_classifier_output_aux_loss: 0.1590 - val_classifier_output_main_loss: 0.0961 - val_classifier_output_aux_acc: 0.9597 - val_classifier_output_main_acc: 0.9736
Epoch 31/1000
 - 19s - loss: 0.1948 - classifier_output_aux_loss: 0.1106 - classifier_output_main_loss: 0.0842 - classifier_output_aux_acc: 0.9660 - classifier_output_main_acc: 0.9736 - val_loss: 0.1781 - val_classifier_output_aux_loss: 0.1031 - val_classifier_output_main_loss: 0.0751 - val_classifier_output_aux_acc: 0.9722 - val_classifier_output_main_acc: 0.9806
Epoch 32/1000
 - 20s - loss: 0.1782 - classifier_output_aux_loss: 0.1094 - classifier_output_main_loss: 0.0687 - classifier_output_aux_acc: 0.9662 - classifier_output_main_acc: 0.9787 - val_loss: 0.3811 - val_classifier_output_aux_loss: 0.2505 - val_classifier_output_main_loss: 0.1306 - val_classifier_output_aux_acc: 0.9347 - val_classifier_output_main_acc: 0.9681
Epoch 33/1000
 - 20s - loss: 0.1716 - classifier_output_aux_loss: 0.0944 - classifier_output_main_loss: 0.0771 - classifier_output_aux_acc: 0.9698 - classifier_output_main_acc: 0.9759 - val_loss: 0.3983 - val_classifier_output_aux_loss: 0.2669 - val_classifier_output_main_loss: 0.1314 - val_classifier_output_aux_acc: 0.9264 - val_classifier_output_main_acc: 0.9722
Epoch 34/1000
 - 21s - loss: 0.1702 - classifier_output_aux_loss: 0.1002 - classifier_output_main_loss: 0.0700 - classifier_output_aux_acc: 0.9693 - classifier_output_main_acc: 0.9815 - val_loss: 0.3829 - val_classifier_output_aux_loss: 0.3005 - val_classifier_output_main_loss: 0.0825 - val_classifier_output_aux_acc: 0.9278 - val_classifier_output_main_acc: 0.9778
Epoch 35/1000
 - 21s - loss: 0.1656 - classifier_output_aux_loss: 0.0984 - classifier_output_main_loss: 0.0673 - classifier_output_aux_acc: 0.9702 - classifier_output_main_acc: 0.9810 - val_loss: 0.3725 - val_classifier_output_aux_loss: 0.2846 - val_classifier_output_main_loss: 0.0879 - val_classifier_output_aux_acc: 0.9306 - val_classifier_output_main_acc: 0.9806
Epoch 36/1000
 - 21s - loss: 0.1521 - classifier_output_aux_loss: 0.0904 - classifier_output_main_loss: 0.0616 - classifier_output_aux_acc: 0.9701 - classifier_output_main_acc: 0.9824 - val_loss: 0.2694 - val_classifier_output_aux_loss: 0.1481 - val_classifier_output_main_loss: 0.1213 - val_classifier_output_aux_acc: 0.9667 - val_classifier_output_main_acc: 0.9750
Epoch 37/1000
 - 21s - loss: 0.1445 - classifier_output_aux_loss: 0.0878 - classifier_output_main_loss: 0.0567 - classifier_output_aux_acc: 0.9722 - classifier_output_main_acc: 0.9827 - val_loss: 0.4308 - val_classifier_output_aux_loss: 0.2660 - val_classifier_output_main_loss: 0.1648 - val_classifier_output_aux_acc: 0.9444 - val_classifier_output_main_acc: 0.9750
Epoch 38/1000
 - 22s - loss: 0.1621 - classifier_output_aux_loss: 0.0957 - classifier_output_main_loss: 0.0665 - classifier_output_aux_acc: 0.9728 - classifier_output_main_acc: 0.9782 - val_loss: 0.2973 - val_classifier_output_aux_loss: 0.2088 - val_classifier_output_main_loss: 0.0886 - val_classifier_output_aux_acc: 0.9528 - val_classifier_output_main_acc: 0.9792
Epoch 39/1000
 - 20s - loss: 0.1380 - classifier_output_aux_loss: 0.0790 - classifier_output_main_loss: 0.0590 - classifier_output_aux_acc: 0.9758 - classifier_output_main_acc: 0.9833 - val_loss: 0.2788 - val_classifier_output_aux_loss: 0.1697 - val_classifier_output_main_loss: 0.1091 - val_classifier_output_aux_acc: 0.9583 - val_classifier_output_main_acc: 0.9750
Epoch 40/1000
 - 20s - loss: 0.1355 - classifier_output_aux_loss: 0.0792 - classifier_output_main_loss: 0.0563 - classifier_output_aux_acc: 0.9765 - classifier_output_main_acc: 0.9835 - val_loss: 0.2098 - val_classifier_output_aux_loss: 0.1312 - val_classifier_output_main_loss: 0.0786 - val_classifier_output_aux_acc: 0.9750 - val_classifier_output_main_acc: 0.9806
Epoch 41/1000
 - 20s - loss: 0.1468 - classifier_output_aux_loss: 0.0833 - classifier_output_main_loss: 0.0635 - classifier_output_aux_acc: 0.9748 - classifier_output_main_acc: 0.9810 - val_loss: 0.3764 - val_classifier_output_aux_loss: 0.1857 - val_classifier_output_main_loss: 0.1906 - val_classifier_output_aux_acc: 0.9486 - val_classifier_output_main_acc: 0.9611
cm_aux: [[150  15   1   0 115  19]
 [ 46 142   3   3  88  18]
 [ 18  28  92   8 124  30]
 [  5   1  10 139  99  46]
 [  8   9   1   1 269  12]
 [  4   7   1  14  76 198]]
cm_main: [[128  59   2   0  72  39]
 [  0 271   0   8  17   4]
 [  8  52 187  40   2  11]
 [  1  41   3 240  13   2]
 [  2  76   0   2 198  22]
 [  8  96   0   4  23 169]]
normalized cm_main: [[0.42666667 0.19666667 0.00666667 0.         0.24       0.13      ]
 [0.         0.90333333 0.         0.02666667 0.05666667 0.01333333]
 [0.02666667 0.17333333 0.62333333 0.13333333 0.00666667 0.03666667]
 [0.00333333 0.13666667 0.01       0.8        0.04333333 0.00666667]
 [0.00666667 0.25333333 0.         0.00666667 0.66       0.07333333]
 [0.02666667 0.32       0.         0.01333333 0.07666667 0.56333333]]
metrics: ['loss', 'classifier_output_aux_loss', 'classifier_output_main_loss', 'classifier_output_aux_acc', 'classifier_output_main_acc']
Test score: [5.871915278699663, 3.408221980465783, 2.463693305487848, 0.55, 0.6627777777777778]
Test loss: 3.408221980465783
Test accuracy of aux: 0.55
Test accuracy of main: 0.6627777777777778
Saving model to disk 

__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
main_input_1 (InputLayer)       (None, 29, 6, 20, 3) 0                                            
__________________________________________________________________________________________________
main_input_2 (InputLayer)       (None, 29, 6, 20, 3) 0                                            
__________________________________________________________________________________________________
feature_output_aux (TimeDistrib (None, 29, 64)       78400       main_input_1[0][0]               
__________________________________________________________________________________________________
feature_output_main (TimeDistri (None, 29, 64)       78400       main_input_2[0][0]               
__________________________________________________________________________________________________
gru_3 (GRU)                     (None, 128)          74112       feature_output_aux[0][0]         
__________________________________________________________________________________________________
gru_4 (GRU)                     (None, 128)          74112       feature_output_main[0][0]        
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 128)          0           gru_3[0][0]                      
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 128)          0           gru_4[0][0]                      
__________________________________________________________________________________________________
gradient_reversal_3 (GradientRe (None, 128)          0           dropout_10[0][0]                 
__________________________________________________________________________________________________
gradient_reversal_4 (GradientRe (None, 128)          0           dropout_8[0][0]                  
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 256)          0           dropout_8[0][0]                  
                                                                 gradient_reversal_3[0][0]        
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 256)          0           dropout_10[0][0]                 
                                                                 gradient_reversal_4[0][0]        
__________________________________________________________________________________________________
dense_11 (Dense)                (None, 128)          32896       concatenate_3[0][0]              
__________________________________________________________________________________________________
dense_12 (Dense)                (None, 128)          32896       concatenate_4[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 128)          0           dense_11[0][0]                   
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 128)          0           dense_12[0][0]                   
__________________________________________________________________________________________________
classifier_output_aux (Dense)   (None, 6)            774         dropout_11[0][0]                 
__________________________________________________________________________________________________
classifier_output_main (Dense)  (None, 6)            774         dropout_12[0][0]                 
==================================================================================================
Total params: 372,364
Trainable params: 372,364
Non-trainable params: 0
__________________________________________________________________________________________________
None
Loading Data...
domain_type: 3
Loaded Data wf_tally_slice 2 (7200, 29, 6, 20, 3) 4 (7200, 6) 2 (1800, 29, 6, 20, 3)
n_timesteps: 29
Train on 6480 samples, validate on 720 samples
Epoch 1/1000
 - 25s - loss: 3.3398 - classifier_output_aux_loss: 1.5981 - classifier_output_main_loss: 1.7417 - classifier_output_aux_acc: 0.3139 - classifier_output_main_acc: 0.2218 - val_loss: 3.0272 - val_classifier_output_aux_loss: 1.4519 - val_classifier_output_main_loss: 1.5754 - val_classifier_output_aux_acc: 0.4069 - val_classifier_output_main_acc: 0.3292
Epoch 2/1000
 - 20s - loss: 2.7777 - classifier_output_aux_loss: 1.3633 - classifier_output_main_loss: 1.4145 - classifier_output_aux_acc: 0.4531 - classifier_output_main_acc: 0.4500 - val_loss: 2.3488 - val_classifier_output_aux_loss: 1.1520 - val_classifier_output_main_loss: 1.1968 - val_classifier_output_aux_acc: 0.5361 - val_classifier_output_main_acc: 0.5319
Epoch 3/1000
 - 20s - loss: 2.3450 - classifier_output_aux_loss: 1.1378 - classifier_output_main_loss: 1.2073 - classifier_output_aux_acc: 0.5634 - classifier_output_main_acc: 0.5289 - val_loss: 2.1197 - val_classifier_output_aux_loss: 1.0462 - val_classifier_output_main_loss: 1.0735 - val_classifier_output_aux_acc: 0.5958 - val_classifier_output_main_acc: 0.5861
Epoch 4/1000
 - 20s - loss: 1.9983 - classifier_output_aux_loss: 0.9564 - classifier_output_main_loss: 1.0419 - classifier_output_aux_acc: 0.6358 - classifier_output_main_acc: 0.6000 - val_loss: 1.9435 - val_classifier_output_aux_loss: 0.9872 - val_classifier_output_main_loss: 0.9564 - val_classifier_output_aux_acc: 0.6181 - val_classifier_output_main_acc: 0.6347
Epoch 5/1000
 - 20s - loss: 1.7144 - classifier_output_aux_loss: 0.8185 - classifier_output_main_loss: 0.8959 - classifier_output_aux_acc: 0.6875 - classifier_output_main_acc: 0.6660 - val_loss: 1.4480 - val_classifier_output_aux_loss: 0.6089 - val_classifier_output_main_loss: 0.8391 - val_classifier_output_aux_acc: 0.7639 - val_classifier_output_main_acc: 0.6847
Epoch 6/1000
 - 20s - loss: 1.4808 - classifier_output_aux_loss: 0.7103 - classifier_output_main_loss: 0.7705 - classifier_output_aux_acc: 0.7316 - classifier_output_main_acc: 0.7162 - val_loss: 1.2881 - val_classifier_output_aux_loss: 0.6097 - val_classifier_output_main_loss: 0.6784 - val_classifier_output_aux_acc: 0.7694 - val_classifier_output_main_acc: 0.7611
Epoch 7/1000
 - 20s - loss: 1.2779 - classifier_output_aux_loss: 0.6354 - classifier_output_main_loss: 0.6424 - classifier_output_aux_acc: 0.7710 - classifier_output_main_acc: 0.7722 - val_loss: 1.3832 - val_classifier_output_aux_loss: 0.8528 - val_classifier_output_main_loss: 0.5305 - val_classifier_output_aux_acc: 0.7042 - val_classifier_output_main_acc: 0.8250
Epoch 8/1000
 - 20s - loss: 1.1060 - classifier_output_aux_loss: 0.5617 - classifier_output_main_loss: 0.5443 - classifier_output_aux_acc: 0.7946 - classifier_output_main_acc: 0.8083 - val_loss: 0.8397 - val_classifier_output_aux_loss: 0.4083 - val_classifier_output_main_loss: 0.4315 - val_classifier_output_aux_acc: 0.8431 - val_classifier_output_main_acc: 0.8556
Epoch 9/1000
 - 21s - loss: 0.9874 - classifier_output_aux_loss: 0.5008 - classifier_output_main_loss: 0.4865 - classifier_output_aux_acc: 0.8210 - classifier_output_main_acc: 0.8321 - val_loss: 0.9147 - val_classifier_output_aux_loss: 0.4809 - val_classifier_output_main_loss: 0.4338 - val_classifier_output_aux_acc: 0.8153 - val_classifier_output_main_acc: 0.8556
Epoch 10/1000
 - 21s - loss: 0.8483 - classifier_output_aux_loss: 0.4289 - classifier_output_main_loss: 0.4194 - classifier_output_aux_acc: 0.8514 - classifier_output_main_acc: 0.8534 - val_loss: 0.7408 - val_classifier_output_aux_loss: 0.3559 - val_classifier_output_main_loss: 0.3848 - val_classifier_output_aux_acc: 0.8819 - val_classifier_output_main_acc: 0.8694
Epoch 11/1000
 - 20s - loss: 0.7890 - classifier_output_aux_loss: 0.4009 - classifier_output_main_loss: 0.3882 - classifier_output_aux_acc: 0.8620 - classifier_output_main_acc: 0.8701 - val_loss: 0.6153 - val_classifier_output_aux_loss: 0.3119 - val_classifier_output_main_loss: 0.3034 - val_classifier_output_aux_acc: 0.8889 - val_classifier_output_main_acc: 0.8986
Epoch 12/1000
 - 22s - loss: 0.6878 - classifier_output_aux_loss: 0.3535 - classifier_output_main_loss: 0.3343 - classifier_output_aux_acc: 0.8752 - classifier_output_main_acc: 0.8867 - val_loss: 0.5822 - val_classifier_output_aux_loss: 0.3052 - val_classifier_output_main_loss: 0.2769 - val_classifier_output_aux_acc: 0.8958 - val_classifier_output_main_acc: 0.9069
Epoch 13/1000
 - 38s - loss: 0.6385 - classifier_output_aux_loss: 0.3273 - classifier_output_main_loss: 0.3112 - classifier_output_aux_acc: 0.8881 - classifier_output_main_acc: 0.8965 - val_loss: 0.5162 - val_classifier_output_aux_loss: 0.3004 - val_classifier_output_main_loss: 0.2158 - val_classifier_output_aux_acc: 0.8917 - val_classifier_output_main_acc: 0.9264
Epoch 14/1000
 - 21s - loss: 0.5825 - classifier_output_aux_loss: 0.3043 - classifier_output_main_loss: 0.2782 - classifier_output_aux_acc: 0.8940 - classifier_output_main_acc: 0.9052 - val_loss: 0.5538 - val_classifier_output_aux_loss: 0.3787 - val_classifier_output_main_loss: 0.1751 - val_classifier_output_aux_acc: 0.8819 - val_classifier_output_main_acc: 0.9417
Epoch 15/1000
 - 21s - loss: 0.5447 - classifier_output_aux_loss: 0.2959 - classifier_output_main_loss: 0.2489 - classifier_output_aux_acc: 0.8978 - classifier_output_main_acc: 0.9201 - val_loss: 0.6785 - val_classifier_output_aux_loss: 0.3078 - val_classifier_output_main_loss: 0.3707 - val_classifier_output_aux_acc: 0.8931 - val_classifier_output_main_acc: 0.8736
Epoch 16/1000
 - 21s - loss: 0.4642 - classifier_output_aux_loss: 0.2438 - classifier_output_main_loss: 0.2205 - classifier_output_aux_acc: 0.9133 - classifier_output_main_acc: 0.9265 - val_loss: 0.6096 - val_classifier_output_aux_loss: 0.4379 - val_classifier_output_main_loss: 0.1717 - val_classifier_output_aux_acc: 0.8778 - val_classifier_output_main_acc: 0.9389
Epoch 17/1000
 - 21s - loss: 0.4289 - classifier_output_aux_loss: 0.2338 - classifier_output_main_loss: 0.1951 - classifier_output_aux_acc: 0.9201 - classifier_output_main_acc: 0.9384 - val_loss: 0.4327 - val_classifier_output_aux_loss: 0.2886 - val_classifier_output_main_loss: 0.1441 - val_classifier_output_aux_acc: 0.9069 - val_classifier_output_main_acc: 0.9486
Epoch 18/1000
 - 21s - loss: 0.4053 - classifier_output_aux_loss: 0.2282 - classifier_output_main_loss: 0.1771 - classifier_output_aux_acc: 0.9247 - classifier_output_main_acc: 0.9383 - val_loss: 0.4635 - val_classifier_output_aux_loss: 0.3068 - val_classifier_output_main_loss: 0.1567 - val_classifier_output_aux_acc: 0.9097 - val_classifier_output_main_acc: 0.9444
Epoch 19/1000
 - 21s - loss: 0.3765 - classifier_output_aux_loss: 0.2097 - classifier_output_main_loss: 0.1668 - classifier_output_aux_acc: 0.9278 - classifier_output_main_acc: 0.9475 - val_loss: 0.4536 - val_classifier_output_aux_loss: 0.2532 - val_classifier_output_main_loss: 0.2004 - val_classifier_output_aux_acc: 0.9250 - val_classifier_output_main_acc: 0.9264
Epoch 20/1000
 - 21s - loss: 0.3441 - classifier_output_aux_loss: 0.1927 - classifier_output_main_loss: 0.1514 - classifier_output_aux_acc: 0.9329 - classifier_output_main_acc: 0.9525 - val_loss: 0.3988 - val_classifier_output_aux_loss: 0.2037 - val_classifier_output_main_loss: 0.1951 - val_classifier_output_aux_acc: 0.9458 - val_classifier_output_main_acc: 0.9431
Epoch 21/1000
 - 21s - loss: 0.3179 - classifier_output_aux_loss: 0.1743 - classifier_output_main_loss: 0.1436 - classifier_output_aux_acc: 0.9420 - classifier_output_main_acc: 0.9526 - val_loss: 0.3741 - val_classifier_output_aux_loss: 0.2180 - val_classifier_output_main_loss: 0.1561 - val_classifier_output_aux_acc: 0.9444 - val_classifier_output_main_acc: 0.9528
Epoch 22/1000
 - 21s - loss: 0.3057 - classifier_output_aux_loss: 0.1719 - classifier_output_main_loss: 0.1338 - classifier_output_aux_acc: 0.9421 - classifier_output_main_acc: 0.9582 - val_loss: 0.2837 - val_classifier_output_aux_loss: 0.1839 - val_classifier_output_main_loss: 0.0998 - val_classifier_output_aux_acc: 0.9347 - val_classifier_output_main_acc: 0.9681
Epoch 23/1000
 - 21s - loss: 0.2969 - classifier_output_aux_loss: 0.1602 - classifier_output_main_loss: 0.1367 - classifier_output_aux_acc: 0.9454 - classifier_output_main_acc: 0.9602 - val_loss: 0.3748 - val_classifier_output_aux_loss: 0.2480 - val_classifier_output_main_loss: 0.1268 - val_classifier_output_aux_acc: 0.9361 - val_classifier_output_main_acc: 0.9694
Epoch 24/1000
 - 21s - loss: 0.2693 - classifier_output_aux_loss: 0.1464 - classifier_output_main_loss: 0.1229 - classifier_output_aux_acc: 0.9539 - classifier_output_main_acc: 0.9637 - val_loss: 0.3303 - val_classifier_output_aux_loss: 0.2118 - val_classifier_output_main_loss: 0.1185 - val_classifier_output_aux_acc: 0.9361 - val_classifier_output_main_acc: 0.9681
Epoch 25/1000
 - 21s - loss: 0.2596 - classifier_output_aux_loss: 0.1520 - classifier_output_main_loss: 0.1076 - classifier_output_aux_acc: 0.9475 - classifier_output_main_acc: 0.9637 - val_loss: 0.2872 - val_classifier_output_aux_loss: 0.1738 - val_classifier_output_main_loss: 0.1134 - val_classifier_output_aux_acc: 0.9542 - val_classifier_output_main_acc: 0.9653
Epoch 26/1000
 - 21s - loss: 0.2363 - classifier_output_aux_loss: 0.1355 - classifier_output_main_loss: 0.1008 - classifier_output_aux_acc: 0.9562 - classifier_output_main_acc: 0.9654 - val_loss: 0.3146 - val_classifier_output_aux_loss: 0.2020 - val_classifier_output_main_loss: 0.1126 - val_classifier_output_aux_acc: 0.9486 - val_classifier_output_main_acc: 0.9667
Epoch 27/1000
 - 21s - loss: 0.2296 - classifier_output_aux_loss: 0.1429 - classifier_output_main_loss: 0.0868 - classifier_output_aux_acc: 0.9586 - classifier_output_main_acc: 0.9721 - val_loss: 0.3028 - val_classifier_output_aux_loss: 0.1730 - val_classifier_output_main_loss: 0.1297 - val_classifier_output_aux_acc: 0.9486 - val_classifier_output_main_acc: 0.9653
Epoch 28/1000
 - 21s - loss: 0.2234 - classifier_output_aux_loss: 0.1267 - classifier_output_main_loss: 0.0967 - classifier_output_aux_acc: 0.9593 - classifier_output_main_acc: 0.9711 - val_loss: 0.3261 - val_classifier_output_aux_loss: 0.2345 - val_classifier_output_main_loss: 0.0916 - val_classifier_output_aux_acc: 0.9389 - val_classifier_output_main_acc: 0.9708
Epoch 29/1000
 - 21s - loss: 0.1988 - classifier_output_aux_loss: 0.1080 - classifier_output_main_loss: 0.0908 - classifier_output_aux_acc: 0.9645 - classifier_output_main_acc: 0.9713 - val_loss: 0.2520 - val_classifier_output_aux_loss: 0.1580 - val_classifier_output_main_loss: 0.0940 - val_classifier_output_aux_acc: 0.9597 - val_classifier_output_main_acc: 0.9736
Epoch 30/1000
 - 19s - loss: 0.1995 - classifier_output_aux_loss: 0.1075 - classifier_output_main_loss: 0.0920 - classifier_output_aux_acc: 0.9662 - classifier_output_main_acc: 0.9694 - val_loss: 0.3042 - val_classifier_output_aux_loss: 0.1707 - val_classifier_output_main_loss: 0.1335 - val_classifier_output_aux_acc: 0.9458 - val_classifier_output_main_acc: 0.9736
Epoch 31/1000
 - 18s - loss: 0.1956 - classifier_output_aux_loss: 0.1088 - classifier_output_main_loss: 0.0869 - classifier_output_aux_acc: 0.9673 - classifier_output_main_acc: 0.9744 - val_loss: 0.2798 - val_classifier_output_aux_loss: 0.1712 - val_classifier_output_main_loss: 0.1086 - val_classifier_output_aux_acc: 0.9514 - val_classifier_output_main_acc: 0.9694
Epoch 32/1000
 - 18s - loss: 0.1918 - classifier_output_aux_loss: 0.1065 - classifier_output_main_loss: 0.0853 - classifier_output_aux_acc: 0.9681 - classifier_output_main_acc: 0.9718 - val_loss: 0.3901 - val_classifier_output_aux_loss: 0.2843 - val_classifier_output_main_loss: 0.1058 - val_classifier_output_aux_acc: 0.9347 - val_classifier_output_main_acc: 0.9722
Epoch 33/1000
 - 18s - loss: 0.1951 - classifier_output_aux_loss: 0.1124 - classifier_output_main_loss: 0.0827 - classifier_output_aux_acc: 0.9651 - classifier_output_main_acc: 0.9753 - val_loss: 0.3265 - val_classifier_output_aux_loss: 0.1659 - val_classifier_output_main_loss: 0.1606 - val_classifier_output_aux_acc: 0.9458 - val_classifier_output_main_acc: 0.9653
Epoch 34/1000
 - 19s - loss: 0.1811 - classifier_output_aux_loss: 0.1012 - classifier_output_main_loss: 0.0799 - classifier_output_aux_acc: 0.9704 - classifier_output_main_acc: 0.9758 - val_loss: 0.3488 - val_classifier_output_aux_loss: 0.2086 - val_classifier_output_main_loss: 0.1402 - val_classifier_output_aux_acc: 0.9472 - val_classifier_output_main_acc: 0.9611
Epoch 35/1000
 - 20s - loss: 0.1805 - classifier_output_aux_loss: 0.1064 - classifier_output_main_loss: 0.0741 - classifier_output_aux_acc: 0.9690 - classifier_output_main_acc: 0.9772 - val_loss: 0.2996 - val_classifier_output_aux_loss: 0.1555 - val_classifier_output_main_loss: 0.1440 - val_classifier_output_aux_acc: 0.9583 - val_classifier_output_main_acc: 0.9694
Epoch 36/1000
 - 21s - loss: 0.1723 - classifier_output_aux_loss: 0.0974 - classifier_output_main_loss: 0.0749 - classifier_output_aux_acc: 0.9693 - classifier_output_main_acc: 0.9781 - val_loss: 0.2596 - val_classifier_output_aux_loss: 0.1793 - val_classifier_output_main_loss: 0.0803 - val_classifier_output_aux_acc: 0.9625 - val_classifier_output_main_acc: 0.9792
Epoch 37/1000
 - 21s - loss: 0.1596 - classifier_output_aux_loss: 0.0871 - classifier_output_main_loss: 0.0726 - classifier_output_aux_acc: 0.9739 - classifier_output_main_acc: 0.9767 - val_loss: 0.3316 - val_classifier_output_aux_loss: 0.2518 - val_classifier_output_main_loss: 0.0797 - val_classifier_output_aux_acc: 0.9472 - val_classifier_output_main_acc: 0.9792
Epoch 38/1000
 - 23s - loss: 0.1405 - classifier_output_aux_loss: 0.0811 - classifier_output_main_loss: 0.0594 - classifier_output_aux_acc: 0.9742 - classifier_output_main_acc: 0.9823 - val_loss: 0.3441 - val_classifier_output_aux_loss: 0.2563 - val_classifier_output_main_loss: 0.0878 - val_classifier_output_aux_acc: 0.9347 - val_classifier_output_main_acc: 0.9750
Epoch 39/1000
 - 32s - loss: 0.1619 - classifier_output_aux_loss: 0.0909 - classifier_output_main_loss: 0.0710 - classifier_output_aux_acc: 0.9713 - classifier_output_main_acc: 0.9799 - val_loss: 0.2516 - val_classifier_output_aux_loss: 0.1614 - val_classifier_output_main_loss: 0.0902 - val_classifier_output_aux_acc: 0.9597 - val_classifier_output_main_acc: 0.9778
Epoch 40/1000
 - 29s - loss: 0.1321 - classifier_output_aux_loss: 0.0827 - classifier_output_main_loss: 0.0494 - classifier_output_aux_acc: 0.9738 - classifier_output_main_acc: 0.9813 - val_loss: 0.2931 - val_classifier_output_aux_loss: 0.2089 - val_classifier_output_main_loss: 0.0842 - val_classifier_output_aux_acc: 0.9528 - val_classifier_output_main_acc: 0.9819
Epoch 41/1000
 - 55s - loss: 0.1531 - classifier_output_aux_loss: 0.0851 - classifier_output_main_loss: 0.0680 - classifier_output_aux_acc: 0.9750 - classifier_output_main_acc: 0.9812 - val_loss: 0.3002 - val_classifier_output_aux_loss: 0.1823 - val_classifier_output_main_loss: 0.1179 - val_classifier_output_aux_acc: 0.9611 - val_classifier_output_main_acc: 0.9625
Epoch 42/1000
 - 43s - loss: 0.1416 - classifier_output_aux_loss: 0.0844 - classifier_output_main_loss: 0.0571 - classifier_output_aux_acc: 0.9730 - classifier_output_main_acc: 0.9829 - val_loss: 0.3916 - val_classifier_output_aux_loss: 0.1812 - val_classifier_output_main_loss: 0.2105 - val_classifier_output_aux_acc: 0.9556 - val_classifier_output_main_acc: 0.9639
Epoch 43/1000
 - 53s - loss: 0.1428 - classifier_output_aux_loss: 0.0747 - classifier_output_main_loss: 0.0681 - classifier_output_aux_acc: 0.9764 - classifier_output_main_acc: 0.9816 - val_loss: 0.3093 - val_classifier_output_aux_loss: 0.2119 - val_classifier_output_main_loss: 0.0974 - val_classifier_output_aux_acc: 0.9486 - val_classifier_output_main_acc: 0.9792
Epoch 44/1000
 - 79s - loss: 0.1244 - classifier_output_aux_loss: 0.0670 - classifier_output_main_loss: 0.0574 - classifier_output_aux_acc: 0.9778 - classifier_output_main_acc: 0.9835 - val_loss: 0.2480 - val_classifier_output_aux_loss: 0.1711 - val_classifier_output_main_loss: 0.0770 - val_classifier_output_aux_acc: 0.9625 - val_classifier_output_main_acc: 0.9819
Epoch 45/1000
 - 31s - loss: 0.1277 - classifier_output_aux_loss: 0.0767 - classifier_output_main_loss: 0.0510 - classifier_output_aux_acc: 0.9789 - classifier_output_main_acc: 0.9863 - val_loss: 0.2290 - val_classifier_output_aux_loss: 0.1503 - val_classifier_output_main_loss: 0.0787 - val_classifier_output_aux_acc: 0.9625 - val_classifier_output_main_acc: 0.9778
Epoch 46/1000
 - 23s - loss: 0.1360 - classifier_output_aux_loss: 0.0721 - classifier_output_main_loss: 0.0639 - classifier_output_aux_acc: 0.9796 - classifier_output_main_acc: 0.9827 - val_loss: 0.2669 - val_classifier_output_aux_loss: 0.1984 - val_classifier_output_main_loss: 0.0685 - val_classifier_output_aux_acc: 0.9667 - val_classifier_output_main_acc: 0.9792
Epoch 47/1000
 - 22s - loss: 0.1291 - classifier_output_aux_loss: 0.0767 - classifier_output_main_loss: 0.0524 - classifier_output_aux_acc: 0.9772 - classifier_output_main_acc: 0.9853 - val_loss: 0.2270 - val_classifier_output_aux_loss: 0.1454 - val_classifier_output_main_loss: 0.0816 - val_classifier_output_aux_acc: 0.9694 - val_classifier_output_main_acc: 0.9806
Epoch 48/1000
 - 20s - loss: 0.1245 - classifier_output_aux_loss: 0.0663 - classifier_output_main_loss: 0.0582 - classifier_output_aux_acc: 0.9810 - classifier_output_main_acc: 0.9829 - val_loss: 0.1884 - val_classifier_output_aux_loss: 0.1085 - val_classifier_output_main_loss: 0.0798 - val_classifier_output_aux_acc: 0.9764 - val_classifier_output_main_acc: 0.9819
Epoch 49/1000
 - 23s - loss: 0.1293 - classifier_output_aux_loss: 0.0691 - classifier_output_main_loss: 0.0602 - classifier_output_aux_acc: 0.9799 - classifier_output_main_acc: 0.9830 - val_loss: 0.2506 - val_classifier_output_aux_loss: 0.1595 - val_classifier_output_main_loss: 0.0912 - val_classifier_output_aux_acc: 0.9653 - val_classifier_output_main_acc: 0.9750
Epoch 50/1000
 - 22s - loss: 0.1178 - classifier_output_aux_loss: 0.0710 - classifier_output_main_loss: 0.0468 - classifier_output_aux_acc: 0.9801 - classifier_output_main_acc: 0.9853 - val_loss: 0.2988 - val_classifier_output_aux_loss: 0.2017 - val_classifier_output_main_loss: 0.0971 - val_classifier_output_aux_acc: 0.9597 - val_classifier_output_main_acc: 0.9819
Epoch 51/1000
 - 20s - loss: 0.1145 - classifier_output_aux_loss: 0.0637 - classifier_output_main_loss: 0.0508 - classifier_output_aux_acc: 0.9824 - classifier_output_main_acc: 0.9855 - val_loss: 0.3121 - val_classifier_output_aux_loss: 0.1637 - val_classifier_output_main_loss: 0.1485 - val_classifier_output_aux_acc: 0.9611 - val_classifier_output_main_acc: 0.9667
Epoch 52/1000
 - 20s - loss: 0.1244 - classifier_output_aux_loss: 0.0730 - classifier_output_main_loss: 0.0514 - classifier_output_aux_acc: 0.9787 - classifier_output_main_acc: 0.9864 - val_loss: 0.4247 - val_classifier_output_aux_loss: 0.1936 - val_classifier_output_main_loss: 0.2311 - val_classifier_output_aux_acc: 0.9542 - val_classifier_output_main_acc: 0.9653
Epoch 53/1000
 - 21s - loss: 0.1139 - classifier_output_aux_loss: 0.0586 - classifier_output_main_loss: 0.0553 - classifier_output_aux_acc: 0.9849 - classifier_output_main_acc: 0.9856 - val_loss: 0.1962 - val_classifier_output_aux_loss: 0.1012 - val_classifier_output_main_loss: 0.0951 - val_classifier_output_aux_acc: 0.9778 - val_classifier_output_main_acc: 0.9806
Epoch 54/1000
 - 20s - loss: 0.1077 - classifier_output_aux_loss: 0.0623 - classifier_output_main_loss: 0.0454 - classifier_output_aux_acc: 0.9838 - classifier_output_main_acc: 0.9870 - val_loss: 0.4582 - val_classifier_output_aux_loss: 0.2408 - val_classifier_output_main_loss: 0.2174 - val_classifier_output_aux_acc: 0.9528 - val_classifier_output_main_acc: 0.9667
Epoch 55/1000
 - 21s - loss: 0.1222 - classifier_output_aux_loss: 0.0663 - classifier_output_main_loss: 0.0559 - classifier_output_aux_acc: 0.9806 - classifier_output_main_acc: 0.9866 - val_loss: 0.2666 - val_classifier_output_aux_loss: 0.1837 - val_classifier_output_main_loss: 0.0829 - val_classifier_output_aux_acc: 0.9639 - val_classifier_output_main_acc: 0.9819
Epoch 56/1000
 - 20s - loss: 0.1051 - classifier_output_aux_loss: 0.0604 - classifier_output_main_loss: 0.0447 - classifier_output_aux_acc: 0.9832 - classifier_output_main_acc: 0.9878 - val_loss: 0.3903 - val_classifier_output_aux_loss: 0.2415 - val_classifier_output_main_loss: 0.1488 - val_classifier_output_aux_acc: 0.9611 - val_classifier_output_main_acc: 0.9708
Epoch 57/1000
 - 21s - loss: 0.1124 - classifier_output_aux_loss: 0.0643 - classifier_output_main_loss: 0.0481 - classifier_output_aux_acc: 0.9830 - classifier_output_main_acc: 0.9864 - val_loss: 0.2832 - val_classifier_output_aux_loss: 0.1782 - val_classifier_output_main_loss: 0.1050 - val_classifier_output_aux_acc: 0.9597 - val_classifier_output_main_acc: 0.9778
Epoch 58/1000
 - 20s - loss: 0.1168 - classifier_output_aux_loss: 0.0640 - classifier_output_main_loss: 0.0528 - classifier_output_aux_acc: 0.9832 - classifier_output_main_acc: 0.9846 - val_loss: 0.3085 - val_classifier_output_aux_loss: 0.1928 - val_classifier_output_main_loss: 0.1156 - val_classifier_output_aux_acc: 0.9653 - val_classifier_output_main_acc: 0.9708
cm_aux: [[201  25  10   1  54   9]
 [ 48 157   5  10  62  18]
 [ 45  49 120  14  41  31]
 [ 13   0  17 192  61  17]
 [ 22  23  13   9 224   9]
 [ 16  11   1  41  43 188]]
cm_main: [[152  23  10   9  58  48]
 [  0 176   2  59  32  31]
 [  2   9 275  11   0   3]
 [  0   7   7 276   8   2]
 [  2  42   2  12 202  40]
 [  6  27   1   7  21 238]]
normalized cm_main: [[0.50666667 0.07666667 0.03333333 0.03       0.19333333 0.16      ]
 [0.         0.58666667 0.00666667 0.19666667 0.10666667 0.10333333]
 [0.00666667 0.03       0.91666667 0.03666667 0.         0.01      ]
 [0.         0.02333333 0.02333333 0.92       0.02666667 0.00666667]
 [0.00666667 0.14       0.00666667 0.04       0.67333333 0.13333333]
 [0.02       0.09       0.00333333 0.02333333 0.07       0.79333333]]
metrics: ['loss', 'classifier_output_aux_loss', 'classifier_output_main_loss', 'classifier_output_aux_acc', 'classifier_output_main_acc']
Test score: [4.534207284715441, 2.901656764878167, 1.632550544676164, 0.6011111111111112, 0.7327777777777778]
Test loss: 2.901656764878167
Test accuracy of aux: 0.6011111111111112
Test accuracy of main: 0.7327777777777778
Saving model to disk 

__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
main_input_1 (InputLayer)       (None, 29, 6, 20, 3) 0                                            
__________________________________________________________________________________________________
main_input_2 (InputLayer)       (None, 29, 6, 20, 3) 0                                            
__________________________________________________________________________________________________
feature_output_aux (TimeDistrib (None, 29, 64)       78400       main_input_1[0][0]               
__________________________________________________________________________________________________
feature_output_main (TimeDistri (None, 29, 64)       78400       main_input_2[0][0]               
__________________________________________________________________________________________________
gru_5 (GRU)                     (None, 128)          74112       feature_output_aux[0][0]         
__________________________________________________________________________________________________
gru_6 (GRU)                     (None, 128)          74112       feature_output_main[0][0]        
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 128)          0           gru_5[0][0]                      
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 128)          0           gru_6[0][0]                      
__________________________________________________________________________________________________
gradient_reversal_5 (GradientRe (None, 128)          0           dropout_16[0][0]                 
__________________________________________________________________________________________________
gradient_reversal_6 (GradientRe (None, 128)          0           dropout_14[0][0]                 
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 256)          0           dropout_14[0][0]                 
                                                                 gradient_reversal_5[0][0]        
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 256)          0           dropout_16[0][0]                 
                                                                 gradient_reversal_6[0][0]        
__________________________________________________________________________________________________
dense_17 (Dense)                (None, 128)          32896       concatenate_5[0][0]              
__________________________________________________________________________________________________
dense_18 (Dense)                (None, 128)          32896       concatenate_6[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 128)          0           dense_17[0][0]                   
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 128)          0           dense_18[0][0]                   
__________________________________________________________________________________________________
classifier_output_aux (Dense)   (None, 6)            774         dropout_17[0][0]                 
__________________________________________________________________________________________________
classifier_output_main (Dense)  (None, 6)            774         dropout_18[0][0]                 
==================================================================================================
Total params: 372,364
Trainable params: 372,364
Non-trainable params: 0
__________________________________________________________________________________________________
None
Loading Data...
domain_type: 3
Loaded Data wf_tally_slice 2 (7200, 29, 6, 20, 3) 4 (7200, 6) 2 (1800, 29, 6, 20, 3)
n_timesteps: 29
Train on 6480 samples, validate on 720 samples
Epoch 1/1000
 - 26s - loss: 3.2549 - classifier_output_aux_loss: 1.6098 - classifier_output_main_loss: 1.6451 - classifier_output_aux_acc: 0.3131 - classifier_output_main_acc: 0.2992 - val_loss: 2.7941 - val_classifier_output_aux_loss: 1.3558 - val_classifier_output_main_loss: 1.4382 - val_classifier_output_aux_acc: 0.4458 - val_classifier_output_main_acc: 0.4306
Epoch 2/1000
 - 21s - loss: 2.7369 - classifier_output_aux_loss: 1.3670 - classifier_output_main_loss: 1.3699 - classifier_output_aux_acc: 0.4557 - classifier_output_main_acc: 0.4630 - val_loss: 2.3237 - val_classifier_output_aux_loss: 1.1431 - val_classifier_output_main_loss: 1.1806 - val_classifier_output_aux_acc: 0.5764 - val_classifier_output_main_acc: 0.5556
Epoch 3/1000
 - 20s - loss: 2.3400 - classifier_output_aux_loss: 1.1680 - classifier_output_main_loss: 1.1720 - classifier_output_aux_acc: 0.5489 - classifier_output_main_acc: 0.5488 - val_loss: 2.0017 - val_classifier_output_aux_loss: 1.0313 - val_classifier_output_main_loss: 0.9703 - val_classifier_output_aux_acc: 0.6014 - val_classifier_output_main_acc: 0.6556
Epoch 4/1000
 - 20s - loss: 2.0553 - classifier_output_aux_loss: 0.9994 - classifier_output_main_loss: 1.0560 - classifier_output_aux_acc: 0.6170 - classifier_output_main_acc: 0.6082 - val_loss: 1.6744 - val_classifier_output_aux_loss: 0.8118 - val_classifier_output_main_loss: 0.8626 - val_classifier_output_aux_acc: 0.6833 - val_classifier_output_main_acc: 0.6903
Epoch 5/1000
 - 20s - loss: 1.7641 - classifier_output_aux_loss: 0.8446 - classifier_output_main_loss: 0.9194 - classifier_output_aux_acc: 0.6787 - classifier_output_main_acc: 0.6529 - val_loss: 1.5755 - val_classifier_output_aux_loss: 0.7571 - val_classifier_output_main_loss: 0.8185 - val_classifier_output_aux_acc: 0.7292 - val_classifier_output_main_acc: 0.7222
Epoch 6/1000
 - 20s - loss: 1.5719 - classifier_output_aux_loss: 0.7453 - classifier_output_main_loss: 0.8266 - classifier_output_aux_acc: 0.7231 - classifier_output_main_acc: 0.7028 - val_loss: 1.3203 - val_classifier_output_aux_loss: 0.6583 - val_classifier_output_main_loss: 0.6620 - val_classifier_output_aux_acc: 0.7681 - val_classifier_output_main_acc: 0.7667
Epoch 7/1000
 - 20s - loss: 1.3523 - classifier_output_aux_loss: 0.6477 - classifier_output_main_loss: 0.7046 - classifier_output_aux_acc: 0.7565 - classifier_output_main_acc: 0.7406 - val_loss: 1.8199 - val_classifier_output_aux_loss: 1.1745 - val_classifier_output_main_loss: 0.6455 - val_classifier_output_aux_acc: 0.6472 - val_classifier_output_main_acc: 0.7778
Epoch 8/1000
 - 20s - loss: 1.1945 - classifier_output_aux_loss: 0.5965 - classifier_output_main_loss: 0.5980 - classifier_output_aux_acc: 0.7795 - classifier_output_main_acc: 0.7841 - val_loss: 1.0095 - val_classifier_output_aux_loss: 0.5975 - val_classifier_output_main_loss: 0.4120 - val_classifier_output_aux_acc: 0.7778 - val_classifier_output_main_acc: 0.8639
Epoch 9/1000
 - 20s - loss: 1.0522 - classifier_output_aux_loss: 0.5200 - classifier_output_main_loss: 0.5322 - classifier_output_aux_acc: 0.8103 - classifier_output_main_acc: 0.8114 - val_loss: 0.8554 - val_classifier_output_aux_loss: 0.4513 - val_classifier_output_main_loss: 0.4041 - val_classifier_output_aux_acc: 0.8472 - val_classifier_output_main_acc: 0.8653
Epoch 10/1000
 - 20s - loss: 0.9457 - classifier_output_aux_loss: 0.4732 - classifier_output_main_loss: 0.4724 - classifier_output_aux_acc: 0.8275 - classifier_output_main_acc: 0.8332 - val_loss: 0.9364 - val_classifier_output_aux_loss: 0.4899 - val_classifier_output_main_loss: 0.4465 - val_classifier_output_aux_acc: 0.8208 - val_classifier_output_main_acc: 0.8486
Epoch 11/1000
 - 20s - loss: 0.8433 - classifier_output_aux_loss: 0.4290 - classifier_output_main_loss: 0.4143 - classifier_output_aux_acc: 0.8502 - classifier_output_main_acc: 0.8542 - val_loss: 0.7702 - val_classifier_output_aux_loss: 0.4464 - val_classifier_output_main_loss: 0.3238 - val_classifier_output_aux_acc: 0.8611 - val_classifier_output_main_acc: 0.8931
Epoch 12/1000
 - 20s - loss: 0.7747 - classifier_output_aux_loss: 0.4027 - classifier_output_main_loss: 0.3720 - classifier_output_aux_acc: 0.8586 - classifier_output_main_acc: 0.8725 - val_loss: 0.8666 - val_classifier_output_aux_loss: 0.4573 - val_classifier_output_main_loss: 0.4093 - val_classifier_output_aux_acc: 0.8542 - val_classifier_output_main_acc: 0.8736
Epoch 13/1000
 - 24s - loss: 0.7035 - classifier_output_aux_loss: 0.3682 - classifier_output_main_loss: 0.3353 - classifier_output_aux_acc: 0.8705 - classifier_output_main_acc: 0.8867 - val_loss: 0.5833 - val_classifier_output_aux_loss: 0.3395 - val_classifier_output_main_loss: 0.2438 - val_classifier_output_aux_acc: 0.8944 - val_classifier_output_main_acc: 0.9111
Epoch 14/1000
 - 24s - loss: 0.6253 - classifier_output_aux_loss: 0.3221 - classifier_output_main_loss: 0.3032 - classifier_output_aux_acc: 0.8883 - classifier_output_main_acc: 0.8998 - val_loss: 0.5849 - val_classifier_output_aux_loss: 0.3352 - val_classifier_output_main_loss: 0.2497 - val_classifier_output_aux_acc: 0.8903 - val_classifier_output_main_acc: 0.9236
Epoch 15/1000
 - 24s - loss: 0.5830 - classifier_output_aux_loss: 0.3106 - classifier_output_main_loss: 0.2724 - classifier_output_aux_acc: 0.8906 - classifier_output_main_acc: 0.9042 - val_loss: 0.5277 - val_classifier_output_aux_loss: 0.2853 - val_classifier_output_main_loss: 0.2423 - val_classifier_output_aux_acc: 0.9042 - val_classifier_output_main_acc: 0.9250
Epoch 16/1000
 - 24s - loss: 0.5155 - classifier_output_aux_loss: 0.2812 - classifier_output_main_loss: 0.2344 - classifier_output_aux_acc: 0.8989 - classifier_output_main_acc: 0.9190 - val_loss: 0.5941 - val_classifier_output_aux_loss: 0.3386 - val_classifier_output_main_loss: 0.2554 - val_classifier_output_aux_acc: 0.8806 - val_classifier_output_main_acc: 0.9111
Epoch 17/1000
 - 24s - loss: 0.4760 - classifier_output_aux_loss: 0.2593 - classifier_output_main_loss: 0.2167 - classifier_output_aux_acc: 0.9136 - classifier_output_main_acc: 0.9272 - val_loss: 0.4810 - val_classifier_output_aux_loss: 0.2859 - val_classifier_output_main_loss: 0.1950 - val_classifier_output_aux_acc: 0.9097 - val_classifier_output_main_acc: 0.9444
Epoch 18/1000
 - 24s - loss: 0.4235 - classifier_output_aux_loss: 0.2304 - classifier_output_main_loss: 0.1930 - classifier_output_aux_acc: 0.9204 - classifier_output_main_acc: 0.9353 - val_loss: 0.5669 - val_classifier_output_aux_loss: 0.4207 - val_classifier_output_main_loss: 0.1462 - val_classifier_output_aux_acc: 0.8722 - val_classifier_output_main_acc: 0.9611
Epoch 19/1000
 - 24s - loss: 0.4292 - classifier_output_aux_loss: 0.2386 - classifier_output_main_loss: 0.1906 - classifier_output_aux_acc: 0.9160 - classifier_output_main_acc: 0.9390 - val_loss: 0.5197 - val_classifier_output_aux_loss: 0.3882 - val_classifier_output_main_loss: 0.1315 - val_classifier_output_aux_acc: 0.8764 - val_classifier_output_main_acc: 0.9611
Epoch 20/1000
 - 24s - loss: 0.3709 - classifier_output_aux_loss: 0.2038 - classifier_output_main_loss: 0.1670 - classifier_output_aux_acc: 0.9298 - classifier_output_main_acc: 0.9448 - val_loss: 0.4864 - val_classifier_output_aux_loss: 0.2361 - val_classifier_output_main_loss: 0.2503 - val_classifier_output_aux_acc: 0.9236 - val_classifier_output_main_acc: 0.9361
Epoch 21/1000
 - 24s - loss: 0.3691 - classifier_output_aux_loss: 0.1983 - classifier_output_main_loss: 0.1708 - classifier_output_aux_acc: 0.9340 - classifier_output_main_acc: 0.9431 - val_loss: 0.3704 - val_classifier_output_aux_loss: 0.2347 - val_classifier_output_main_loss: 0.1358 - val_classifier_output_aux_acc: 0.9264 - val_classifier_output_main_acc: 0.9625
Epoch 22/1000
 - 24s - loss: 0.3332 - classifier_output_aux_loss: 0.1778 - classifier_output_main_loss: 0.1553 - classifier_output_aux_acc: 0.9398 - classifier_output_main_acc: 0.9526 - val_loss: 0.4146 - val_classifier_output_aux_loss: 0.2829 - val_classifier_output_main_loss: 0.1317 - val_classifier_output_aux_acc: 0.9111 - val_classifier_output_main_acc: 0.9639
Epoch 23/1000
 - 24s - loss: 0.3092 - classifier_output_aux_loss: 0.1826 - classifier_output_main_loss: 0.1266 - classifier_output_aux_acc: 0.9378 - classifier_output_main_acc: 0.9573 - val_loss: 0.4836 - val_classifier_output_aux_loss: 0.2698 - val_classifier_output_main_loss: 0.2137 - val_classifier_output_aux_acc: 0.9181 - val_classifier_output_main_acc: 0.9514
Epoch 24/1000
 - 24s - loss: 0.2967 - classifier_output_aux_loss: 0.1565 - classifier_output_main_loss: 0.1402 - classifier_output_aux_acc: 0.9480 - classifier_output_main_acc: 0.9562 - val_loss: 0.4542 - val_classifier_output_aux_loss: 0.3414 - val_classifier_output_main_loss: 0.1128 - val_classifier_output_aux_acc: 0.9028 - val_classifier_output_main_acc: 0.9708
Epoch 25/1000
 - 24s - loss: 0.2776 - classifier_output_aux_loss: 0.1560 - classifier_output_main_loss: 0.1217 - classifier_output_aux_acc: 0.9478 - classifier_output_main_acc: 0.9610 - val_loss: 0.3936 - val_classifier_output_aux_loss: 0.2582 - val_classifier_output_main_loss: 0.1353 - val_classifier_output_aux_acc: 0.9194 - val_classifier_output_main_acc: 0.9667
Epoch 26/1000
 - 24s - loss: 0.2602 - classifier_output_aux_loss: 0.1453 - classifier_output_main_loss: 0.1148 - classifier_output_aux_acc: 0.9552 - classifier_output_main_acc: 0.9627 - val_loss: 0.5342 - val_classifier_output_aux_loss: 0.3622 - val_classifier_output_main_loss: 0.1720 - val_classifier_output_aux_acc: 0.9083 - val_classifier_output_main_acc: 0.9597
Epoch 27/1000
 - 24s - loss: 0.2520 - classifier_output_aux_loss: 0.1406 - classifier_output_main_loss: 0.1113 - classifier_output_aux_acc: 0.9545 - classifier_output_main_acc: 0.9664 - val_loss: 0.4290 - val_classifier_output_aux_loss: 0.2977 - val_classifier_output_main_loss: 0.1314 - val_classifier_output_aux_acc: 0.9153 - val_classifier_output_main_acc: 0.9681
Epoch 28/1000
 - 24s - loss: 0.2291 - classifier_output_aux_loss: 0.1280 - classifier_output_main_loss: 0.1012 - classifier_output_aux_acc: 0.9583 - classifier_output_main_acc: 0.9704 - val_loss: 0.3989 - val_classifier_output_aux_loss: 0.2962 - val_classifier_output_main_loss: 0.1027 - val_classifier_output_aux_acc: 0.9194 - val_classifier_output_main_acc: 0.9806
Epoch 29/1000
 - 24s - loss: 0.2253 - classifier_output_aux_loss: 0.1178 - classifier_output_main_loss: 0.1075 - classifier_output_aux_acc: 0.9583 - classifier_output_main_acc: 0.9664 - val_loss: 0.4199 - val_classifier_output_aux_loss: 0.3257 - val_classifier_output_main_loss: 0.0942 - val_classifier_output_aux_acc: 0.9167 - val_classifier_output_main_acc: 0.9806
Epoch 30/1000
 - 24s - loss: 0.2151 - classifier_output_aux_loss: 0.1156 - classifier_output_main_loss: 0.0995 - classifier_output_aux_acc: 0.9628 - classifier_output_main_acc: 0.9693 - val_loss: 0.4978 - val_classifier_output_aux_loss: 0.3541 - val_classifier_output_main_loss: 0.1437 - val_classifier_output_aux_acc: 0.9069 - val_classifier_output_main_acc: 0.9569
Epoch 31/1000
 - 24s - loss: 0.2204 - classifier_output_aux_loss: 0.1173 - classifier_output_main_loss: 0.1031 - classifier_output_aux_acc: 0.9644 - classifier_output_main_acc: 0.9665 - val_loss: 0.4014 - val_classifier_output_aux_loss: 0.2150 - val_classifier_output_main_loss: 0.1864 - val_classifier_output_aux_acc: 0.9389 - val_classifier_output_main_acc: 0.9583
cm_aux: [[144  27   9   0  77  43]
 [ 41 127   7  16  83  26]
 [ 17  14 134  28  66  41]
 [  1   1  17 228  26  27]
 [  5  13  17  23 228  14]
 [  5   8   2  29  31 225]]
cm_main: [[227  28   7   2  23  13]
 [  2 183   0  39  62  14]
 [  6  11 249  31   2   1]
 [  5  14  36 230  11   4]
 [  1  41   0   6 235  17]
 [ 26  41   5   4  22 202]]
normalized cm_main: [[0.75666667 0.09333333 0.02333333 0.00666667 0.07666667 0.04333333]
 [0.00666667 0.61       0.         0.13       0.20666667 0.04666667]
 [0.02       0.03666667 0.83       0.10333333 0.00666667 0.00333333]
 [0.01666667 0.04666667 0.12       0.76666667 0.03666667 0.01333333]
 [0.00333333 0.13666667 0.         0.02       0.78333333 0.05666667]
 [0.08666667 0.13666667 0.01666667 0.01333333 0.07333333 0.67333333]]
metrics: ['loss', 'classifier_output_aux_loss', 'classifier_output_main_loss', 'classifier_output_aux_acc', 'classifier_output_main_acc']
Test score: [3.829673555162218, 2.4748114680581623, 1.3548620682126946, 0.6033333333333334, 0.7366666666666667]
Test loss: 2.4748114680581623
Test accuracy of aux: 0.6033333333333334
Test accuracy of main: 0.7366666666666667
Saving model to disk 

__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
main_input_1 (InputLayer)       (None, 29, 6, 20, 3) 0                                            
__________________________________________________________________________________________________
main_input_2 (InputLayer)       (None, 29, 6, 20, 3) 0                                            
__________________________________________________________________________________________________
feature_output_aux (TimeDistrib (None, 29, 64)       78400       main_input_1[0][0]               
__________________________________________________________________________________________________
feature_output_main (TimeDistri (None, 29, 64)       78400       main_input_2[0][0]               
__________________________________________________________________________________________________
gru_1 (GRU)                     (None, 128)          74112       feature_output_aux[0][0]         
__________________________________________________________________________________________________
gru_2 (GRU)                     (None, 128)          74112       feature_output_main[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 128)          0           gru_1[0][0]                      
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 128)          0           gru_2[0][0]                      
__________________________________________________________________________________________________
gradient_reversal_1 (GradientRe (None, 128)          0           dropout_4[0][0]                  
__________________________________________________________________________________________________
gradient_reversal_2 (GradientRe (None, 128)          0           dropout_2[0][0]                  
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 256)          0           dropout_2[0][0]                  
                                                                 gradient_reversal_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 256)          0           dropout_4[0][0]                  
                                                                 gradient_reversal_2[0][0]        
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 128)          32896       concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_6 (Dense)                 (None, 128)          32896       concatenate_2[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 128)          0           dense_5[0][0]                    
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 128)          0           dense_6[0][0]                    
__________________________________________________________________________________________________
classifier_output_aux (Dense)   (None, 6)            774         dropout_5[0][0]                  
__________________________________________________________________________________________________
classifier_output_main (Dense)  (None, 6)            774         dropout_6[0][0]                  
==================================================================================================
Total params: 372,364
Trainable params: 372,364
Non-trainable params: 0
__________________________________________________________________________________________________
None
Loading Data...
domain_type: 3
Loaded Data wf_tally_slice 2 (7200, 29, 6, 20, 3) 4 (7200, 6) 2 (1800, 29, 6, 20, 3)
n_timesteps: 29
Train on 6480 samples, validate on 720 samples
Epoch 1/1000
 - 27s - loss: 3.2681 - classifier_output_aux_loss: 1.5896 - classifier_output_main_loss: 1.6785 - classifier_output_aux_acc: 0.3238 - classifier_output_main_acc: 0.2653 - val_loss: 2.8316 - val_classifier_output_aux_loss: 1.4020 - val_classifier_output_main_loss: 1.4296 - val_classifier_output_aux_acc: 0.4319 - val_classifier_output_main_acc: 0.4611
Epoch 2/1000
 - 24s - loss: 2.6770 - classifier_output_aux_loss: 1.3502 - classifier_output_main_loss: 1.3269 - classifier_output_aux_acc: 0.4636 - classifier_output_main_acc: 0.4847 - val_loss: 2.2997 - val_classifier_output_aux_loss: 1.1448 - val_classifier_output_main_loss: 1.1549 - val_classifier_output_aux_acc: 0.5514 - val_classifier_output_main_acc: 0.5500
Epoch 3/1000
 - 24s - loss: 2.2653 - classifier_output_aux_loss: 1.1277 - classifier_output_main_loss: 1.1376 - classifier_output_aux_acc: 0.5659 - classifier_output_main_acc: 0.5687 - val_loss: 1.9675 - val_classifier_output_aux_loss: 0.9288 - val_classifier_output_main_loss: 1.0387 - val_classifier_output_aux_acc: 0.6486 - val_classifier_output_main_acc: 0.5972
Epoch 4/1000
 - 24s - loss: 1.9410 - classifier_output_aux_loss: 0.9581 - classifier_output_main_loss: 0.9829 - classifier_output_aux_acc: 0.6304 - classifier_output_main_acc: 0.6437 - val_loss: 1.5614 - val_classifier_output_aux_loss: 0.7637 - val_classifier_output_main_loss: 0.7977 - val_classifier_output_aux_acc: 0.7167 - val_classifier_output_main_acc: 0.7111
Epoch 5/1000
 - 24s - loss: 1.6655 - classifier_output_aux_loss: 0.8202 - classifier_output_main_loss: 0.8453 - classifier_output_aux_acc: 0.6938 - classifier_output_main_acc: 0.6941 - val_loss: 1.3356 - val_classifier_output_aux_loss: 0.7202 - val_classifier_output_main_loss: 0.6154 - val_classifier_output_aux_acc: 0.7181 - val_classifier_output_main_acc: 0.7833
Epoch 6/1000
 - 25s - loss: 1.4299 - classifier_output_aux_loss: 0.7199 - classifier_output_main_loss: 0.7099 - classifier_output_aux_acc: 0.7313 - classifier_output_main_acc: 0.7458 - val_loss: 1.2834 - val_classifier_output_aux_loss: 0.7399 - val_classifier_output_main_loss: 0.5436 - val_classifier_output_aux_acc: 0.6972 - val_classifier_output_main_acc: 0.8056
Epoch 7/1000
 - 22s - loss: 1.2435 - classifier_output_aux_loss: 0.6441 - classifier_output_main_loss: 0.5994 - classifier_output_aux_acc: 0.7644 - classifier_output_main_acc: 0.7906 - val_loss: 1.1267 - val_classifier_output_aux_loss: 0.6873 - val_classifier_output_main_loss: 0.4395 - val_classifier_output_aux_acc: 0.7417 - val_classifier_output_main_acc: 0.8306
Epoch 8/1000
 - 20s - loss: 1.0776 - classifier_output_aux_loss: 0.5693 - classifier_output_main_loss: 0.5083 - classifier_output_aux_acc: 0.7907 - classifier_output_main_acc: 0.8225 - val_loss: 0.8481 - val_classifier_output_aux_loss: 0.4780 - val_classifier_output_main_loss: 0.3701 - val_classifier_output_aux_acc: 0.8097 - val_classifier_output_main_acc: 0.8542
Epoch 9/1000
 - 21s - loss: 0.9495 - classifier_output_aux_loss: 0.5031 - classifier_output_main_loss: 0.4464 - classifier_output_aux_acc: 0.8185 - classifier_output_main_acc: 0.8438 - val_loss: 0.8039 - val_classifier_output_aux_loss: 0.4627 - val_classifier_output_main_loss: 0.3412 - val_classifier_output_aux_acc: 0.8292 - val_classifier_output_main_acc: 0.8597
Epoch 10/1000
 - 20s - loss: 0.8335 - classifier_output_aux_loss: 0.4525 - classifier_output_main_loss: 0.3810 - classifier_output_aux_acc: 0.8375 - classifier_output_main_acc: 0.8647 - val_loss: 0.7123 - val_classifier_output_aux_loss: 0.3993 - val_classifier_output_main_loss: 0.3130 - val_classifier_output_aux_acc: 0.8583 - val_classifier_output_main_acc: 0.8944
Epoch 11/1000
 - 20s - loss: 0.7428 - classifier_output_aux_loss: 0.4056 - classifier_output_main_loss: 0.3372 - classifier_output_aux_acc: 0.8546 - classifier_output_main_acc: 0.8858 - val_loss: 0.6455 - val_classifier_output_aux_loss: 0.3631 - val_classifier_output_main_loss: 0.2824 - val_classifier_output_aux_acc: 0.8722 - val_classifier_output_main_acc: 0.8944
Epoch 12/1000
 - 20s - loss: 0.6858 - classifier_output_aux_loss: 0.3783 - classifier_output_main_loss: 0.3075 - classifier_output_aux_acc: 0.8690 - classifier_output_main_acc: 0.8957 - val_loss: 0.5676 - val_classifier_output_aux_loss: 0.3321 - val_classifier_output_main_loss: 0.2355 - val_classifier_output_aux_acc: 0.8861 - val_classifier_output_main_acc: 0.9083
Epoch 13/1000
 - 20s - loss: 0.5862 - classifier_output_aux_loss: 0.3301 - classifier_output_main_loss: 0.2561 - classifier_output_aux_acc: 0.8838 - classifier_output_main_acc: 0.9096 - val_loss: 0.5572 - val_classifier_output_aux_loss: 0.3453 - val_classifier_output_main_loss: 0.2119 - val_classifier_output_aux_acc: 0.8847 - val_classifier_output_main_acc: 0.9250
Epoch 14/1000
 - 19s - loss: 0.5439 - classifier_output_aux_loss: 0.3072 - classifier_output_main_loss: 0.2367 - classifier_output_aux_acc: 0.8918 - classifier_output_main_acc: 0.9157 - val_loss: 0.4139 - val_classifier_output_aux_loss: 0.2602 - val_classifier_output_main_loss: 0.1537 - val_classifier_output_aux_acc: 0.9056 - val_classifier_output_main_acc: 0.9431
Epoch 15/1000
 - 20s - loss: 0.5051 - classifier_output_aux_loss: 0.2841 - classifier_output_main_loss: 0.2210 - classifier_output_aux_acc: 0.9022 - classifier_output_main_acc: 0.9273 - val_loss: 0.4159 - val_classifier_output_aux_loss: 0.2191 - val_classifier_output_main_loss: 0.1968 - val_classifier_output_aux_acc: 0.9278 - val_classifier_output_main_acc: 0.9431
Epoch 16/1000
 - 20s - loss: 0.4537 - classifier_output_aux_loss: 0.2620 - classifier_output_main_loss: 0.1916 - classifier_output_aux_acc: 0.9097 - classifier_output_main_acc: 0.9361 - val_loss: 0.3550 - val_classifier_output_aux_loss: 0.2379 - val_classifier_output_main_loss: 0.1171 - val_classifier_output_aux_acc: 0.9139 - val_classifier_output_main_acc: 0.9611
Epoch 17/1000
 - 20s - loss: 0.4006 - classifier_output_aux_loss: 0.2385 - classifier_output_main_loss: 0.1621 - classifier_output_aux_acc: 0.9191 - classifier_output_main_acc: 0.9465 - val_loss: 0.6208 - val_classifier_output_aux_loss: 0.3774 - val_classifier_output_main_loss: 0.2433 - val_classifier_output_aux_acc: 0.8889 - val_classifier_output_main_acc: 0.9111
Epoch 18/1000
 - 21s - loss: 0.3648 - classifier_output_aux_loss: 0.2141 - classifier_output_main_loss: 0.1507 - classifier_output_aux_acc: 0.9278 - classifier_output_main_acc: 0.9508 - val_loss: 0.6045 - val_classifier_output_aux_loss: 0.4821 - val_classifier_output_main_loss: 0.1223 - val_classifier_output_aux_acc: 0.8653 - val_classifier_output_main_acc: 0.9597
Epoch 19/1000
 - 24s - loss: 0.3730 - classifier_output_aux_loss: 0.2141 - classifier_output_main_loss: 0.1590 - classifier_output_aux_acc: 0.9241 - classifier_output_main_acc: 0.9505 - val_loss: 0.3560 - val_classifier_output_aux_loss: 0.2307 - val_classifier_output_main_loss: 0.1253 - val_classifier_output_aux_acc: 0.9236 - val_classifier_output_main_acc: 0.9542
Epoch 20/1000
 - 24s - loss: 0.3482 - classifier_output_aux_loss: 0.2130 - classifier_output_main_loss: 0.1352 - classifier_output_aux_acc: 0.9284 - classifier_output_main_acc: 0.9576 - val_loss: 0.3621 - val_classifier_output_aux_loss: 0.2595 - val_classifier_output_main_loss: 0.1027 - val_classifier_output_aux_acc: 0.9111 - val_classifier_output_main_acc: 0.9611
Epoch 21/1000
 - 23s - loss: 0.2914 - classifier_output_aux_loss: 0.1704 - classifier_output_main_loss: 0.1209 - classifier_output_aux_acc: 0.9420 - classifier_output_main_acc: 0.9611 - val_loss: 0.4435 - val_classifier_output_aux_loss: 0.2722 - val_classifier_output_main_loss: 0.1713 - val_classifier_output_aux_acc: 0.9125 - val_classifier_output_main_acc: 0.9472
Epoch 22/1000
 - 24s - loss: 0.3040 - classifier_output_aux_loss: 0.1803 - classifier_output_main_loss: 0.1237 - classifier_output_aux_acc: 0.9390 - classifier_output_main_acc: 0.9585 - val_loss: 0.2892 - val_classifier_output_aux_loss: 0.1582 - val_classifier_output_main_loss: 0.1310 - val_classifier_output_aux_acc: 0.9472 - val_classifier_output_main_acc: 0.9597
Epoch 23/1000
 - 24s - loss: 0.2863 - classifier_output_aux_loss: 0.1718 - classifier_output_main_loss: 0.1145 - classifier_output_aux_acc: 0.9435 - classifier_output_main_acc: 0.9642 - val_loss: 0.4995 - val_classifier_output_aux_loss: 0.2824 - val_classifier_output_main_loss: 0.2170 - val_classifier_output_aux_acc: 0.9125 - val_classifier_output_main_acc: 0.9375
Epoch 24/1000
 - 23s - loss: 0.2622 - classifier_output_aux_loss: 0.1513 - classifier_output_main_loss: 0.1110 - classifier_output_aux_acc: 0.9528 - classifier_output_main_acc: 0.9633 - val_loss: 0.2948 - val_classifier_output_aux_loss: 0.1780 - val_classifier_output_main_loss: 0.1168 - val_classifier_output_aux_acc: 0.9444 - val_classifier_output_main_acc: 0.9653
Epoch 25/1000
 - 24s - loss: 0.2498 - classifier_output_aux_loss: 0.1476 - classifier_output_main_loss: 0.1022 - classifier_output_aux_acc: 0.9529 - classifier_output_main_acc: 0.9690 - val_loss: 0.4104 - val_classifier_output_aux_loss: 0.2881 - val_classifier_output_main_loss: 0.1223 - val_classifier_output_aux_acc: 0.9056 - val_classifier_output_main_acc: 0.9625
Epoch 26/1000
 - 23s - loss: 0.2539 - classifier_output_aux_loss: 0.1495 - classifier_output_main_loss: 0.1044 - classifier_output_aux_acc: 0.9492 - classifier_output_main_acc: 0.9657 - val_loss: 0.2671 - val_classifier_output_aux_loss: 0.1460 - val_classifier_output_main_loss: 0.1211 - val_classifier_output_aux_acc: 0.9486 - val_classifier_output_main_acc: 0.9653
Epoch 27/1000
 - 23s - loss: 0.2335 - classifier_output_aux_loss: 0.1396 - classifier_output_main_loss: 0.0939 - classifier_output_aux_acc: 0.9562 - classifier_output_main_acc: 0.9702 - val_loss: 0.2780 - val_classifier_output_aux_loss: 0.1542 - val_classifier_output_main_loss: 0.1238 - val_classifier_output_aux_acc: 0.9444 - val_classifier_output_main_acc: 0.9639
Epoch 28/1000
 - 23s - loss: 0.2124 - classifier_output_aux_loss: 0.1240 - classifier_output_main_loss: 0.0884 - classifier_output_aux_acc: 0.9591 - classifier_output_main_acc: 0.9711 - val_loss: 0.2374 - val_classifier_output_aux_loss: 0.1489 - val_classifier_output_main_loss: 0.0886 - val_classifier_output_aux_acc: 0.9569 - val_classifier_output_main_acc: 0.9750
Epoch 29/1000
 - 24s - loss: 0.2250 - classifier_output_aux_loss: 0.1384 - classifier_output_main_loss: 0.0866 - classifier_output_aux_acc: 0.9559 - classifier_output_main_acc: 0.9710 - val_loss: 0.3081 - val_classifier_output_aux_loss: 0.2276 - val_classifier_output_main_loss: 0.0805 - val_classifier_output_aux_acc: 0.9319 - val_classifier_output_main_acc: 0.9750
Epoch 30/1000
 - 23s - loss: 0.2031 - classifier_output_aux_loss: 0.1163 - classifier_output_main_loss: 0.0868 - classifier_output_aux_acc: 0.9634 - classifier_output_main_acc: 0.9752 - val_loss: 0.4395 - val_classifier_output_aux_loss: 0.3317 - val_classifier_output_main_loss: 0.1078 - val_classifier_output_aux_acc: 0.9181 - val_classifier_output_main_acc: 0.9722
Epoch 31/1000
 - 24s - loss: 0.1879 - classifier_output_aux_loss: 0.1084 - classifier_output_main_loss: 0.0796 - classifier_output_aux_acc: 0.9670 - classifier_output_main_acc: 0.9772 - val_loss: 0.2701 - val_classifier_output_aux_loss: 0.1785 - val_classifier_output_main_loss: 0.0916 - val_classifier_output_aux_acc: 0.9556 - val_classifier_output_main_acc: 0.9722
Epoch 32/1000
 - 23s - loss: 0.1989 - classifier_output_aux_loss: 0.1244 - classifier_output_main_loss: 0.0746 - classifier_output_aux_acc: 0.9611 - classifier_output_main_acc: 0.9767 - val_loss: 0.3024 - val_classifier_output_aux_loss: 0.1377 - val_classifier_output_main_loss: 0.1647 - val_classifier_output_aux_acc: 0.9528 - val_classifier_output_main_acc: 0.9611
Epoch 33/1000
 - 24s - loss: 0.1756 - classifier_output_aux_loss: 0.1012 - classifier_output_main_loss: 0.0743 - classifier_output_aux_acc: 0.9665 - classifier_output_main_acc: 0.9767 - val_loss: 0.2821 - val_classifier_output_aux_loss: 0.1991 - val_classifier_output_main_loss: 0.0830 - val_classifier_output_aux_acc: 0.9472 - val_classifier_output_main_acc: 0.9778
Epoch 34/1000
 - 24s - loss: 0.1849 - classifier_output_aux_loss: 0.1112 - classifier_output_main_loss: 0.0737 - classifier_output_aux_acc: 0.9674 - classifier_output_main_acc: 0.9799 - val_loss: 0.2954 - val_classifier_output_aux_loss: 0.1699 - val_classifier_output_main_loss: 0.1255 - val_classifier_output_aux_acc: 0.9486 - val_classifier_output_main_acc: 0.9681
Epoch 35/1000
 - 24s - loss: 0.1729 - classifier_output_aux_loss: 0.0985 - classifier_output_main_loss: 0.0743 - classifier_output_aux_acc: 0.9694 - classifier_output_main_acc: 0.9776 - val_loss: 0.3190 - val_classifier_output_aux_loss: 0.1834 - val_classifier_output_main_loss: 0.1356 - val_classifier_output_aux_acc: 0.9514 - val_classifier_output_main_acc: 0.9667
Epoch 36/1000
 - 24s - loss: 0.1552 - classifier_output_aux_loss: 0.0937 - classifier_output_main_loss: 0.0614 - classifier_output_aux_acc: 0.9710 - classifier_output_main_acc: 0.9796 - val_loss: 0.2451 - val_classifier_output_aux_loss: 0.1500 - val_classifier_output_main_loss: 0.0951 - val_classifier_output_aux_acc: 0.9528 - val_classifier_output_main_acc: 0.9722
Epoch 37/1000
 - 23s - loss: 0.1700 - classifier_output_aux_loss: 0.1043 - classifier_output_main_loss: 0.0657 - classifier_output_aux_acc: 0.9677 - classifier_output_main_acc: 0.9776 - val_loss: 0.2288 - val_classifier_output_aux_loss: 0.1568 - val_classifier_output_main_loss: 0.0720 - val_classifier_output_aux_acc: 0.9597 - val_classifier_output_main_acc: 0.9778
Epoch 38/1000
 - 23s - loss: 0.1691 - classifier_output_aux_loss: 0.0958 - classifier_output_main_loss: 0.0733 - classifier_output_aux_acc: 0.9728 - classifier_output_main_acc: 0.9789 - val_loss: 0.3502 - val_classifier_output_aux_loss: 0.2287 - val_classifier_output_main_loss: 0.1215 - val_classifier_output_aux_acc: 0.9458 - val_classifier_output_main_acc: 0.9736
Epoch 39/1000
 - 23s - loss: 0.1500 - classifier_output_aux_loss: 0.0774 - classifier_output_main_loss: 0.0726 - classifier_output_aux_acc: 0.9747 - classifier_output_main_acc: 0.9806 - val_loss: 0.4000 - val_classifier_output_aux_loss: 0.1958 - val_classifier_output_main_loss: 0.2042 - val_classifier_output_aux_acc: 0.9472 - val_classifier_output_main_acc: 0.9528
Epoch 40/1000
 - 23s - loss: 0.1555 - classifier_output_aux_loss: 0.1015 - classifier_output_main_loss: 0.0540 - classifier_output_aux_acc: 0.9716 - classifier_output_main_acc: 0.9829 - val_loss: 0.2717 - val_classifier_output_aux_loss: 0.1748 - val_classifier_output_main_loss: 0.0969 - val_classifier_output_aux_acc: 0.9542 - val_classifier_output_main_acc: 0.9750
Epoch 41/1000
 - 24s - loss: 0.1542 - classifier_output_aux_loss: 0.0942 - classifier_output_main_loss: 0.0600 - classifier_output_aux_acc: 0.9707 - classifier_output_main_acc: 0.9819 - val_loss: 0.1975 - val_classifier_output_aux_loss: 0.1240 - val_classifier_output_main_loss: 0.0736 - val_classifier_output_aux_acc: 0.9583 - val_classifier_output_main_acc: 0.9806
Epoch 42/1000
 - 24s - loss: 0.1394 - classifier_output_aux_loss: 0.0827 - classifier_output_main_loss: 0.0567 - classifier_output_aux_acc: 0.9736 - classifier_output_main_acc: 0.9832 - val_loss: 0.2759 - val_classifier_output_aux_loss: 0.1716 - val_classifier_output_main_loss: 0.1043 - val_classifier_output_aux_acc: 0.9611 - val_classifier_output_main_acc: 0.9764
Epoch 43/1000
 - 23s - loss: 0.1576 - classifier_output_aux_loss: 0.0839 - classifier_output_main_loss: 0.0737 - classifier_output_aux_acc: 0.9770 - classifier_output_main_acc: 0.9801 - val_loss: 0.1890 - val_classifier_output_aux_loss: 0.1384 - val_classifier_output_main_loss: 0.0506 - val_classifier_output_aux_acc: 0.9611 - val_classifier_output_main_acc: 0.9875
Epoch 44/1000
 - 24s - loss: 0.1300 - classifier_output_aux_loss: 0.0784 - classifier_output_main_loss: 0.0516 - classifier_output_aux_acc: 0.9762 - classifier_output_main_acc: 0.9843 - val_loss: 0.2159 - val_classifier_output_aux_loss: 0.1252 - val_classifier_output_main_loss: 0.0907 - val_classifier_output_aux_acc: 0.9653 - val_classifier_output_main_acc: 0.9792
Epoch 45/1000
 - 23s - loss: 0.1356 - classifier_output_aux_loss: 0.0756 - classifier_output_main_loss: 0.0600 - classifier_output_aux_acc: 0.9785 - classifier_output_main_acc: 0.9847 - val_loss: 0.3324 - val_classifier_output_aux_loss: 0.2315 - val_classifier_output_main_loss: 0.1009 - val_classifier_output_aux_acc: 0.9444 - val_classifier_output_main_acc: 0.9708
Epoch 46/1000
 - 23s - loss: 0.1357 - classifier_output_aux_loss: 0.0754 - classifier_output_main_loss: 0.0603 - classifier_output_aux_acc: 0.9773 - classifier_output_main_acc: 0.9826 - val_loss: 0.2814 - val_classifier_output_aux_loss: 0.2204 - val_classifier_output_main_loss: 0.0611 - val_classifier_output_aux_acc: 0.9458 - val_classifier_output_main_acc: 0.9819
Epoch 47/1000
 - 23s - loss: 0.1139 - classifier_output_aux_loss: 0.0667 - classifier_output_main_loss: 0.0471 - classifier_output_aux_acc: 0.9802 - classifier_output_main_acc: 0.9850 - val_loss: 0.3642 - val_classifier_output_aux_loss: 0.1563 - val_classifier_output_main_loss: 0.2079 - val_classifier_output_aux_acc: 0.9667 - val_classifier_output_main_acc: 0.9583
Epoch 48/1000
 - 23s - loss: 0.1363 - classifier_output_aux_loss: 0.0768 - classifier_output_main_loss: 0.0595 - classifier_output_aux_acc: 0.9792 - classifier_output_main_acc: 0.9847 - val_loss: 0.1637 - val_classifier_output_aux_loss: 0.1084 - val_classifier_output_main_loss: 0.0553 - val_classifier_output_aux_acc: 0.9694 - val_classifier_output_main_acc: 0.9833
Epoch 49/1000
 - 23s - loss: 0.1144 - classifier_output_aux_loss: 0.0656 - classifier_output_main_loss: 0.0488 - classifier_output_aux_acc: 0.9793 - classifier_output_main_acc: 0.9866 - val_loss: 0.2883 - val_classifier_output_aux_loss: 0.2180 - val_classifier_output_main_loss: 0.0703 - val_classifier_output_aux_acc: 0.9556 - val_classifier_output_main_acc: 0.9875
Epoch 50/1000
 - 23s - loss: 0.1223 - classifier_output_aux_loss: 0.0690 - classifier_output_main_loss: 0.0533 - classifier_output_aux_acc: 0.9809 - classifier_output_main_acc: 0.9858 - val_loss: 0.2366 - val_classifier_output_aux_loss: 0.1573 - val_classifier_output_main_loss: 0.0793 - val_classifier_output_aux_acc: 0.9653 - val_classifier_output_main_acc: 0.9847
Epoch 51/1000
 - 23s - loss: 0.1147 - classifier_output_aux_loss: 0.0689 - classifier_output_main_loss: 0.0457 - classifier_output_aux_acc: 0.9813 - classifier_output_main_acc: 0.9875 - val_loss: 0.2094 - val_classifier_output_aux_loss: 0.1095 - val_classifier_output_main_loss: 0.0999 - val_classifier_output_aux_acc: 0.9722 - val_classifier_output_main_acc: 0.9764
Epoch 52/1000
 - 24s - loss: 0.1268 - classifier_output_aux_loss: 0.0686 - classifier_output_main_loss: 0.0582 - classifier_output_aux_acc: 0.9804 - classifier_output_main_acc: 0.9841 - val_loss: 0.1697 - val_classifier_output_aux_loss: 0.1042 - val_classifier_output_main_loss: 0.0655 - val_classifier_output_aux_acc: 0.9722 - val_classifier_output_main_acc: 0.9764
Epoch 53/1000
 - 24s - loss: 0.1140 - classifier_output_aux_loss: 0.0622 - classifier_output_main_loss: 0.0518 - classifier_output_aux_acc: 0.9815 - classifier_output_main_acc: 0.9855 - val_loss: 0.2119 - val_classifier_output_aux_loss: 0.1074 - val_classifier_output_main_loss: 0.1045 - val_classifier_output_aux_acc: 0.9708 - val_classifier_output_main_acc: 0.9792
Epoch 54/1000
 - 23s - loss: 0.1110 - classifier_output_aux_loss: 0.0609 - classifier_output_main_loss: 0.0501 - classifier_output_aux_acc: 0.9833 - classifier_output_main_acc: 0.9875 - val_loss: 0.2010 - val_classifier_output_aux_loss: 0.0943 - val_classifier_output_main_loss: 0.1067 - val_classifier_output_aux_acc: 0.9722 - val_classifier_output_main_acc: 0.9764
Epoch 55/1000
 - 20s - loss: 0.1175 - classifier_output_aux_loss: 0.0661 - classifier_output_main_loss: 0.0514 - classifier_output_aux_acc: 0.9806 - classifier_output_main_acc: 0.9861 - val_loss: 0.2573 - val_classifier_output_aux_loss: 0.1845 - val_classifier_output_main_loss: 0.0728 - val_classifier_output_aux_acc: 0.9639 - val_classifier_output_main_acc: 0.9806
Epoch 56/1000
 - 20s - loss: 0.1071 - classifier_output_aux_loss: 0.0617 - classifier_output_main_loss: 0.0454 - classifier_output_aux_acc: 0.9823 - classifier_output_main_acc: 0.9877 - val_loss: 0.2094 - val_classifier_output_aux_loss: 0.1228 - val_classifier_output_main_loss: 0.0866 - val_classifier_output_aux_acc: 0.9833 - val_classifier_output_main_acc: 0.9736
Epoch 57/1000
 - 20s - loss: 0.0945 - classifier_output_aux_loss: 0.0564 - classifier_output_main_loss: 0.0381 - classifier_output_aux_acc: 0.9840 - classifier_output_main_acc: 0.9887 - val_loss: 0.1672 - val_classifier_output_aux_loss: 0.1224 - val_classifier_output_main_loss: 0.0448 - val_classifier_output_aux_acc: 0.9778 - val_classifier_output_main_acc: 0.9861
Epoch 58/1000
 - 20s - loss: 0.1106 - classifier_output_aux_loss: 0.0680 - classifier_output_main_loss: 0.0426 - classifier_output_aux_acc: 0.9804 - classifier_output_main_acc: 0.9889 - val_loss: 0.2599 - val_classifier_output_aux_loss: 0.1439 - val_classifier_output_main_loss: 0.1160 - val_classifier_output_aux_acc: 0.9708 - val_classifier_output_main_acc: 0.9736
cm_aux: [[175  18   5   0  75  27]
 [ 46 148   3   6  71  26]
 [ 29  47 137  13  23  51]
 [ 10   0  15 187  44  44]
 [  8  13  17  11 219  32]
 [  5  12   1  50  35 197]]
cm_main: [[263   9   2   0  16  10]
 [ 39 188   0  18  25  30]
 [ 15   6 259  19   0   1]
 [ 13  11  41 225   7   3]
 [  8  39   1   2 218  32]
 [ 39  23   5   2  21 210]]
normalized cm_main: [[0.87666667 0.03       0.00666667 0.         0.05333333 0.03333333]
 [0.13       0.62666667 0.         0.06       0.08333333 0.1       ]
 [0.05       0.02       0.86333333 0.06333333 0.         0.00333333]
 [0.04333333 0.03666667 0.13666667 0.75       0.02333333 0.01      ]
 [0.02666667 0.13       0.00333333 0.00666667 0.72666667 0.10666667]
 [0.13       0.07666667 0.01666667 0.00666667 0.07       0.7       ]]
metrics: ['loss', 'classifier_output_aux_loss', 'classifier_output_main_loss', 'classifier_output_aux_acc', 'classifier_output_main_acc']
Test score: [5.206575078964233, 3.517558912701077, 1.6890161743263403, 0.5905555555555555, 0.7572222222222222]
Test loss: 3.517558912701077
Test accuracy of aux: 0.5905555555555555
Test accuracy of main: 0.7572222222222222
Saving model to disk 

__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
main_input_1 (InputLayer)       (None, 29, 6, 20, 3) 0                                            
__________________________________________________________________________________________________
main_input_2 (InputLayer)       (None, 29, 6, 20, 3) 0                                            
__________________________________________________________________________________________________
feature_output_aux (TimeDistrib (None, 29, 64)       78400       main_input_1[0][0]               
__________________________________________________________________________________________________
feature_output_main (TimeDistri (None, 29, 64)       78400       main_input_2[0][0]               
__________________________________________________________________________________________________
gru_3 (GRU)                     (None, 128)          74112       feature_output_aux[0][0]         
__________________________________________________________________________________________________
gru_4 (GRU)                     (None, 128)          74112       feature_output_main[0][0]        
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 128)          0           gru_3[0][0]                      
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 128)          0           gru_4[0][0]                      
__________________________________________________________________________________________________
gradient_reversal_3 (GradientRe (None, 128)          0           dropout_10[0][0]                 
__________________________________________________________________________________________________
gradient_reversal_4 (GradientRe (None, 128)          0           dropout_8[0][0]                  
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 256)          0           dropout_8[0][0]                  
                                                                 gradient_reversal_3[0][0]        
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 256)          0           dropout_10[0][0]                 
                                                                 gradient_reversal_4[0][0]        
__________________________________________________________________________________________________
dense_11 (Dense)                (None, 128)          32896       concatenate_3[0][0]              
__________________________________________________________________________________________________
dense_12 (Dense)                (None, 128)          32896       concatenate_4[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 128)          0           dense_11[0][0]                   
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 128)          0           dense_12[0][0]                   
__________________________________________________________________________________________________
classifier_output_aux (Dense)   (None, 6)            774         dropout_11[0][0]                 
__________________________________________________________________________________________________
classifier_output_main (Dense)  (None, 6)            774         dropout_12[0][0]                 
==================================================================================================
Total params: 372,364
Trainable params: 372,364
Non-trainable params: 0
__________________________________________________________________________________________________
None
Loading Data...
domain_type: 3
Loaded Data wf_tally_slice 2 (7200, 29, 6, 20, 3) 4 (7200, 6) 2 (1800, 29, 6, 20, 3)
n_timesteps: 29
Train on 6480 samples, validate on 720 samples
Epoch 1/1000
 - 27s - loss: 3.2324 - classifier_output_aux_loss: 1.5771 - classifier_output_main_loss: 1.6554 - classifier_output_aux_acc: 0.3355 - classifier_output_main_acc: 0.2914 - val_loss: 2.8047 - val_classifier_output_aux_loss: 1.3976 - val_classifier_output_main_loss: 1.4071 - val_classifier_output_aux_acc: 0.4667 - val_classifier_output_main_acc: 0.4431
Epoch 2/1000
 - 24s - loss: 2.6712 - classifier_output_aux_loss: 1.3466 - classifier_output_main_loss: 1.3247 - classifier_output_aux_acc: 0.4662 - classifier_output_main_acc: 0.4895 - val_loss: 2.3179 - val_classifier_output_aux_loss: 1.1954 - val_classifier_output_main_loss: 1.1225 - val_classifier_output_aux_acc: 0.5375 - val_classifier_output_main_acc: 0.5833
Epoch 3/1000
 - 25s - loss: 2.3227 - classifier_output_aux_loss: 1.1983 - classifier_output_main_loss: 1.1244 - classifier_output_aux_acc: 0.5458 - classifier_output_main_acc: 0.5747 - val_loss: 2.0049 - val_classifier_output_aux_loss: 1.0171 - val_classifier_output_main_loss: 0.9878 - val_classifier_output_aux_acc: 0.6125 - val_classifier_output_main_acc: 0.6417
Epoch 4/1000
 - 26s - loss: 2.0115 - classifier_output_aux_loss: 1.0183 - classifier_output_main_loss: 0.9932 - classifier_output_aux_acc: 0.6137 - classifier_output_main_acc: 0.6252 - val_loss: 1.9573 - val_classifier_output_aux_loss: 0.8730 - val_classifier_output_main_loss: 1.0843 - val_classifier_output_aux_acc: 0.6667 - val_classifier_output_main_acc: 0.5736
Epoch 5/1000
 - 26s - loss: 1.7480 - classifier_output_aux_loss: 0.8845 - classifier_output_main_loss: 0.8635 - classifier_output_aux_acc: 0.6698 - classifier_output_main_acc: 0.6856 - val_loss: 1.4774 - val_classifier_output_aux_loss: 0.7961 - val_classifier_output_main_loss: 0.6814 - val_classifier_output_aux_acc: 0.6889 - val_classifier_output_main_acc: 0.7444
Epoch 6/1000
 - 25s - loss: 1.4928 - classifier_output_aux_loss: 0.7673 - classifier_output_main_loss: 0.7255 - classifier_output_aux_acc: 0.7182 - classifier_output_main_acc: 0.7398 - val_loss: 1.2269 - val_classifier_output_aux_loss: 0.5825 - val_classifier_output_main_loss: 0.6443 - val_classifier_output_aux_acc: 0.7708 - val_classifier_output_main_acc: 0.7653
Epoch 7/1000
 - 25s - loss: 1.2727 - classifier_output_aux_loss: 0.6530 - classifier_output_main_loss: 0.6197 - classifier_output_aux_acc: 0.7563 - classifier_output_main_acc: 0.7787 - val_loss: 1.3460 - val_classifier_output_aux_loss: 0.5893 - val_classifier_output_main_loss: 0.7567 - val_classifier_output_aux_acc: 0.7639 - val_classifier_output_main_acc: 0.7528
Epoch 8/1000
 - 25s - loss: 1.1416 - classifier_output_aux_loss: 0.5931 - classifier_output_main_loss: 0.5485 - classifier_output_aux_acc: 0.7838 - classifier_output_main_acc: 0.8057 - val_loss: 0.8620 - val_classifier_output_aux_loss: 0.4414 - val_classifier_output_main_loss: 0.4206 - val_classifier_output_aux_acc: 0.8375 - val_classifier_output_main_acc: 0.8417
Epoch 9/1000
 - 25s - loss: 0.9977 - classifier_output_aux_loss: 0.5200 - classifier_output_main_loss: 0.4777 - classifier_output_aux_acc: 0.8125 - classifier_output_main_acc: 0.8397 - val_loss: 0.9454 - val_classifier_output_aux_loss: 0.4984 - val_classifier_output_main_loss: 0.4471 - val_classifier_output_aux_acc: 0.8222 - val_classifier_output_main_acc: 0.8542
Epoch 10/1000
 - 25s - loss: 0.8778 - classifier_output_aux_loss: 0.4703 - classifier_output_main_loss: 0.4075 - classifier_output_aux_acc: 0.8295 - classifier_output_main_acc: 0.8591 - val_loss: 0.6784 - val_classifier_output_aux_loss: 0.3494 - val_classifier_output_main_loss: 0.3290 - val_classifier_output_aux_acc: 0.8639 - val_classifier_output_main_acc: 0.8792
Epoch 11/1000
 - 25s - loss: 0.7960 - classifier_output_aux_loss: 0.4398 - classifier_output_main_loss: 0.3562 - classifier_output_aux_acc: 0.8455 - classifier_output_main_acc: 0.8823 - val_loss: 0.7688 - val_classifier_output_aux_loss: 0.3715 - val_classifier_output_main_loss: 0.3973 - val_classifier_output_aux_acc: 0.8653 - val_classifier_output_main_acc: 0.8681
Epoch 12/1000
 - 25s - loss: 0.7163 - classifier_output_aux_loss: 0.3953 - classifier_output_main_loss: 0.3210 - classifier_output_aux_acc: 0.8596 - classifier_output_main_acc: 0.8921 - val_loss: 0.5838 - val_classifier_output_aux_loss: 0.3041 - val_classifier_output_main_loss: 0.2797 - val_classifier_output_aux_acc: 0.8903 - val_classifier_output_main_acc: 0.9125
Epoch 13/1000
 - 25s - loss: 0.6430 - classifier_output_aux_loss: 0.3582 - classifier_output_main_loss: 0.2848 - classifier_output_aux_acc: 0.8664 - classifier_output_main_acc: 0.9037 - val_loss: 0.7865 - val_classifier_output_aux_loss: 0.3199 - val_classifier_output_main_loss: 0.4666 - val_classifier_output_aux_acc: 0.8833 - val_classifier_output_main_acc: 0.8528
Epoch 14/1000
 - 25s - loss: 0.5979 - classifier_output_aux_loss: 0.3385 - classifier_output_main_loss: 0.2594 - classifier_output_aux_acc: 0.8826 - classifier_output_main_acc: 0.9080 - val_loss: 0.5806 - val_classifier_output_aux_loss: 0.3058 - val_classifier_output_main_loss: 0.2747 - val_classifier_output_aux_acc: 0.8917 - val_classifier_output_main_acc: 0.9056
Epoch 15/1000
 - 26s - loss: 0.5414 - classifier_output_aux_loss: 0.3061 - classifier_output_main_loss: 0.2353 - classifier_output_aux_acc: 0.8904 - classifier_output_main_acc: 0.9242 - val_loss: 0.4592 - val_classifier_output_aux_loss: 0.2666 - val_classifier_output_main_loss: 0.1926 - val_classifier_output_aux_acc: 0.9028 - val_classifier_output_main_acc: 0.9333
Epoch 16/1000
 - 25s - loss: 0.4976 - classifier_output_aux_loss: 0.2848 - classifier_output_main_loss: 0.2128 - classifier_output_aux_acc: 0.8974 - classifier_output_main_acc: 0.9276 - val_loss: 0.4325 - val_classifier_output_aux_loss: 0.2836 - val_classifier_output_main_loss: 0.1489 - val_classifier_output_aux_acc: 0.9083 - val_classifier_output_main_acc: 0.9500
Epoch 17/1000
 - 25s - loss: 0.4563 - classifier_output_aux_loss: 0.2588 - classifier_output_main_loss: 0.1975 - classifier_output_aux_acc: 0.9137 - classifier_output_main_acc: 0.9352 - val_loss: 0.4743 - val_classifier_output_aux_loss: 0.2637 - val_classifier_output_main_loss: 0.2106 - val_classifier_output_aux_acc: 0.9125 - val_classifier_output_main_acc: 0.9403
Epoch 18/1000
 - 25s - loss: 0.4205 - classifier_output_aux_loss: 0.2496 - classifier_output_main_loss: 0.1709 - classifier_output_aux_acc: 0.9165 - classifier_output_main_acc: 0.9451 - val_loss: 0.5573 - val_classifier_output_aux_loss: 0.2512 - val_classifier_output_main_loss: 0.3061 - val_classifier_output_aux_acc: 0.9097 - val_classifier_output_main_acc: 0.8972
Epoch 19/1000
 - 25s - loss: 0.3956 - classifier_output_aux_loss: 0.2309 - classifier_output_main_loss: 0.1647 - classifier_output_aux_acc: 0.9199 - classifier_output_main_acc: 0.9498 - val_loss: 0.3196 - val_classifier_output_aux_loss: 0.2046 - val_classifier_output_main_loss: 0.1150 - val_classifier_output_aux_acc: 0.9389 - val_classifier_output_main_acc: 0.9639
Epoch 20/1000
 - 25s - loss: 0.3685 - classifier_output_aux_loss: 0.2204 - classifier_output_main_loss: 0.1481 - classifier_output_aux_acc: 0.9236 - classifier_output_main_acc: 0.9519 - val_loss: 0.4943 - val_classifier_output_aux_loss: 0.2696 - val_classifier_output_main_loss: 0.2247 - val_classifier_output_aux_acc: 0.9194 - val_classifier_output_main_acc: 0.9319
Epoch 21/1000
 - 25s - loss: 0.3260 - classifier_output_aux_loss: 0.1951 - classifier_output_main_loss: 0.1309 - classifier_output_aux_acc: 0.9319 - classifier_output_main_acc: 0.9552 - val_loss: 0.3412 - val_classifier_output_aux_loss: 0.2604 - val_classifier_output_main_loss: 0.0808 - val_classifier_output_aux_acc: 0.9181 - val_classifier_output_main_acc: 0.9750
Epoch 22/1000
 - 25s - loss: 0.3337 - classifier_output_aux_loss: 0.1956 - classifier_output_main_loss: 0.1382 - classifier_output_aux_acc: 0.9352 - classifier_output_main_acc: 0.9566 - val_loss: 0.3049 - val_classifier_output_aux_loss: 0.2088 - val_classifier_output_main_loss: 0.0962 - val_classifier_output_aux_acc: 0.9333 - val_classifier_output_main_acc: 0.9736
Epoch 23/1000
 - 25s - loss: 0.3013 - classifier_output_aux_loss: 0.1760 - classifier_output_main_loss: 0.1253 - classifier_output_aux_acc: 0.9400 - classifier_output_main_acc: 0.9606 - val_loss: 0.2500 - val_classifier_output_aux_loss: 0.1622 - val_classifier_output_main_loss: 0.0878 - val_classifier_output_aux_acc: 0.9403 - val_classifier_output_main_acc: 0.9764
Epoch 24/1000
 - 25s - loss: 0.2763 - classifier_output_aux_loss: 0.1613 - classifier_output_main_loss: 0.1150 - classifier_output_aux_acc: 0.9465 - classifier_output_main_acc: 0.9644 - val_loss: 0.2969 - val_classifier_output_aux_loss: 0.1915 - val_classifier_output_main_loss: 0.1054 - val_classifier_output_aux_acc: 0.9389 - val_classifier_output_main_acc: 0.9736
Epoch 25/1000
 - 25s - loss: 0.2719 - classifier_output_aux_loss: 0.1621 - classifier_output_main_loss: 0.1098 - classifier_output_aux_acc: 0.9457 - classifier_output_main_acc: 0.9644 - val_loss: 0.3540 - val_classifier_output_aux_loss: 0.2366 - val_classifier_output_main_loss: 0.1174 - val_classifier_output_aux_acc: 0.9333 - val_classifier_output_main_acc: 0.9667
Epoch 26/1000
 - 25s - loss: 0.2818 - classifier_output_aux_loss: 0.1665 - classifier_output_main_loss: 0.1153 - classifier_output_aux_acc: 0.9471 - classifier_output_main_acc: 0.9648 - val_loss: 0.2648 - val_classifier_output_aux_loss: 0.1915 - val_classifier_output_main_loss: 0.0733 - val_classifier_output_aux_acc: 0.9500 - val_classifier_output_main_acc: 0.9736
Epoch 27/1000
 - 25s - loss: 0.2405 - classifier_output_aux_loss: 0.1409 - classifier_output_main_loss: 0.0995 - classifier_output_aux_acc: 0.9509 - classifier_output_main_acc: 0.9694 - val_loss: 0.3652 - val_classifier_output_aux_loss: 0.1804 - val_classifier_output_main_loss: 0.1848 - val_classifier_output_aux_acc: 0.9514 - val_classifier_output_main_acc: 0.9528
Epoch 28/1000
 - 25s - loss: 0.2509 - classifier_output_aux_loss: 0.1449 - classifier_output_main_loss: 0.1059 - classifier_output_aux_acc: 0.9531 - classifier_output_main_acc: 0.9676 - val_loss: 0.2601 - val_classifier_output_aux_loss: 0.1846 - val_classifier_output_main_loss: 0.0755 - val_classifier_output_aux_acc: 0.9431 - val_classifier_output_main_acc: 0.9819
Epoch 29/1000
 - 25s - loss: 0.2195 - classifier_output_aux_loss: 0.1306 - classifier_output_main_loss: 0.0889 - classifier_output_aux_acc: 0.9563 - classifier_output_main_acc: 0.9704 - val_loss: 0.2575 - val_classifier_output_aux_loss: 0.1762 - val_classifier_output_main_loss: 0.0812 - val_classifier_output_aux_acc: 0.9472 - val_classifier_output_main_acc: 0.9778
Epoch 30/1000
 - 25s - loss: 0.2329 - classifier_output_aux_loss: 0.1445 - classifier_output_main_loss: 0.0883 - classifier_output_aux_acc: 0.9562 - classifier_output_main_acc: 0.9735 - val_loss: 0.2552 - val_classifier_output_aux_loss: 0.1357 - val_classifier_output_main_loss: 0.1195 - val_classifier_output_aux_acc: 0.9639 - val_classifier_output_main_acc: 0.9736
Epoch 31/1000
 - 25s - loss: 0.2006 - classifier_output_aux_loss: 0.1219 - classifier_output_main_loss: 0.0787 - classifier_output_aux_acc: 0.9616 - classifier_output_main_acc: 0.9756 - val_loss: 0.2830 - val_classifier_output_aux_loss: 0.2083 - val_classifier_output_main_loss: 0.0747 - val_classifier_output_aux_acc: 0.9486 - val_classifier_output_main_acc: 0.9833
Epoch 32/1000
 - 25s - loss: 0.2008 - classifier_output_aux_loss: 0.1226 - classifier_output_main_loss: 0.0782 - classifier_output_aux_acc: 0.9611 - classifier_output_main_acc: 0.9752 - val_loss: 0.2996 - val_classifier_output_aux_loss: 0.1740 - val_classifier_output_main_loss: 0.1255 - val_classifier_output_aux_acc: 0.9569 - val_classifier_output_main_acc: 0.9694
Epoch 33/1000
 - 25s - loss: 0.2103 - classifier_output_aux_loss: 0.1243 - classifier_output_main_loss: 0.0861 - classifier_output_aux_acc: 0.9596 - classifier_output_main_acc: 0.9755 - val_loss: 0.2797 - val_classifier_output_aux_loss: 0.1849 - val_classifier_output_main_loss: 0.0948 - val_classifier_output_aux_acc: 0.9583 - val_classifier_output_main_acc: 0.9778
cm_aux: [[165  25  11   0  90   9]
 [ 43 142  11   7  86  11]
 [ 21  32 130  14  99   4]
 [ 16  10  23 154  75  22]
 [ 24  33  19   2 217   5]
 [ 14  25   4  17  78 162]]
cm_main: [[247  14  14   2  16   7]
 [  7 206   0  43  32  12]
 [  5   3 267  23   0   2]
 [  9  15  38 228   6   4]
 [ 12  36   6   8 216  22]
 [ 29  42   8  10  19 192]]
normalized cm_main: [[0.82333333 0.04666667 0.04666667 0.00666667 0.05333333 0.02333333]
 [0.02333333 0.68666667 0.         0.14333333 0.10666667 0.04      ]
 [0.01666667 0.01       0.89       0.07666667 0.         0.00666667]
 [0.03       0.05       0.12666667 0.76       0.02       0.01333333]
 [0.04       0.12       0.02       0.02666667 0.72       0.07333333]
 [0.09666667 0.14       0.02666667 0.03333333 0.06333333 0.64      ]]
metrics: ['loss', 'classifier_output_aux_loss', 'classifier_output_main_loss', 'classifier_output_aux_acc', 'classifier_output_main_acc']
Test score: [3.863543503549364, 2.6636229520373873, 1.1999205790625678, 0.5388888888888889, 0.7533333333333333]
Test loss: 2.6636229520373873
Test accuracy of aux: 0.5388888888888889
Test accuracy of main: 0.7533333333333333
Saving model to disk 

__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
main_input_1 (InputLayer)       (None, 29, 6, 20, 3) 0                                            
__________________________________________________________________________________________________
main_input_2 (InputLayer)       (None, 29, 6, 20, 3) 0                                            
__________________________________________________________________________________________________
feature_output_aux (TimeDistrib (None, 29, 64)       78400       main_input_1[0][0]               
__________________________________________________________________________________________________
feature_output_main (TimeDistri (None, 29, 64)       78400       main_input_2[0][0]               
__________________________________________________________________________________________________
gru_5 (GRU)                     (None, 128)          74112       feature_output_aux[0][0]         
__________________________________________________________________________________________________
gru_6 (GRU)                     (None, 128)          74112       feature_output_main[0][0]        
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 128)          0           gru_5[0][0]                      
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 128)          0           gru_6[0][0]                      
__________________________________________________________________________________________________
gradient_reversal_5 (GradientRe (None, 128)          0           dropout_16[0][0]                 
__________________________________________________________________________________________________
gradient_reversal_6 (GradientRe (None, 128)          0           dropout_14[0][0]                 
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 256)          0           dropout_14[0][0]                 
                                                                 gradient_reversal_5[0][0]        
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 256)          0           dropout_16[0][0]                 
                                                                 gradient_reversal_6[0][0]        
__________________________________________________________________________________________________
dense_17 (Dense)                (None, 128)          32896       concatenate_5[0][0]              
__________________________________________________________________________________________________
dense_18 (Dense)                (None, 128)          32896       concatenate_6[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 128)          0           dense_17[0][0]                   
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 128)          0           dense_18[0][0]                   
__________________________________________________________________________________________________
classifier_output_aux (Dense)   (None, 6)            774         dropout_17[0][0]                 
__________________________________________________________________________________________________
classifier_output_main (Dense)  (None, 6)            774         dropout_18[0][0]                 
==================================================================================================
Total params: 372,364
Trainable params: 372,364
Non-trainable params: 0
__________________________________________________________________________________________________
None
