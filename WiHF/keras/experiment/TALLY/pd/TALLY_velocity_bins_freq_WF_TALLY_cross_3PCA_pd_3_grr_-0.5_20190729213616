argsï¼š Namespace(datasource='wf_tally_slice', domaintype=2, envdomain=1, gesturelist=[1, 2, 3, 4, 5, 6], gpuloadratio=0.2, gradientreversalrate=-0.5, instancelist=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10], matlabname=['velocity_bins_freq'], mode='train', nettype='WF_TALLY_cross', numberofpath=5, orientationdomain=4, pathtype='TALLY', patience=10, pcalist=[0, 1, 2], positiondomain=3, receiverlist=[0, 1, 2, 3, 4, 5], serverset='remote', sizeoffeature=64, targettype=1, timelimit=58, traintestratio=0.8, userlist=[1, 2, 3, 4, 5, 6], yaxislength=20)
ed:  [1, 2, 3, 4, 5, 6] pd:  [1, 2, 3, 5, 4] od:  [1, 2, 3, 4, 5]
Loading Data...
domain_type: 2
Loaded Data wf_tally_slice 2 (7200, 29, 6, 20, 3) 4 (7200, 6) 2 (1800, 29, 6, 20, 3)
n_timesteps: 29
Train on 6480 samples, validate on 720 samples
Epoch 1/1000
 - 49s - loss: 3.2236 - classifier_output_aux_loss: 1.5908 - classifier_output_main_loss: 1.6328 - classifier_output_aux_acc: 0.3259 - classifier_output_main_acc: 0.3045 - val_loss: 2.7611 - val_classifier_output_aux_loss: 1.3858 - val_classifier_output_main_loss: 1.3753 - val_classifier_output_aux_acc: 0.4389 - val_classifier_output_main_acc: 0.4208
Epoch 2/1000
 - 42s - loss: 2.6734 - classifier_output_aux_loss: 1.3569 - classifier_output_main_loss: 1.3164 - classifier_output_aux_acc: 0.4554 - classifier_output_main_acc: 0.4961 - val_loss: 2.5099 - val_classifier_output_aux_loss: 1.2943 - val_classifier_output_main_loss: 1.2156 - val_classifier_output_aux_acc: 0.4917 - val_classifier_output_main_acc: 0.5361
Epoch 3/1000
 - 44s - loss: 2.3368 - classifier_output_aux_loss: 1.1878 - classifier_output_main_loss: 1.1490 - classifier_output_aux_acc: 0.5403 - classifier_output_main_acc: 0.5583 - val_loss: 1.9821 - val_classifier_output_aux_loss: 1.0716 - val_classifier_output_main_loss: 0.9105 - val_classifier_output_aux_acc: 0.5625 - val_classifier_output_main_acc: 0.6611
Epoch 4/1000
 - 43s - loss: 2.0571 - classifier_output_aux_loss: 1.0312 - classifier_output_main_loss: 1.0259 - classifier_output_aux_acc: 0.6074 - classifier_output_main_acc: 0.6123 - val_loss: 2.2700 - val_classifier_output_aux_loss: 1.3944 - val_classifier_output_main_loss: 0.8756 - val_classifier_output_aux_acc: 0.4931 - val_classifier_output_main_acc: 0.6861
Epoch 5/1000
 - 44s - loss: 1.7747 - classifier_output_aux_loss: 0.8887 - classifier_output_main_loss: 0.8859 - classifier_output_aux_acc: 0.6667 - classifier_output_main_acc: 0.6673 - val_loss: 1.5812 - val_classifier_output_aux_loss: 0.8045 - val_classifier_output_main_loss: 0.7767 - val_classifier_output_aux_acc: 0.6944 - val_classifier_output_main_acc: 0.7083
Epoch 6/1000
 - 44s - loss: 1.5344 - classifier_output_aux_loss: 0.7871 - classifier_output_main_loss: 0.7473 - classifier_output_aux_acc: 0.7093 - classifier_output_main_acc: 0.7284 - val_loss: 1.4671 - val_classifier_output_aux_loss: 0.7544 - val_classifier_output_main_loss: 0.7127 - val_classifier_output_aux_acc: 0.6972 - val_classifier_output_main_acc: 0.7500
Epoch 7/1000
 - 43s - loss: 1.3291 - classifier_output_aux_loss: 0.6902 - classifier_output_main_loss: 0.6389 - classifier_output_aux_acc: 0.7497 - classifier_output_main_acc: 0.7750 - val_loss: 1.1511 - val_classifier_output_aux_loss: 0.6882 - val_classifier_output_main_loss: 0.4629 - val_classifier_output_aux_acc: 0.7514 - val_classifier_output_main_acc: 0.8319
Epoch 8/1000
 - 41s - loss: 1.1709 - classifier_output_aux_loss: 0.6249 - classifier_output_main_loss: 0.5460 - classifier_output_aux_acc: 0.7742 - classifier_output_main_acc: 0.8088 - val_loss: 1.0606 - val_classifier_output_aux_loss: 0.6394 - val_classifier_output_main_loss: 0.4211 - val_classifier_output_aux_acc: 0.7764 - val_classifier_output_main_acc: 0.8514
Epoch 9/1000
 - 41s - loss: 1.0247 - classifier_output_aux_loss: 0.5496 - classifier_output_main_loss: 0.4751 - classifier_output_aux_acc: 0.8009 - classifier_output_main_acc: 0.8360 - val_loss: 0.8763 - val_classifier_output_aux_loss: 0.4900 - val_classifier_output_main_loss: 0.3864 - val_classifier_output_aux_acc: 0.8139 - val_classifier_output_main_acc: 0.8653
Epoch 10/1000
 - 41s - loss: 0.9376 - classifier_output_aux_loss: 0.5079 - classifier_output_main_loss: 0.4296 - classifier_output_aux_acc: 0.8250 - classifier_output_main_acc: 0.8515 - val_loss: 1.0362 - val_classifier_output_aux_loss: 0.6541 - val_classifier_output_main_loss: 0.3821 - val_classifier_output_aux_acc: 0.7736 - val_classifier_output_main_acc: 0.8722
Epoch 11/1000
 - 44s - loss: 0.8412 - classifier_output_aux_loss: 0.4577 - classifier_output_main_loss: 0.3835 - classifier_output_aux_acc: 0.8353 - classifier_output_main_acc: 0.8667 - val_loss: 0.8735 - val_classifier_output_aux_loss: 0.5009 - val_classifier_output_main_loss: 0.3726 - val_classifier_output_aux_acc: 0.8125 - val_classifier_output_main_acc: 0.8778
Epoch 12/1000
 - 43s - loss: 0.7666 - classifier_output_aux_loss: 0.4243 - classifier_output_main_loss: 0.3422 - classifier_output_aux_acc: 0.8535 - classifier_output_main_acc: 0.8815 - val_loss: 0.7258 - val_classifier_output_aux_loss: 0.4085 - val_classifier_output_main_loss: 0.3173 - val_classifier_output_aux_acc: 0.8417 - val_classifier_output_main_acc: 0.9014
Epoch 13/1000
 - 43s - loss: 0.6894 - classifier_output_aux_loss: 0.3723 - classifier_output_main_loss: 0.3170 - classifier_output_aux_acc: 0.8710 - classifier_output_main_acc: 0.8921 - val_loss: 0.7442 - val_classifier_output_aux_loss: 0.4856 - val_classifier_output_main_loss: 0.2586 - val_classifier_output_aux_acc: 0.8194 - val_classifier_output_main_acc: 0.9208
Epoch 14/1000
 - 44s - loss: 0.6510 - classifier_output_aux_loss: 0.3544 - classifier_output_main_loss: 0.2966 - classifier_output_aux_acc: 0.8782 - classifier_output_main_acc: 0.8986 - val_loss: 0.6382 - val_classifier_output_aux_loss: 0.3544 - val_classifier_output_main_loss: 0.2838 - val_classifier_output_aux_acc: 0.8764 - val_classifier_output_main_acc: 0.8972
Epoch 15/1000
 - 42s - loss: 0.5822 - classifier_output_aux_loss: 0.3172 - classifier_output_main_loss: 0.2650 - classifier_output_aux_acc: 0.8881 - classifier_output_main_acc: 0.9063 - val_loss: 0.5914 - val_classifier_output_aux_loss: 0.3579 - val_classifier_output_main_loss: 0.2335 - val_classifier_output_aux_acc: 0.8847 - val_classifier_output_main_acc: 0.9139
Epoch 16/1000
 - 43s - loss: 0.5491 - classifier_output_aux_loss: 0.3007 - classifier_output_main_loss: 0.2484 - classifier_output_aux_acc: 0.8955 - classifier_output_main_acc: 0.9173 - val_loss: 0.5666 - val_classifier_output_aux_loss: 0.3325 - val_classifier_output_main_loss: 0.2342 - val_classifier_output_aux_acc: 0.8944 - val_classifier_output_main_acc: 0.9167
Epoch 17/1000
 - 42s - loss: 0.5165 - classifier_output_aux_loss: 0.3040 - classifier_output_main_loss: 0.2125 - classifier_output_aux_acc: 0.8994 - classifier_output_main_acc: 0.9281 - val_loss: 0.4084 - val_classifier_output_aux_loss: 0.2602 - val_classifier_output_main_loss: 0.1482 - val_classifier_output_aux_acc: 0.9097 - val_classifier_output_main_acc: 0.9458
Epoch 18/1000
 - 43s - loss: 0.4648 - classifier_output_aux_loss: 0.2681 - classifier_output_main_loss: 0.1967 - classifier_output_aux_acc: 0.9111 - classifier_output_main_acc: 0.9318 - val_loss: 0.5223 - val_classifier_output_aux_loss: 0.3131 - val_classifier_output_main_loss: 0.2092 - val_classifier_output_aux_acc: 0.8792 - val_classifier_output_main_acc: 0.9389
Epoch 19/1000
 - 42s - loss: 0.4290 - classifier_output_aux_loss: 0.2483 - classifier_output_main_loss: 0.1807 - classifier_output_aux_acc: 0.9154 - classifier_output_main_acc: 0.9417 - val_loss: 0.3812 - val_classifier_output_aux_loss: 0.2232 - val_classifier_output_main_loss: 0.1580 - val_classifier_output_aux_acc: 0.9236 - val_classifier_output_main_acc: 0.9472
Epoch 20/1000
 - 44s - loss: 0.4056 - classifier_output_aux_loss: 0.2280 - classifier_output_main_loss: 0.1776 - classifier_output_aux_acc: 0.9244 - classifier_output_main_acc: 0.9407 - val_loss: 0.5814 - val_classifier_output_aux_loss: 0.2515 - val_classifier_output_main_loss: 0.3300 - val_classifier_output_aux_acc: 0.9167 - val_classifier_output_main_acc: 0.9111
Epoch 21/1000
 - 41s - loss: 0.3808 - classifier_output_aux_loss: 0.2138 - classifier_output_main_loss: 0.1670 - classifier_output_aux_acc: 0.9284 - classifier_output_main_acc: 0.9455 - val_loss: 0.4833 - val_classifier_output_aux_loss: 0.3029 - val_classifier_output_main_loss: 0.1804 - val_classifier_output_aux_acc: 0.9111 - val_classifier_output_main_acc: 0.9431
Epoch 22/1000
 - 44s - loss: 0.3642 - classifier_output_aux_loss: 0.2034 - classifier_output_main_loss: 0.1607 - classifier_output_aux_acc: 0.9333 - classifier_output_main_acc: 0.9474 - val_loss: 0.4539 - val_classifier_output_aux_loss: 0.2500 - val_classifier_output_main_loss: 0.2039 - val_classifier_output_aux_acc: 0.9208 - val_classifier_output_main_acc: 0.9250
Epoch 23/1000
 - 42s - loss: 0.3537 - classifier_output_aux_loss: 0.1980 - classifier_output_main_loss: 0.1558 - classifier_output_aux_acc: 0.9341 - classifier_output_main_acc: 0.9519 - val_loss: 0.3606 - val_classifier_output_aux_loss: 0.2022 - val_classifier_output_main_loss: 0.1584 - val_classifier_output_aux_acc: 0.9264 - val_classifier_output_main_acc: 0.9514
Epoch 24/1000
 - 44s - loss: 0.3227 - classifier_output_aux_loss: 0.1820 - classifier_output_main_loss: 0.1407 - classifier_output_aux_acc: 0.9387 - classifier_output_main_acc: 0.9534 - val_loss: 0.3451 - val_classifier_output_aux_loss: 0.2194 - val_classifier_output_main_loss: 0.1257 - val_classifier_output_aux_acc: 0.9306 - val_classifier_output_main_acc: 0.9611
Epoch 25/1000
 - 43s - loss: 0.3171 - classifier_output_aux_loss: 0.1859 - classifier_output_main_loss: 0.1311 - classifier_output_aux_acc: 0.9409 - classifier_output_main_acc: 0.9593 - val_loss: 0.5681 - val_classifier_output_aux_loss: 0.2033 - val_classifier_output_main_loss: 0.3648 - val_classifier_output_aux_acc: 0.9389 - val_classifier_output_main_acc: 0.9153
Epoch 26/1000
 - 44s - loss: 0.3120 - classifier_output_aux_loss: 0.1751 - classifier_output_main_loss: 0.1369 - classifier_output_aux_acc: 0.9437 - classifier_output_main_acc: 0.9565 - val_loss: 0.3163 - val_classifier_output_aux_loss: 0.1935 - val_classifier_output_main_loss: 0.1229 - val_classifier_output_aux_acc: 0.9375 - val_classifier_output_main_acc: 0.9597
Epoch 27/1000
 - 42s - loss: 0.2606 - classifier_output_aux_loss: 0.1470 - classifier_output_main_loss: 0.1136 - classifier_output_aux_acc: 0.9532 - classifier_output_main_acc: 0.9639 - val_loss: 0.3489 - val_classifier_output_aux_loss: 0.2068 - val_classifier_output_main_loss: 0.1421 - val_classifier_output_aux_acc: 0.9347 - val_classifier_output_main_acc: 0.9569
Epoch 28/1000
 - 42s - loss: 0.2570 - classifier_output_aux_loss: 0.1425 - classifier_output_main_loss: 0.1145 - classifier_output_aux_acc: 0.9514 - classifier_output_main_acc: 0.9637 - val_loss: 0.2413 - val_classifier_output_aux_loss: 0.1384 - val_classifier_output_main_loss: 0.1028 - val_classifier_output_aux_acc: 0.9444 - val_classifier_output_main_acc: 0.9653
Epoch 29/1000
 - 43s - loss: 0.2527 - classifier_output_aux_loss: 0.1391 - classifier_output_main_loss: 0.1136 - classifier_output_aux_acc: 0.9577 - classifier_output_main_acc: 0.9644 - val_loss: 0.4754 - val_classifier_output_aux_loss: 0.3405 - val_classifier_output_main_loss: 0.1349 - val_classifier_output_aux_acc: 0.9014 - val_classifier_output_main_acc: 0.9597
Epoch 30/1000
 - 40s - loss: 0.2406 - classifier_output_aux_loss: 0.1300 - classifier_output_main_loss: 0.1106 - classifier_output_aux_acc: 0.9591 - classifier_output_main_acc: 0.9653 - val_loss: 0.4089 - val_classifier_output_aux_loss: 0.3196 - val_classifier_output_main_loss: 0.0893 - val_classifier_output_aux_acc: 0.9181 - val_classifier_output_main_acc: 0.9694
Epoch 31/1000
 - 41s - loss: 0.2414 - classifier_output_aux_loss: 0.1324 - classifier_output_main_loss: 0.1090 - classifier_output_aux_acc: 0.9591 - classifier_output_main_acc: 0.9677 - val_loss: 0.4885 - val_classifier_output_aux_loss: 0.3205 - val_classifier_output_main_loss: 0.1679 - val_classifier_output_aux_acc: 0.9014 - val_classifier_output_main_acc: 0.9569
Epoch 32/1000
 - 40s - loss: 0.2168 - classifier_output_aux_loss: 0.1219 - classifier_output_main_loss: 0.0949 - classifier_output_aux_acc: 0.9602 - classifier_output_main_acc: 0.9698 - val_loss: 0.3398 - val_classifier_output_aux_loss: 0.1806 - val_classifier_output_main_loss: 0.1593 - val_classifier_output_aux_acc: 0.9514 - val_classifier_output_main_acc: 0.9583
Epoch 33/1000
 - 43s - loss: 0.2031 - classifier_output_aux_loss: 0.1143 - classifier_output_main_loss: 0.0888 - classifier_output_aux_acc: 0.9622 - classifier_output_main_acc: 0.9710 - val_loss: 0.2225 - val_classifier_output_aux_loss: 0.1062 - val_classifier_output_main_loss: 0.1163 - val_classifier_output_aux_acc: 0.9653 - val_classifier_output_main_acc: 0.9639
Epoch 34/1000
 - 42s - loss: 0.2092 - classifier_output_aux_loss: 0.1145 - classifier_output_main_loss: 0.0947 - classifier_output_aux_acc: 0.9653 - classifier_output_main_acc: 0.9701 - val_loss: 0.2946 - val_classifier_output_aux_loss: 0.1471 - val_classifier_output_main_loss: 0.1475 - val_classifier_output_aux_acc: 0.9472 - val_classifier_output_main_acc: 0.9569
Epoch 35/1000
 - 44s - loss: 0.2012 - classifier_output_aux_loss: 0.1158 - classifier_output_main_loss: 0.0853 - classifier_output_aux_acc: 0.9642 - classifier_output_main_acc: 0.9748 - val_loss: 0.2902 - val_classifier_output_aux_loss: 0.1492 - val_classifier_output_main_loss: 0.1410 - val_classifier_output_aux_acc: 0.9528 - val_classifier_output_main_acc: 0.9639
Epoch 36/1000
 - 43s - loss: 0.2066 - classifier_output_aux_loss: 0.1185 - classifier_output_main_loss: 0.0881 - classifier_output_aux_acc: 0.9657 - classifier_output_main_acc: 0.9745 - val_loss: 0.2692 - val_classifier_output_aux_loss: 0.1414 - val_classifier_output_main_loss: 0.1278 - val_classifier_output_aux_acc: 0.9556 - val_classifier_output_main_acc: 0.9708
Epoch 37/1000
 - 44s - loss: 0.1812 - classifier_output_aux_loss: 0.1042 - classifier_output_main_loss: 0.0770 - classifier_output_aux_acc: 0.9664 - classifier_output_main_acc: 0.9750 - val_loss: 0.2972 - val_classifier_output_aux_loss: 0.1619 - val_classifier_output_main_loss: 0.1353 - val_classifier_output_aux_acc: 0.9486 - val_classifier_output_main_acc: 0.9569
Epoch 38/1000
 - 43s - loss: 0.1895 - classifier_output_aux_loss: 0.1106 - classifier_output_main_loss: 0.0789 - classifier_output_aux_acc: 0.9690 - classifier_output_main_acc: 0.9769 - val_loss: 0.3193 - val_classifier_output_aux_loss: 0.2190 - val_classifier_output_main_loss: 0.1002 - val_classifier_output_aux_acc: 0.9375 - val_classifier_output_main_acc: 0.9667
Epoch 39/1000
 - 43s - loss: 0.1761 - classifier_output_aux_loss: 0.0909 - classifier_output_main_loss: 0.0853 - classifier_output_aux_acc: 0.9715 - classifier_output_main_acc: 0.9752 - val_loss: 0.3071 - val_classifier_output_aux_loss: 0.2091 - val_classifier_output_main_loss: 0.0979 - val_classifier_output_aux_acc: 0.9458 - val_classifier_output_main_acc: 0.9736
Epoch 40/1000
 - 41s - loss: 0.1686 - classifier_output_aux_loss: 0.0929 - classifier_output_main_loss: 0.0757 - classifier_output_aux_acc: 0.9715 - classifier_output_main_acc: 0.9775 - val_loss: 0.3001 - val_classifier_output_aux_loss: 0.1918 - val_classifier_output_main_loss: 0.1083 - val_classifier_output_aux_acc: 0.9458 - val_classifier_output_main_acc: 0.9750
Epoch 41/1000
 - 44s - loss: 0.1665 - classifier_output_aux_loss: 0.0923 - classifier_output_main_loss: 0.0741 - classifier_output_aux_acc: 0.9699 - classifier_output_main_acc: 0.9770 - val_loss: 0.2614 - val_classifier_output_aux_loss: 0.1824 - val_classifier_output_main_loss: 0.0790 - val_classifier_output_aux_acc: 0.9486 - val_classifier_output_main_acc: 0.9792
Epoch 42/1000
 - 42s - loss: 0.1585 - classifier_output_aux_loss: 0.0862 - classifier_output_main_loss: 0.0723 - classifier_output_aux_acc: 0.9742 - classifier_output_main_acc: 0.9801 - val_loss: 0.2574 - val_classifier_output_aux_loss: 0.1414 - val_classifier_output_main_loss: 0.1161 - val_classifier_output_aux_acc: 0.9639 - val_classifier_output_main_acc: 0.9708
Epoch 43/1000
 - 44s - loss: 0.1745 - classifier_output_aux_loss: 0.0981 - classifier_output_main_loss: 0.0764 - classifier_output_aux_acc: 0.9716 - classifier_output_main_acc: 0.9770 - val_loss: 0.3650 - val_classifier_output_aux_loss: 0.2183 - val_classifier_output_main_loss: 0.1467 - val_classifier_output_aux_acc: 0.9431 - val_classifier_output_main_acc: 0.9597
time_consuming: 4.610000000000127 1800 0.002561111111111182
cm_aux: [[190  11   0   0  48  51]
 [ 12 160   9   0  89  30]
 [  4   5 217   5  32  37]
 [  1  10  15 190   6  78]
 [  3   5   2   0 268  22]
 [  1   4   1   0  32 262]]
cm_main: [[230  21  13   1  28   7]
 [  0 265   0   1  27   7]
 [  0   2 269  19   9   1]
 [  0  19  10 247  23   1]
 [  4  14   0   0 280   2]
 [  9  13   2   3  14 259]]
normalized cm_main: [[0.76666667 0.07       0.04333333 0.00333333 0.09333333 0.02333333]
 [0.         0.88333333 0.         0.00333333 0.09       0.02333333]
 [0.         0.00666667 0.89666667 0.06333333 0.03       0.00333333]
 [0.         0.06333333 0.03333333 0.82333333 0.07666667 0.00333333]
 [0.01333333 0.04666667 0.         0.         0.93333333 0.00666667]
 [0.03       0.04333333 0.00666667 0.01       0.04666667 0.86333333]]
metrics: ['loss', 'classifier_output_aux_loss', 'classifier_output_main_loss', 'classifier_output_aux_acc', 'classifier_output_main_acc']
Test score: [2.2898434109157986, 1.5202023952702681, 0.7696410332873893, 0.715, 0.8611111111111112]
Test loss: 1.5202023952702681
Test accuracy of aux: 0.715
Test accuracy of main: 0.8611111111111112
Saving model to disk 

__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
main_input_1 (InputLayer)       (None, 29, 6, 20, 3) 0                                            
__________________________________________________________________________________________________
main_input_2 (InputLayer)       (None, 29, 6, 20, 3) 0                                            
__________________________________________________________________________________________________
feature_output_aux (TimeDistrib (None, 29, 64)       78400       main_input_1[0][0]               
__________________________________________________________________________________________________
feature_output_main (TimeDistri (None, 29, 64)       78400       main_input_2[0][0]               
__________________________________________________________________________________________________
gru_1 (GRU)                     (None, 128)          74112       feature_output_aux[0][0]         
__________________________________________________________________________________________________
gru_2 (GRU)                     (None, 128)          74112       feature_output_main[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 128)          0           gru_1[0][0]                      
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 128)          0           gru_2[0][0]                      
__________________________________________________________________________________________________
gradient_reversal_1 (GradientRe (None, 128)          0           dropout_4[0][0]                  
__________________________________________________________________________________________________
gradient_reversal_2 (GradientRe (None, 128)          0           dropout_2[0][0]                  
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 256)          0           dropout_2[0][0]                  
                                                                 gradient_reversal_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 256)          0           dropout_4[0][0]                  
                                                                 gradient_reversal_2[0][0]        
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 128)          32896       concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_6 (Dense)                 (None, 128)          32896       concatenate_2[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 128)          0           dense_5[0][0]                    
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 128)          0           dense_6[0][0]                    
__________________________________________________________________________________________________
classifier_output_aux (Dense)   (None, 6)            774         dropout_5[0][0]                  
__________________________________________________________________________________________________
classifier_output_main (Dense)  (None, 6)            774         dropout_6[0][0]                  
==================================================================================================
Total params: 372,364
Trainable params: 372,364
Non-trainable params: 0
__________________________________________________________________________________________________
None
Loading Data...
domain_type: 2
Loaded Data wf_tally_slice 2 (7200, 29, 6, 20, 3) 4 (7200, 6) 2 (1800, 29, 6, 20, 3)
n_timesteps: 29
Train on 6480 samples, validate on 720 samples
Epoch 1/1000
 - 48s - loss: 3.2431 - classifier_output_aux_loss: 1.6131 - classifier_output_main_loss: 1.6300 - classifier_output_aux_acc: 0.3127 - classifier_output_main_acc: 0.3006 - val_loss: 2.7455 - val_classifier_output_aux_loss: 1.3523 - val_classifier_output_main_loss: 1.3932 - val_classifier_output_aux_acc: 0.4694 - val_classifier_output_main_acc: 0.4556
Epoch 2/1000
 - 43s - loss: 2.6784 - classifier_output_aux_loss: 1.3629 - classifier_output_main_loss: 1.3155 - classifier_output_aux_acc: 0.4528 - classifier_output_main_acc: 0.4781 - val_loss: 2.5621 - val_classifier_output_aux_loss: 1.2241 - val_classifier_output_main_loss: 1.3380 - val_classifier_output_aux_acc: 0.5250 - val_classifier_output_main_acc: 0.4681
Epoch 3/1000
 - 43s - loss: 2.3404 - classifier_output_aux_loss: 1.1834 - classifier_output_main_loss: 1.1570 - classifier_output_aux_acc: 0.5389 - classifier_output_main_acc: 0.5520 - val_loss: 2.1122 - val_classifier_output_aux_loss: 0.9809 - val_classifier_output_main_loss: 1.1312 - val_classifier_output_aux_acc: 0.6306 - val_classifier_output_main_acc: 0.5542
Epoch 4/1000
 - 44s - loss: 2.0572 - classifier_output_aux_loss: 1.0225 - classifier_output_main_loss: 1.0347 - classifier_output_aux_acc: 0.6082 - classifier_output_main_acc: 0.5937 - val_loss: 1.9989 - val_classifier_output_aux_loss: 0.8686 - val_classifier_output_main_loss: 1.1303 - val_classifier_output_aux_acc: 0.6639 - val_classifier_output_main_acc: 0.5319
Epoch 5/1000
 - 43s - loss: 1.8104 - classifier_output_aux_loss: 0.8754 - classifier_output_main_loss: 0.9349 - classifier_output_aux_acc: 0.6772 - classifier_output_main_acc: 0.6435 - val_loss: 1.5230 - val_classifier_output_aux_loss: 0.6936 - val_classifier_output_main_loss: 0.8294 - val_classifier_output_aux_acc: 0.7514 - val_classifier_output_main_acc: 0.6750
Epoch 6/1000
 - 41s - loss: 1.5975 - classifier_output_aux_loss: 0.7765 - classifier_output_main_loss: 0.8210 - classifier_output_aux_acc: 0.7116 - classifier_output_main_acc: 0.6912 - val_loss: 1.3272 - val_classifier_output_aux_loss: 0.5949 - val_classifier_output_main_loss: 0.7323 - val_classifier_output_aux_acc: 0.7819 - val_classifier_output_main_acc: 0.7125
Epoch 7/1000
 - 40s - loss: 1.4105 - classifier_output_aux_loss: 0.6962 - classifier_output_main_loss: 0.7143 - classifier_output_aux_acc: 0.7427 - classifier_output_main_acc: 0.7426 - val_loss: 1.4152 - val_classifier_output_aux_loss: 0.6733 - val_classifier_output_main_loss: 0.7419 - val_classifier_output_aux_acc: 0.7403 - val_classifier_output_main_acc: 0.7250
Epoch 8/1000
 - 41s - loss: 1.2303 - classifier_output_aux_loss: 0.6137 - classifier_output_main_loss: 0.6167 - classifier_output_aux_acc: 0.7716 - classifier_output_main_acc: 0.7829 - val_loss: 1.0422 - val_classifier_output_aux_loss: 0.5025 - val_classifier_output_main_loss: 0.5398 - val_classifier_output_aux_acc: 0.8236 - val_classifier_output_main_acc: 0.7958
Epoch 9/1000
 - 44s - loss: 1.1128 - classifier_output_aux_loss: 0.5558 - classifier_output_main_loss: 0.5570 - classifier_output_aux_acc: 0.8026 - classifier_output_main_acc: 0.8074 - val_loss: 1.0692 - val_classifier_output_aux_loss: 0.4978 - val_classifier_output_main_loss: 0.5713 - val_classifier_output_aux_acc: 0.8222 - val_classifier_output_main_acc: 0.8097
Epoch 10/1000
 - 44s - loss: 0.9760 - classifier_output_aux_loss: 0.4911 - classifier_output_main_loss: 0.4849 - classifier_output_aux_acc: 0.8231 - classifier_output_main_acc: 0.8350 - val_loss: 1.2148 - val_classifier_output_aux_loss: 0.4021 - val_classifier_output_main_loss: 0.8127 - val_classifier_output_aux_acc: 0.8597 - val_classifier_output_main_acc: 0.7222
Epoch 11/1000
 - 44s - loss: 0.8997 - classifier_output_aux_loss: 0.4526 - classifier_output_main_loss: 0.4470 - classifier_output_aux_acc: 0.8410 - classifier_output_main_acc: 0.8438 - val_loss: 0.6503 - val_classifier_output_aux_loss: 0.3410 - val_classifier_output_main_loss: 0.3093 - val_classifier_output_aux_acc: 0.8875 - val_classifier_output_main_acc: 0.8958
Epoch 12/1000
 - 42s - loss: 0.8058 - classifier_output_aux_loss: 0.4209 - classifier_output_main_loss: 0.3849 - classifier_output_aux_acc: 0.8537 - classifier_output_main_acc: 0.8662 - val_loss: 0.6611 - val_classifier_output_aux_loss: 0.2927 - val_classifier_output_main_loss: 0.3684 - val_classifier_output_aux_acc: 0.9028 - val_classifier_output_main_acc: 0.8653
Epoch 13/1000
 - 43s - loss: 0.7421 - classifier_output_aux_loss: 0.3898 - classifier_output_main_loss: 0.3523 - classifier_output_aux_acc: 0.8674 - classifier_output_main_acc: 0.8752 - val_loss: 0.6857 - val_classifier_output_aux_loss: 0.3034 - val_classifier_output_main_loss: 0.3823 - val_classifier_output_aux_acc: 0.8972 - val_classifier_output_main_acc: 0.8597
Epoch 14/1000
 - 43s - loss: 0.6648 - classifier_output_aux_loss: 0.3469 - classifier_output_main_loss: 0.3179 - classifier_output_aux_acc: 0.8804 - classifier_output_main_acc: 0.8968 - val_loss: 0.6749 - val_classifier_output_aux_loss: 0.2912 - val_classifier_output_main_loss: 0.3837 - val_classifier_output_aux_acc: 0.9000 - val_classifier_output_main_acc: 0.8597
Epoch 15/1000
 - 43s - loss: 0.6198 - classifier_output_aux_loss: 0.3190 - classifier_output_main_loss: 0.3008 - classifier_output_aux_acc: 0.8974 - classifier_output_main_acc: 0.8991 - val_loss: 0.5821 - val_classifier_output_aux_loss: 0.3308 - val_classifier_output_main_loss: 0.2513 - val_classifier_output_aux_acc: 0.9000 - val_classifier_output_main_acc: 0.9125
Epoch 16/1000
 - 42s - loss: 0.5692 - classifier_output_aux_loss: 0.2970 - classifier_output_main_loss: 0.2723 - classifier_output_aux_acc: 0.8991 - classifier_output_main_acc: 0.9037 - val_loss: 0.5014 - val_classifier_output_aux_loss: 0.3018 - val_classifier_output_main_loss: 0.1996 - val_classifier_output_aux_acc: 0.8972 - val_classifier_output_main_acc: 0.9319
Epoch 17/1000
 - 44s - loss: 0.5024 - classifier_output_aux_loss: 0.2551 - classifier_output_main_loss: 0.2473 - classifier_output_aux_acc: 0.9122 - classifier_output_main_acc: 0.9185 - val_loss: 0.5751 - val_classifier_output_aux_loss: 0.2049 - val_classifier_output_main_loss: 0.3702 - val_classifier_output_aux_acc: 0.9347 - val_classifier_output_main_acc: 0.8722
Epoch 18/1000
 - 43s - loss: 0.5093 - classifier_output_aux_loss: 0.2583 - classifier_output_main_loss: 0.2510 - classifier_output_aux_acc: 0.9145 - classifier_output_main_acc: 0.9184 - val_loss: 0.4879 - val_classifier_output_aux_loss: 0.3031 - val_classifier_output_main_loss: 0.1848 - val_classifier_output_aux_acc: 0.9083 - val_classifier_output_main_acc: 0.9389
Epoch 19/1000
 - 43s - loss: 0.4349 - classifier_output_aux_loss: 0.2240 - classifier_output_main_loss: 0.2109 - classifier_output_aux_acc: 0.9230 - classifier_output_main_acc: 0.9327 - val_loss: 0.5144 - val_classifier_output_aux_loss: 0.3866 - val_classifier_output_main_loss: 0.1278 - val_classifier_output_aux_acc: 0.8833 - val_classifier_output_main_acc: 0.9583
Epoch 20/1000
 - 42s - loss: 0.4314 - classifier_output_aux_loss: 0.2310 - classifier_output_main_loss: 0.2004 - classifier_output_aux_acc: 0.9238 - classifier_output_main_acc: 0.9340 - val_loss: 0.4335 - val_classifier_output_aux_loss: 0.2554 - val_classifier_output_main_loss: 0.1781 - val_classifier_output_aux_acc: 0.9208 - val_classifier_output_main_acc: 0.9486
Epoch 21/1000
 - 44s - loss: 0.4033 - classifier_output_aux_loss: 0.2238 - classifier_output_main_loss: 0.1795 - classifier_output_aux_acc: 0.9272 - classifier_output_main_acc: 0.9398 - val_loss: 0.3392 - val_classifier_output_aux_loss: 0.2125 - val_classifier_output_main_loss: 0.1267 - val_classifier_output_aux_acc: 0.9431 - val_classifier_output_main_acc: 0.9583
Epoch 22/1000
 - 43s - loss: 0.3751 - classifier_output_aux_loss: 0.2028 - classifier_output_main_loss: 0.1723 - classifier_output_aux_acc: 0.9313 - classifier_output_main_acc: 0.9449 - val_loss: 0.4136 - val_classifier_output_aux_loss: 0.2358 - val_classifier_output_main_loss: 0.1778 - val_classifier_output_aux_acc: 0.9306 - val_classifier_output_main_acc: 0.9361
Epoch 23/1000
 - 42s - loss: 0.3478 - classifier_output_aux_loss: 0.1878 - classifier_output_main_loss: 0.1599 - classifier_output_aux_acc: 0.9397 - classifier_output_main_acc: 0.9497 - val_loss: 0.2467 - val_classifier_output_aux_loss: 0.1224 - val_classifier_output_main_loss: 0.1243 - val_classifier_output_aux_acc: 0.9625 - val_classifier_output_main_acc: 0.9597
Epoch 24/1000
 - 42s - loss: 0.3256 - classifier_output_aux_loss: 0.1829 - classifier_output_main_loss: 0.1427 - classifier_output_aux_acc: 0.9403 - classifier_output_main_acc: 0.9529 - val_loss: 0.3215 - val_classifier_output_aux_loss: 0.1779 - val_classifier_output_main_loss: 0.1436 - val_classifier_output_aux_acc: 0.9431 - val_classifier_output_main_acc: 0.9569
Epoch 25/1000
 - 42s - loss: 0.3016 - classifier_output_aux_loss: 0.1597 - classifier_output_main_loss: 0.1419 - classifier_output_aux_acc: 0.9494 - classifier_output_main_acc: 0.9535 - val_loss: 0.3208 - val_classifier_output_aux_loss: 0.1911 - val_classifier_output_main_loss: 0.1297 - val_classifier_output_aux_acc: 0.9431 - val_classifier_output_main_acc: 0.9569
Epoch 26/1000
 - 44s - loss: 0.3071 - classifier_output_aux_loss: 0.1548 - classifier_output_main_loss: 0.1523 - classifier_output_aux_acc: 0.9485 - classifier_output_main_acc: 0.9543 - val_loss: 0.4544 - val_classifier_output_aux_loss: 0.2172 - val_classifier_output_main_loss: 0.2372 - val_classifier_output_aux_acc: 0.9403 - val_classifier_output_main_acc: 0.9319
Epoch 27/1000
 - 42s - loss: 0.2820 - classifier_output_aux_loss: 0.1521 - classifier_output_main_loss: 0.1299 - classifier_output_aux_acc: 0.9509 - classifier_output_main_acc: 0.9586 - val_loss: 0.3546 - val_classifier_output_aux_loss: 0.1400 - val_classifier_output_main_loss: 0.2145 - val_classifier_output_aux_acc: 0.9653 - val_classifier_output_main_acc: 0.9347
Epoch 28/1000
 - 44s - loss: 0.2624 - classifier_output_aux_loss: 0.1441 - classifier_output_main_loss: 0.1183 - classifier_output_aux_acc: 0.9552 - classifier_output_main_acc: 0.9617 - val_loss: 0.2675 - val_classifier_output_aux_loss: 0.1401 - val_classifier_output_main_loss: 0.1274 - val_classifier_output_aux_acc: 0.9681 - val_classifier_output_main_acc: 0.9611
Epoch 29/1000
 - 43s - loss: 0.2481 - classifier_output_aux_loss: 0.1390 - classifier_output_main_loss: 0.1091 - classifier_output_aux_acc: 0.9577 - classifier_output_main_acc: 0.9640 - val_loss: 0.2501 - val_classifier_output_aux_loss: 0.1250 - val_classifier_output_main_loss: 0.1252 - val_classifier_output_aux_acc: 0.9681 - val_classifier_output_main_acc: 0.9639
Epoch 30/1000
 - 43s - loss: 0.2302 - classifier_output_aux_loss: 0.1295 - classifier_output_main_loss: 0.1008 - classifier_output_aux_acc: 0.9573 - classifier_output_main_acc: 0.9694 - val_loss: 0.3164 - val_classifier_output_aux_loss: 0.1831 - val_classifier_output_main_loss: 0.1333 - val_classifier_output_aux_acc: 0.9528 - val_classifier_output_main_acc: 0.9639
Epoch 31/1000
 - 42s - loss: 0.2395 - classifier_output_aux_loss: 0.1207 - classifier_output_main_loss: 0.1188 - classifier_output_aux_acc: 0.9614 - classifier_output_main_acc: 0.9619 - val_loss: 0.2463 - val_classifier_output_aux_loss: 0.1581 - val_classifier_output_main_loss: 0.0882 - val_classifier_output_aux_acc: 0.9556 - val_classifier_output_main_acc: 0.9750
Epoch 32/1000
 - 43s - loss: 0.2386 - classifier_output_aux_loss: 0.1375 - classifier_output_main_loss: 0.1011 - classifier_output_aux_acc: 0.9554 - classifier_output_main_acc: 0.9698 - val_loss: 0.2898 - val_classifier_output_aux_loss: 0.1105 - val_classifier_output_main_loss: 0.1793 - val_classifier_output_aux_acc: 0.9653 - val_classifier_output_main_acc: 0.9625
Epoch 33/1000
 - 42s - loss: 0.2298 - classifier_output_aux_loss: 0.1118 - classifier_output_main_loss: 0.1180 - classifier_output_aux_acc: 0.9656 - classifier_output_main_acc: 0.9659 - val_loss: 0.2999 - val_classifier_output_aux_loss: 0.1722 - val_classifier_output_main_loss: 0.1277 - val_classifier_output_aux_acc: 0.9583 - val_classifier_output_main_acc: 0.9653
Epoch 34/1000
 - 45s - loss: 0.2044 - classifier_output_aux_loss: 0.1159 - classifier_output_main_loss: 0.0884 - classifier_output_aux_acc: 0.9637 - classifier_output_main_acc: 0.9698 - val_loss: 0.3776 - val_classifier_output_aux_loss: 0.2105 - val_classifier_output_main_loss: 0.1671 - val_classifier_output_aux_acc: 0.9444 - val_classifier_output_main_acc: 0.9528
Epoch 35/1000
 - 42s - loss: 0.2167 - classifier_output_aux_loss: 0.1167 - classifier_output_main_loss: 0.1000 - classifier_output_aux_acc: 0.9645 - classifier_output_main_acc: 0.9707 - val_loss: 0.4067 - val_classifier_output_aux_loss: 0.3031 - val_classifier_output_main_loss: 0.1036 - val_classifier_output_aux_acc: 0.9375 - val_classifier_output_main_acc: 0.9736
Epoch 36/1000
 - 44s - loss: 0.1945 - classifier_output_aux_loss: 0.1065 - classifier_output_main_loss: 0.0879 - classifier_output_aux_acc: 0.9673 - classifier_output_main_acc: 0.9744 - val_loss: 0.2926 - val_classifier_output_aux_loss: 0.1854 - val_classifier_output_main_loss: 0.1073 - val_classifier_output_aux_acc: 0.9611 - val_classifier_output_main_acc: 0.9639
Epoch 37/1000
 - 43s - loss: 0.1800 - classifier_output_aux_loss: 0.0928 - classifier_output_main_loss: 0.0873 - classifier_output_aux_acc: 0.9704 - classifier_output_main_acc: 0.9752 - val_loss: 0.3095 - val_classifier_output_aux_loss: 0.1686 - val_classifier_output_main_loss: 0.1409 - val_classifier_output_aux_acc: 0.9556 - val_classifier_output_main_acc: 0.9639
Epoch 38/1000
 - 42s - loss: 0.1975 - classifier_output_aux_loss: 0.1097 - classifier_output_main_loss: 0.0878 - classifier_output_aux_acc: 0.9670 - classifier_output_main_acc: 0.9753 - val_loss: 0.2559 - val_classifier_output_aux_loss: 0.1506 - val_classifier_output_main_loss: 0.1052 - val_classifier_output_aux_acc: 0.9625 - val_classifier_output_main_acc: 0.9778
Epoch 39/1000
 - 28s - loss: 0.1783 - classifier_output_aux_loss: 0.0872 - classifier_output_main_loss: 0.0911 - classifier_output_aux_acc: 0.9742 - classifier_output_main_acc: 0.9736 - val_loss: 0.5308 - val_classifier_output_aux_loss: 0.3519 - val_classifier_output_main_loss: 0.1789 - val_classifier_output_aux_acc: 0.9278 - val_classifier_output_main_acc: 0.9514
Epoch 40/1000
 - 23s - loss: 0.1784 - classifier_output_aux_loss: 0.0951 - classifier_output_main_loss: 0.0832 - classifier_output_aux_acc: 0.9725 - classifier_output_main_acc: 0.9756 - val_loss: 0.2874 - val_classifier_output_aux_loss: 0.1447 - val_classifier_output_main_loss: 0.1427 - val_classifier_output_aux_acc: 0.9681 - val_classifier_output_main_acc: 0.9611
Epoch 41/1000
 - 21s - loss: 0.1831 - classifier_output_aux_loss: 0.0988 - classifier_output_main_loss: 0.0843 - classifier_output_aux_acc: 0.9698 - classifier_output_main_acc: 0.9761 - val_loss: 0.2843 - val_classifier_output_aux_loss: 0.1876 - val_classifier_output_main_loss: 0.0967 - val_classifier_output_aux_acc: 0.9667 - val_classifier_output_main_acc: 0.9778
time_consuming: 4.579999999999927 1800 0.002544444444444404
cm_aux: [[185  41   8   2  25  39]
 [  7 215   3   0  63  12]
 [ 20  20 190  27  22  21]
 [  1   4   5 261   1  28]
 [  4  11   4   2 257  22]
 [  3  12   4   2  41 238]]
cm_main: [[254   5  15  13   6   7]
 [  1 257   5  20   6  11]
 [  0   0 288  11   0   1]
 [  1   0  18 275   3   3]
 [  7  12   4  22 247   8]
 [ 12   5   8   1   5 269]]
normalized cm_main: [[0.84666667 0.01666667 0.05       0.04333333 0.02       0.02333333]
 [0.00333333 0.85666667 0.01666667 0.06666667 0.02       0.03666667]
 [0.         0.         0.96       0.03666667 0.         0.00333333]
 [0.00333333 0.         0.06       0.91666667 0.01       0.01      ]
 [0.02333333 0.04       0.01333333 0.07333333 0.82333333 0.02666667]
 [0.04       0.01666667 0.02666667 0.00333333 0.01666667 0.89666667]]
metrics: ['loss', 'classifier_output_aux_loss', 'classifier_output_main_loss', 'classifier_output_aux_acc', 'classifier_output_main_acc']
Test score: [2.0852853683630626, 1.4838542875978682, 0.6014310751896765, 0.7477777777777778, 0.8833333333333333]
Test loss: 1.4838542875978682
Test accuracy of aux: 0.7477777777777778
Test accuracy of main: 0.8833333333333333
Saving model to disk 

__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
main_input_1 (InputLayer)       (None, 29, 6, 20, 3) 0                                            
__________________________________________________________________________________________________
main_input_2 (InputLayer)       (None, 29, 6, 20, 3) 0                                            
__________________________________________________________________________________________________
feature_output_aux (TimeDistrib (None, 29, 64)       78400       main_input_1[0][0]               
__________________________________________________________________________________________________
feature_output_main (TimeDistri (None, 29, 64)       78400       main_input_2[0][0]               
__________________________________________________________________________________________________
gru_3 (GRU)                     (None, 128)          74112       feature_output_aux[0][0]         
__________________________________________________________________________________________________
gru_4 (GRU)                     (None, 128)          74112       feature_output_main[0][0]        
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 128)          0           gru_3[0][0]                      
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 128)          0           gru_4[0][0]                      
__________________________________________________________________________________________________
gradient_reversal_3 (GradientRe (None, 128)          0           dropout_10[0][0]                 
__________________________________________________________________________________________________
gradient_reversal_4 (GradientRe (None, 128)          0           dropout_8[0][0]                  
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 256)          0           dropout_8[0][0]                  
                                                                 gradient_reversal_3[0][0]        
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 256)          0           dropout_10[0][0]                 
                                                                 gradient_reversal_4[0][0]        
__________________________________________________________________________________________________
dense_11 (Dense)                (None, 128)          32896       concatenate_3[0][0]              
__________________________________________________________________________________________________
dense_12 (Dense)                (None, 128)          32896       concatenate_4[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 128)          0           dense_11[0][0]                   
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 128)          0           dense_12[0][0]                   
__________________________________________________________________________________________________
classifier_output_aux (Dense)   (None, 6)            774         dropout_11[0][0]                 
__________________________________________________________________________________________________
classifier_output_main (Dense)  (None, 6)            774         dropout_12[0][0]                 
==================================================================================================
Total params: 372,364
Trainable params: 372,364
Non-trainable params: 0
__________________________________________________________________________________________________
None
Loading Data...
domain_type: 2
Loaded Data wf_tally_slice 2 (7200, 29, 6, 20, 3) 4 (7200, 6) 2 (1800, 29, 6, 20, 3)
n_timesteps: 29
Train on 6480 samples, validate on 720 samples
Epoch 1/1000
 - 29s - loss: 3.2735 - classifier_output_aux_loss: 1.5923 - classifier_output_main_loss: 1.6812 - classifier_output_aux_acc: 0.3282 - classifier_output_main_acc: 0.2725 - val_loss: 2.8236 - val_classifier_output_aux_loss: 1.4325 - val_classifier_output_main_loss: 1.3911 - val_classifier_output_aux_acc: 0.4194 - val_classifier_output_main_acc: 0.4500
Epoch 2/1000
 - 26s - loss: 2.6591 - classifier_output_aux_loss: 1.3809 - classifier_output_main_loss: 1.2783 - classifier_output_aux_acc: 0.4523 - classifier_output_main_acc: 0.5051 - val_loss: 2.2874 - val_classifier_output_aux_loss: 1.1529 - val_classifier_output_main_loss: 1.1345 - val_classifier_output_aux_acc: 0.5653 - val_classifier_output_main_acc: 0.5611
Epoch 3/1000
 - 26s - loss: 2.3235 - classifier_output_aux_loss: 1.2027 - classifier_output_main_loss: 1.1208 - classifier_output_aux_acc: 0.5275 - classifier_output_main_acc: 0.5681 - val_loss: 2.0501 - val_classifier_output_aux_loss: 1.0812 - val_classifier_output_main_loss: 0.9689 - val_classifier_output_aux_acc: 0.5944 - val_classifier_output_main_acc: 0.6250
Epoch 4/1000
 - 26s - loss: 2.0367 - classifier_output_aux_loss: 1.0562 - classifier_output_main_loss: 0.9805 - classifier_output_aux_acc: 0.5974 - classifier_output_main_acc: 0.6360 - val_loss: 1.7141 - val_classifier_output_aux_loss: 0.9116 - val_classifier_output_main_loss: 0.8025 - val_classifier_output_aux_acc: 0.6556 - val_classifier_output_main_acc: 0.6819
Epoch 5/1000
 - 26s - loss: 1.7687 - classifier_output_aux_loss: 0.9306 - classifier_output_main_loss: 0.8381 - classifier_output_aux_acc: 0.6545 - classifier_output_main_acc: 0.6994 - val_loss: 1.4748 - val_classifier_output_aux_loss: 0.8027 - val_classifier_output_main_loss: 0.6721 - val_classifier_output_aux_acc: 0.6972 - val_classifier_output_main_acc: 0.7431
Epoch 6/1000
 - 26s - loss: 1.4951 - classifier_output_aux_loss: 0.8178 - classifier_output_main_loss: 0.6773 - classifier_output_aux_acc: 0.7000 - classifier_output_main_acc: 0.7574 - val_loss: 1.2481 - val_classifier_output_aux_loss: 0.6427 - val_classifier_output_main_loss: 0.6054 - val_classifier_output_aux_acc: 0.7556 - val_classifier_output_main_acc: 0.8028
Epoch 7/1000
 - 26s - loss: 1.3383 - classifier_output_aux_loss: 0.7398 - classifier_output_main_loss: 0.5985 - classifier_output_aux_acc: 0.7301 - classifier_output_main_acc: 0.7901 - val_loss: 1.1634 - val_classifier_output_aux_loss: 0.6022 - val_classifier_output_main_loss: 0.5613 - val_classifier_output_aux_acc: 0.7694 - val_classifier_output_main_acc: 0.8028
Epoch 8/1000
 - 26s - loss: 1.1668 - classifier_output_aux_loss: 0.6507 - classifier_output_main_loss: 0.5162 - classifier_output_aux_acc: 0.7597 - classifier_output_main_acc: 0.8247 - val_loss: 1.0101 - val_classifier_output_aux_loss: 0.6424 - val_classifier_output_main_loss: 0.3677 - val_classifier_output_aux_acc: 0.7625 - val_classifier_output_main_acc: 0.8764
Epoch 9/1000
 - 27s - loss: 1.0356 - classifier_output_aux_loss: 0.5996 - classifier_output_main_loss: 0.4360 - classifier_output_aux_acc: 0.7844 - classifier_output_main_acc: 0.8488 - val_loss: 0.8291 - val_classifier_output_aux_loss: 0.4195 - val_classifier_output_main_loss: 0.4096 - val_classifier_output_aux_acc: 0.8417 - val_classifier_output_main_acc: 0.8486
Epoch 10/1000
 - 26s - loss: 0.9450 - classifier_output_aux_loss: 0.5440 - classifier_output_main_loss: 0.4009 - classifier_output_aux_acc: 0.8045 - classifier_output_main_acc: 0.8677 - val_loss: 1.0070 - val_classifier_output_aux_loss: 0.6546 - val_classifier_output_main_loss: 0.3523 - val_classifier_output_aux_acc: 0.7847 - val_classifier_output_main_acc: 0.8806
Epoch 11/1000
 - 26s - loss: 0.8443 - classifier_output_aux_loss: 0.4917 - classifier_output_main_loss: 0.3526 - classifier_output_aux_acc: 0.8216 - classifier_output_main_acc: 0.8773 - val_loss: 0.7273 - val_classifier_output_aux_loss: 0.4158 - val_classifier_output_main_loss: 0.3116 - val_classifier_output_aux_acc: 0.8542 - val_classifier_output_main_acc: 0.8875
Epoch 12/1000
 - 26s - loss: 0.7656 - classifier_output_aux_loss: 0.4533 - classifier_output_main_loss: 0.3123 - classifier_output_aux_acc: 0.8381 - classifier_output_main_acc: 0.8937 - val_loss: 0.6522 - val_classifier_output_aux_loss: 0.3344 - val_classifier_output_main_loss: 0.3178 - val_classifier_output_aux_acc: 0.8792 - val_classifier_output_main_acc: 0.8958
Epoch 13/1000
 - 26s - loss: 0.7121 - classifier_output_aux_loss: 0.4161 - classifier_output_main_loss: 0.2960 - classifier_output_aux_acc: 0.8551 - classifier_output_main_acc: 0.9002 - val_loss: 0.5498 - val_classifier_output_aux_loss: 0.2761 - val_classifier_output_main_loss: 0.2737 - val_classifier_output_aux_acc: 0.9014 - val_classifier_output_main_acc: 0.9097
Epoch 14/1000
 - 26s - loss: 0.6160 - classifier_output_aux_loss: 0.3610 - classifier_output_main_loss: 0.2551 - classifier_output_aux_acc: 0.8722 - classifier_output_main_acc: 0.9148 - val_loss: 0.7182 - val_classifier_output_aux_loss: 0.4456 - val_classifier_output_main_loss: 0.2726 - val_classifier_output_aux_acc: 0.8597 - val_classifier_output_main_acc: 0.9181
Epoch 15/1000
 - 26s - loss: 0.5806 - classifier_output_aux_loss: 0.3429 - classifier_output_main_loss: 0.2377 - classifier_output_aux_acc: 0.8844 - classifier_output_main_acc: 0.9205 - val_loss: 0.5136 - val_classifier_output_aux_loss: 0.2477 - val_classifier_output_main_loss: 0.2660 - val_classifier_output_aux_acc: 0.9153 - val_classifier_output_main_acc: 0.9236
Epoch 16/1000
 - 27s - loss: 0.5408 - classifier_output_aux_loss: 0.3142 - classifier_output_main_loss: 0.2266 - classifier_output_aux_acc: 0.8943 - classifier_output_main_acc: 0.9287 - val_loss: 0.7559 - val_classifier_output_aux_loss: 0.5132 - val_classifier_output_main_loss: 0.2427 - val_classifier_output_aux_acc: 0.8250 - val_classifier_output_main_acc: 0.9181
Epoch 17/1000
 - 26s - loss: 0.4776 - classifier_output_aux_loss: 0.2744 - classifier_output_main_loss: 0.2032 - classifier_output_aux_acc: 0.9066 - classifier_output_main_acc: 0.9335 - val_loss: 0.5059 - val_classifier_output_aux_loss: 0.2508 - val_classifier_output_main_loss: 0.2550 - val_classifier_output_aux_acc: 0.9097 - val_classifier_output_main_acc: 0.8986
Epoch 18/1000
 - 26s - loss: 0.4496 - classifier_output_aux_loss: 0.2796 - classifier_output_main_loss: 0.1700 - classifier_output_aux_acc: 0.9056 - classifier_output_main_acc: 0.9429 - val_loss: 0.5214 - val_classifier_output_aux_loss: 0.3040 - val_classifier_output_main_loss: 0.2173 - val_classifier_output_aux_acc: 0.8903 - val_classifier_output_main_acc: 0.9472
Epoch 19/1000
 - 26s - loss: 0.4341 - classifier_output_aux_loss: 0.2505 - classifier_output_main_loss: 0.1836 - classifier_output_aux_acc: 0.9162 - classifier_output_main_acc: 0.9392 - val_loss: 0.4734 - val_classifier_output_aux_loss: 0.2232 - val_classifier_output_main_loss: 0.2502 - val_classifier_output_aux_acc: 0.9181 - val_classifier_output_main_acc: 0.9333
Epoch 20/1000
 - 24s - loss: 0.3896 - classifier_output_aux_loss: 0.2246 - classifier_output_main_loss: 0.1649 - classifier_output_aux_acc: 0.9245 - classifier_output_main_acc: 0.9423 - val_loss: 0.4133 - val_classifier_output_aux_loss: 0.2574 - val_classifier_output_main_loss: 0.1560 - val_classifier_output_aux_acc: 0.9153 - val_classifier_output_main_acc: 0.9444
Epoch 21/1000
 - 21s - loss: 0.3560 - classifier_output_aux_loss: 0.2166 - classifier_output_main_loss: 0.1394 - classifier_output_aux_acc: 0.9284 - classifier_output_main_acc: 0.9545 - val_loss: 0.3280 - val_classifier_output_aux_loss: 0.1588 - val_classifier_output_main_loss: 0.1692 - val_classifier_output_aux_acc: 0.9431 - val_classifier_output_main_acc: 0.9514
Epoch 22/1000
 - 21s - loss: 0.3494 - classifier_output_aux_loss: 0.2054 - classifier_output_main_loss: 0.1440 - classifier_output_aux_acc: 0.9278 - classifier_output_main_acc: 0.9528 - val_loss: 0.3279 - val_classifier_output_aux_loss: 0.1714 - val_classifier_output_main_loss: 0.1564 - val_classifier_output_aux_acc: 0.9389 - val_classifier_output_main_acc: 0.9625
Epoch 23/1000
 - 22s - loss: 0.3310 - classifier_output_aux_loss: 0.1915 - classifier_output_main_loss: 0.1395 - classifier_output_aux_acc: 0.9383 - classifier_output_main_acc: 0.9556 - val_loss: 0.4376 - val_classifier_output_aux_loss: 0.3235 - val_classifier_output_main_loss: 0.1141 - val_classifier_output_aux_acc: 0.9042 - val_classifier_output_main_acc: 0.9583
Epoch 24/1000
 - 22s - loss: 0.2967 - classifier_output_aux_loss: 0.1797 - classifier_output_main_loss: 0.1170 - classifier_output_aux_acc: 0.9390 - classifier_output_main_acc: 0.9631 - val_loss: 0.4645 - val_classifier_output_aux_loss: 0.3451 - val_classifier_output_main_loss: 0.1193 - val_classifier_output_aux_acc: 0.9028 - val_classifier_output_main_acc: 0.9611
Epoch 25/1000
 - 26s - loss: 0.2975 - classifier_output_aux_loss: 0.1857 - classifier_output_main_loss: 0.1118 - classifier_output_aux_acc: 0.9427 - classifier_output_main_acc: 0.9651 - val_loss: 0.3855 - val_classifier_output_aux_loss: 0.2742 - val_classifier_output_main_loss: 0.1113 - val_classifier_output_aux_acc: 0.9194 - val_classifier_output_main_acc: 0.9681
Epoch 26/1000
 - 26s - loss: 0.2783 - classifier_output_aux_loss: 0.1630 - classifier_output_main_loss: 0.1154 - classifier_output_aux_acc: 0.9455 - classifier_output_main_acc: 0.9644 - val_loss: 0.2868 - val_classifier_output_aux_loss: 0.1689 - val_classifier_output_main_loss: 0.1178 - val_classifier_output_aux_acc: 0.9472 - val_classifier_output_main_acc: 0.9653
Epoch 27/1000
 - 26s - loss: 0.2574 - classifier_output_aux_loss: 0.1603 - classifier_output_main_loss: 0.0971 - classifier_output_aux_acc: 0.9475 - classifier_output_main_acc: 0.9684 - val_loss: 0.2835 - val_classifier_output_aux_loss: 0.1261 - val_classifier_output_main_loss: 0.1574 - val_classifier_output_aux_acc: 0.9569 - val_classifier_output_main_acc: 0.9514
Epoch 28/1000
 - 26s - loss: 0.2487 - classifier_output_aux_loss: 0.1438 - classifier_output_main_loss: 0.1049 - classifier_output_aux_acc: 0.9523 - classifier_output_main_acc: 0.9698 - val_loss: 0.2357 - val_classifier_output_aux_loss: 0.1146 - val_classifier_output_main_loss: 0.1211 - val_classifier_output_aux_acc: 0.9542 - val_classifier_output_main_acc: 0.9639
Epoch 29/1000
 - 26s - loss: 0.2347 - classifier_output_aux_loss: 0.1425 - classifier_output_main_loss: 0.0922 - classifier_output_aux_acc: 0.9528 - classifier_output_main_acc: 0.9715 - val_loss: 0.2550 - val_classifier_output_aux_loss: 0.1271 - val_classifier_output_main_loss: 0.1279 - val_classifier_output_aux_acc: 0.9597 - val_classifier_output_main_acc: 0.9681
Epoch 30/1000
 - 26s - loss: 0.2272 - classifier_output_aux_loss: 0.1350 - classifier_output_main_loss: 0.0921 - classifier_output_aux_acc: 0.9563 - classifier_output_main_acc: 0.9725 - val_loss: 0.3169 - val_classifier_output_aux_loss: 0.1488 - val_classifier_output_main_loss: 0.1681 - val_classifier_output_aux_acc: 0.9514 - val_classifier_output_main_acc: 0.9458
Epoch 31/1000
 - 22s - loss: 0.2313 - classifier_output_aux_loss: 0.1371 - classifier_output_main_loss: 0.0942 - classifier_output_aux_acc: 0.9605 - classifier_output_main_acc: 0.9715 - val_loss: 0.2789 - val_classifier_output_aux_loss: 0.1178 - val_classifier_output_main_loss: 0.1611 - val_classifier_output_aux_acc: 0.9583 - val_classifier_output_main_acc: 0.9653
Epoch 32/1000
 - 22s - loss: 0.2224 - classifier_output_aux_loss: 0.1382 - classifier_output_main_loss: 0.0842 - classifier_output_aux_acc: 0.9560 - classifier_output_main_acc: 0.9739 - val_loss: 0.3009 - val_classifier_output_aux_loss: 0.1572 - val_classifier_output_main_loss: 0.1437 - val_classifier_output_aux_acc: 0.9486 - val_classifier_output_main_acc: 0.9611
Epoch 33/1000
 - 21s - loss: 0.2069 - classifier_output_aux_loss: 0.1237 - classifier_output_main_loss: 0.0832 - classifier_output_aux_acc: 0.9603 - classifier_output_main_acc: 0.9736 - val_loss: 0.4150 - val_classifier_output_aux_loss: 0.2460 - val_classifier_output_main_loss: 0.1690 - val_classifier_output_aux_acc: 0.9292 - val_classifier_output_main_acc: 0.9542
Epoch 34/1000
 - 22s - loss: 0.2052 - classifier_output_aux_loss: 0.1265 - classifier_output_main_loss: 0.0787 - classifier_output_aux_acc: 0.9591 - classifier_output_main_acc: 0.9775 - val_loss: 0.2574 - val_classifier_output_aux_loss: 0.1107 - val_classifier_output_main_loss: 0.1467 - val_classifier_output_aux_acc: 0.9667 - val_classifier_output_main_acc: 0.9611
Epoch 35/1000
 - 24s - loss: 0.1916 - classifier_output_aux_loss: 0.1124 - classifier_output_main_loss: 0.0792 - classifier_output_aux_acc: 0.9647 - classifier_output_main_acc: 0.9755 - val_loss: 0.2624 - val_classifier_output_aux_loss: 0.1301 - val_classifier_output_main_loss: 0.1322 - val_classifier_output_aux_acc: 0.9569 - val_classifier_output_main_acc: 0.9625
Epoch 36/1000
 - 26s - loss: 0.1895 - classifier_output_aux_loss: 0.1195 - classifier_output_main_loss: 0.0700 - classifier_output_aux_acc: 0.9611 - classifier_output_main_acc: 0.9778 - val_loss: 0.2470 - val_classifier_output_aux_loss: 0.1338 - val_classifier_output_main_loss: 0.1132 - val_classifier_output_aux_acc: 0.9583 - val_classifier_output_main_acc: 0.9639
Epoch 37/1000
 - 26s - loss: 0.1969 - classifier_output_aux_loss: 0.1138 - classifier_output_main_loss: 0.0832 - classifier_output_aux_acc: 0.9676 - classifier_output_main_acc: 0.9764 - val_loss: 0.2922 - val_classifier_output_aux_loss: 0.1592 - val_classifier_output_main_loss: 0.1330 - val_classifier_output_aux_acc: 0.9528 - val_classifier_output_main_acc: 0.9653
Epoch 38/1000
 - 26s - loss: 0.1852 - classifier_output_aux_loss: 0.1147 - classifier_output_main_loss: 0.0705 - classifier_output_aux_acc: 0.9664 - classifier_output_main_acc: 0.9807 - val_loss: 0.4194 - val_classifier_output_aux_loss: 0.2198 - val_classifier_output_main_loss: 0.1996 - val_classifier_output_aux_acc: 0.9389 - val_classifier_output_main_acc: 0.9611
time_consuming: 4.5600000000004 1800 0.0025333333333335557
cm_aux: [[212  23   2   1  18  44]
 [ 11 169   8   3  70  39]
 [ 40  10 183  33  18  16]
 [  1   8   3 264   4  20]
 [  9   8   2  18 229  34]
 [ 11   7   2   4  27 249]]
cm_main: [[247   2  27   2  10  12]
 [  3 231   3  13  13  37]
 [  0   2 286   6   1   5]
 [  0   2  38 251   8   1]
 [  6  11   1   4 262  16]
 [ 10   2   4   3   3 278]]
normalized cm_main: [[0.82333333 0.00666667 0.09       0.00666667 0.03333333 0.04      ]
 [0.01       0.77       0.01       0.04333333 0.04333333 0.12333333]
 [0.         0.00666667 0.95333333 0.02       0.00333333 0.01666667]
 [0.         0.00666667 0.12666667 0.83666667 0.02666667 0.00333333]
 [0.02       0.03666667 0.00333333 0.01333333 0.87333333 0.05333333]
 [0.03333333 0.00666667 0.01333333 0.01       0.01       0.92666667]]
metrics: ['loss', 'classifier_output_aux_loss', 'classifier_output_main_loss', 'classifier_output_aux_acc', 'classifier_output_main_acc']
Test score: [2.3145884055561488, 1.5017637677987417, 0.8128246364908732, 0.7255555555555555, 0.8638888888888889]
Test loss: 1.5017637677987417
Test accuracy of aux: 0.7255555555555555
Test accuracy of main: 0.8638888888888889
Saving model to disk 

__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
main_input_1 (InputLayer)       (None, 29, 6, 20, 3) 0                                            
__________________________________________________________________________________________________
main_input_2 (InputLayer)       (None, 29, 6, 20, 3) 0                                            
__________________________________________________________________________________________________
feature_output_aux (TimeDistrib (None, 29, 64)       78400       main_input_1[0][0]               
__________________________________________________________________________________________________
feature_output_main (TimeDistri (None, 29, 64)       78400       main_input_2[0][0]               
__________________________________________________________________________________________________
gru_5 (GRU)                     (None, 128)          74112       feature_output_aux[0][0]         
__________________________________________________________________________________________________
gru_6 (GRU)                     (None, 128)          74112       feature_output_main[0][0]        
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 128)          0           gru_5[0][0]                      
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 128)          0           gru_6[0][0]                      
__________________________________________________________________________________________________
gradient_reversal_5 (GradientRe (None, 128)          0           dropout_16[0][0]                 
__________________________________________________________________________________________________
gradient_reversal_6 (GradientRe (None, 128)          0           dropout_14[0][0]                 
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 256)          0           dropout_14[0][0]                 
                                                                 gradient_reversal_5[0][0]        
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 256)          0           dropout_16[0][0]                 
                                                                 gradient_reversal_6[0][0]        
__________________________________________________________________________________________________
dense_17 (Dense)                (None, 128)          32896       concatenate_5[0][0]              
__________________________________________________________________________________________________
dense_18 (Dense)                (None, 128)          32896       concatenate_6[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 128)          0           dense_17[0][0]                   
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 128)          0           dense_18[0][0]                   
__________________________________________________________________________________________________
classifier_output_aux (Dense)   (None, 6)            774         dropout_17[0][0]                 
__________________________________________________________________________________________________
classifier_output_main (Dense)  (None, 6)            774         dropout_18[0][0]                 
==================================================================================================
Total params: 372,364
Trainable params: 372,364
Non-trainable params: 0
__________________________________________________________________________________________________
None
Loading Data...
domain_type: 2
Loaded Data wf_tally_slice 2 (7200, 29, 6, 20, 3) 4 (7200, 6) 2 (1800, 29, 6, 20, 3)
n_timesteps: 29
Train on 6480 samples, validate on 720 samples
Epoch 1/1000
 - 32s - loss: 3.2152 - classifier_output_aux_loss: 1.5861 - classifier_output_main_loss: 1.6291 - classifier_output_aux_acc: 0.3267 - classifier_output_main_acc: 0.3032 - val_loss: 2.7631 - val_classifier_output_aux_loss: 1.4171 - val_classifier_output_main_loss: 1.3460 - val_classifier_output_aux_acc: 0.4125 - val_classifier_output_main_acc: 0.4597
Epoch 2/1000
 - 26s - loss: 2.6551 - classifier_output_aux_loss: 1.3637 - classifier_output_main_loss: 1.2914 - classifier_output_aux_acc: 0.4622 - classifier_output_main_acc: 0.4889 - val_loss: 2.4142 - val_classifier_output_aux_loss: 1.2515 - val_classifier_output_main_loss: 1.1627 - val_classifier_output_aux_acc: 0.4764 - val_classifier_output_main_acc: 0.5486
Epoch 3/1000
 - 26s - loss: 2.3518 - classifier_output_aux_loss: 1.1943 - classifier_output_main_loss: 1.1575 - classifier_output_aux_acc: 0.5384 - classifier_output_main_acc: 0.5571 - val_loss: 2.1041 - val_classifier_output_aux_loss: 1.0209 - val_classifier_output_main_loss: 1.0832 - val_classifier_output_aux_acc: 0.6000 - val_classifier_output_main_acc: 0.6125
Epoch 4/1000
 - 26s - loss: 2.0691 - classifier_output_aux_loss: 1.0449 - classifier_output_main_loss: 1.0242 - classifier_output_aux_acc: 0.6020 - classifier_output_main_acc: 0.6108 - val_loss: 1.6927 - val_classifier_output_aux_loss: 0.8450 - val_classifier_output_main_loss: 0.8477 - val_classifier_output_aux_acc: 0.6792 - val_classifier_output_main_acc: 0.6875
Epoch 5/1000
 - 26s - loss: 1.8200 - classifier_output_aux_loss: 0.9181 - classifier_output_main_loss: 0.9019 - classifier_output_aux_acc: 0.6590 - classifier_output_main_acc: 0.6660 - val_loss: 1.7624 - val_classifier_output_aux_loss: 0.8214 - val_classifier_output_main_loss: 0.9410 - val_classifier_output_aux_acc: 0.7083 - val_classifier_output_main_acc: 0.6569
Epoch 6/1000
 - 26s - loss: 1.6170 - classifier_output_aux_loss: 0.8279 - classifier_output_main_loss: 0.7891 - classifier_output_aux_acc: 0.6918 - classifier_output_main_acc: 0.7085 - val_loss: 1.2558 - val_classifier_output_aux_loss: 0.6582 - val_classifier_output_main_loss: 0.5977 - val_classifier_output_aux_acc: 0.7569 - val_classifier_output_main_acc: 0.7944
Epoch 7/1000
 - 26s - loss: 1.4218 - classifier_output_aux_loss: 0.7437 - classifier_output_main_loss: 0.6781 - classifier_output_aux_acc: 0.7316 - classifier_output_main_acc: 0.7472 - val_loss: 1.3341 - val_classifier_output_aux_loss: 0.8043 - val_classifier_output_main_loss: 0.5298 - val_classifier_output_aux_acc: 0.7264 - val_classifier_output_main_acc: 0.8111
Epoch 8/1000
 - 26s - loss: 1.2719 - classifier_output_aux_loss: 0.6826 - classifier_output_main_loss: 0.5893 - classifier_output_aux_acc: 0.7577 - classifier_output_main_acc: 0.7946 - val_loss: 1.0376 - val_classifier_output_aux_loss: 0.5307 - val_classifier_output_main_loss: 0.5069 - val_classifier_output_aux_acc: 0.8056 - val_classifier_output_main_acc: 0.8167
Epoch 9/1000
 - 26s - loss: 1.1058 - classifier_output_aux_loss: 0.6015 - classifier_output_main_loss: 0.5043 - classifier_output_aux_acc: 0.7890 - classifier_output_main_acc: 0.8269 - val_loss: 1.0394 - val_classifier_output_aux_loss: 0.5176 - val_classifier_output_main_loss: 0.5218 - val_classifier_output_aux_acc: 0.8208 - val_classifier_output_main_acc: 0.8292
Epoch 10/1000
 - 27s - loss: 0.9879 - classifier_output_aux_loss: 0.5322 - classifier_output_main_loss: 0.4557 - classifier_output_aux_acc: 0.8171 - classifier_output_main_acc: 0.8397 - val_loss: 1.2353 - val_classifier_output_aux_loss: 0.6533 - val_classifier_output_main_loss: 0.5821 - val_classifier_output_aux_acc: 0.7583 - val_classifier_output_main_acc: 0.8028
Epoch 11/1000
 - 27s - loss: 0.8763 - classifier_output_aux_loss: 0.4676 - classifier_output_main_loss: 0.4087 - classifier_output_aux_acc: 0.8316 - classifier_output_main_acc: 0.8506 - val_loss: 0.7981 - val_classifier_output_aux_loss: 0.3810 - val_classifier_output_main_loss: 0.4171 - val_classifier_output_aux_acc: 0.8722 - val_classifier_output_main_acc: 0.8667
Epoch 12/1000
 - 26s - loss: 0.8081 - classifier_output_aux_loss: 0.4298 - classifier_output_main_loss: 0.3782 - classifier_output_aux_acc: 0.8452 - classifier_output_main_acc: 0.8677 - val_loss: 0.7457 - val_classifier_output_aux_loss: 0.3781 - val_classifier_output_main_loss: 0.3676 - val_classifier_output_aux_acc: 0.8514 - val_classifier_output_main_acc: 0.8583
Epoch 13/1000
 - 27s - loss: 0.7366 - classifier_output_aux_loss: 0.3945 - classifier_output_main_loss: 0.3421 - classifier_output_aux_acc: 0.8645 - classifier_output_main_acc: 0.8815 - val_loss: 0.6007 - val_classifier_output_aux_loss: 0.3070 - val_classifier_output_main_loss: 0.2937 - val_classifier_output_aux_acc: 0.8917 - val_classifier_output_main_acc: 0.9028
Epoch 14/1000
 - 27s - loss: 0.6760 - classifier_output_aux_loss: 0.3604 - classifier_output_main_loss: 0.3156 - classifier_output_aux_acc: 0.8765 - classifier_output_main_acc: 0.8924 - val_loss: 0.5490 - val_classifier_output_aux_loss: 0.2999 - val_classifier_output_main_loss: 0.2490 - val_classifier_output_aux_acc: 0.8917 - val_classifier_output_main_acc: 0.9069
Epoch 15/1000
 - 27s - loss: 0.6166 - classifier_output_aux_loss: 0.3273 - classifier_output_main_loss: 0.2893 - classifier_output_aux_acc: 0.8861 - classifier_output_main_acc: 0.9012 - val_loss: 0.6233 - val_classifier_output_aux_loss: 0.3071 - val_classifier_output_main_loss: 0.3162 - val_classifier_output_aux_acc: 0.8903 - val_classifier_output_main_acc: 0.8986
Epoch 16/1000
 - 27s - loss: 0.5386 - classifier_output_aux_loss: 0.2955 - classifier_output_main_loss: 0.2431 - classifier_output_aux_acc: 0.8981 - classifier_output_main_acc: 0.9165 - val_loss: 0.6935 - val_classifier_output_aux_loss: 0.3490 - val_classifier_output_main_loss: 0.3445 - val_classifier_output_aux_acc: 0.8861 - val_classifier_output_main_acc: 0.8903
Epoch 17/1000
 - 41s - loss: 0.5298 - classifier_output_aux_loss: 0.2898 - classifier_output_main_loss: 0.2401 - classifier_output_aux_acc: 0.9006 - classifier_output_main_acc: 0.9201 - val_loss: 0.5397 - val_classifier_output_aux_loss: 0.2922 - val_classifier_output_main_loss: 0.2474 - val_classifier_output_aux_acc: 0.9097 - val_classifier_output_main_acc: 0.9208
Epoch 18/1000
 - 24s - loss: 0.4936 - classifier_output_aux_loss: 0.2764 - classifier_output_main_loss: 0.2172 - classifier_output_aux_acc: 0.9065 - classifier_output_main_acc: 0.9276 - val_loss: 0.5061 - val_classifier_output_aux_loss: 0.2428 - val_classifier_output_main_loss: 0.2632 - val_classifier_output_aux_acc: 0.9208 - val_classifier_output_main_acc: 0.9222
Epoch 19/1000
 - 52s - loss: 0.4433 - classifier_output_aux_loss: 0.2460 - classifier_output_main_loss: 0.1973 - classifier_output_aux_acc: 0.9128 - classifier_output_main_acc: 0.9324 - val_loss: 0.5029 - val_classifier_output_aux_loss: 0.2792 - val_classifier_output_main_loss: 0.2238 - val_classifier_output_aux_acc: 0.9167 - val_classifier_output_main_acc: 0.9319
Epoch 20/1000
 - 42s - loss: 0.4170 - classifier_output_aux_loss: 0.2310 - classifier_output_main_loss: 0.1860 - classifier_output_aux_acc: 0.9228 - classifier_output_main_acc: 0.9377 - val_loss: 0.4793 - val_classifier_output_aux_loss: 0.2731 - val_classifier_output_main_loss: 0.2061 - val_classifier_output_aux_acc: 0.9194 - val_classifier_output_main_acc: 0.9403
Epoch 21/1000
 - 55s - loss: 0.3810 - classifier_output_aux_loss: 0.2094 - classifier_output_main_loss: 0.1716 - classifier_output_aux_acc: 0.9282 - classifier_output_main_acc: 0.9423 - val_loss: 0.4980 - val_classifier_output_aux_loss: 0.2475 - val_classifier_output_main_loss: 0.2505 - val_classifier_output_aux_acc: 0.9264 - val_classifier_output_main_acc: 0.9250
Epoch 22/1000
 - 62s - loss: 0.3790 - classifier_output_aux_loss: 0.2051 - classifier_output_main_loss: 0.1739 - classifier_output_aux_acc: 0.9299 - classifier_output_main_acc: 0.9426 - val_loss: 0.4797 - val_classifier_output_aux_loss: 0.3011 - val_classifier_output_main_loss: 0.1785 - val_classifier_output_aux_acc: 0.9111 - val_classifier_output_main_acc: 0.9486
Epoch 23/1000
 - 67s - loss: 0.3283 - classifier_output_aux_loss: 0.1823 - classifier_output_main_loss: 0.1461 - classifier_output_aux_acc: 0.9384 - classifier_output_main_acc: 0.9506 - val_loss: 0.3824 - val_classifier_output_aux_loss: 0.1922 - val_classifier_output_main_loss: 0.1902 - val_classifier_output_aux_acc: 0.9431 - val_classifier_output_main_acc: 0.9458
Epoch 24/1000
 - 42s - loss: 0.3118 - classifier_output_aux_loss: 0.1756 - classifier_output_main_loss: 0.1362 - classifier_output_aux_acc: 0.9404 - classifier_output_main_acc: 0.9565 - val_loss: 0.5526 - val_classifier_output_aux_loss: 0.3315 - val_classifier_output_main_loss: 0.2212 - val_classifier_output_aux_acc: 0.9153 - val_classifier_output_main_acc: 0.9389
Epoch 25/1000
 - 32s - loss: 0.3164 - classifier_output_aux_loss: 0.1787 - classifier_output_main_loss: 0.1377 - classifier_output_aux_acc: 0.9404 - classifier_output_main_acc: 0.9576 - val_loss: 0.3227 - val_classifier_output_aux_loss: 0.1973 - val_classifier_output_main_loss: 0.1254 - val_classifier_output_aux_acc: 0.9431 - val_classifier_output_main_acc: 0.9611
Epoch 26/1000
 - 28s - loss: 0.2702 - classifier_output_aux_loss: 0.1470 - classifier_output_main_loss: 0.1232 - classifier_output_aux_acc: 0.9543 - classifier_output_main_acc: 0.9613 - val_loss: 0.4179 - val_classifier_output_aux_loss: 0.2846 - val_classifier_output_main_loss: 0.1333 - val_classifier_output_aux_acc: 0.9361 - val_classifier_output_main_acc: 0.9542
Epoch 27/1000
 - 30s - loss: 0.2682 - classifier_output_aux_loss: 0.1436 - classifier_output_main_loss: 0.1246 - classifier_output_aux_acc: 0.9539 - classifier_output_main_acc: 0.9597 - val_loss: 0.5243 - val_classifier_output_aux_loss: 0.3595 - val_classifier_output_main_loss: 0.1648 - val_classifier_output_aux_acc: 0.9153 - val_classifier_output_main_acc: 0.9431
Epoch 28/1000
 - 30s - loss: 0.2634 - classifier_output_aux_loss: 0.1507 - classifier_output_main_loss: 0.1127 - classifier_output_aux_acc: 0.9526 - classifier_output_main_acc: 0.9627 - val_loss: 0.4309 - val_classifier_output_aux_loss: 0.2440 - val_classifier_output_main_loss: 0.1869 - val_classifier_output_aux_acc: 0.9375 - val_classifier_output_main_acc: 0.9500
Epoch 29/1000
 - 27s - loss: 0.2600 - classifier_output_aux_loss: 0.1462 - classifier_output_main_loss: 0.1138 - classifier_output_aux_acc: 0.9515 - classifier_output_main_acc: 0.9620 - val_loss: 0.5610 - val_classifier_output_aux_loss: 0.3316 - val_classifier_output_main_loss: 0.2293 - val_classifier_output_aux_acc: 0.9208 - val_classifier_output_main_acc: 0.9403
Epoch 30/1000
 - 27s - loss: 0.2419 - classifier_output_aux_loss: 0.1381 - classifier_output_main_loss: 0.1038 - classifier_output_aux_acc: 0.9593 - classifier_output_main_acc: 0.9665 - val_loss: 0.7088 - val_classifier_output_aux_loss: 0.4895 - val_classifier_output_main_loss: 0.2193 - val_classifier_output_aux_acc: 0.9042 - val_classifier_output_main_acc: 0.9472
Epoch 31/1000
 - 26s - loss: 0.2302 - classifier_output_aux_loss: 0.1300 - classifier_output_main_loss: 0.1001 - classifier_output_aux_acc: 0.9577 - classifier_output_main_acc: 0.9698 - val_loss: 0.5026 - val_classifier_output_aux_loss: 0.3097 - val_classifier_output_main_loss: 0.1929 - val_classifier_output_aux_acc: 0.9167 - val_classifier_output_main_acc: 0.9500
Epoch 32/1000
 - 27s - loss: 0.2237 - classifier_output_aux_loss: 0.1283 - classifier_output_main_loss: 0.0954 - classifier_output_aux_acc: 0.9605 - classifier_output_main_acc: 0.9702 - val_loss: 0.3067 - val_classifier_output_aux_loss: 0.1650 - val_classifier_output_main_loss: 0.1417 - val_classifier_output_aux_acc: 0.9528 - val_classifier_output_main_acc: 0.9597
Epoch 33/1000
 - 27s - loss: 0.2090 - classifier_output_aux_loss: 0.1159 - classifier_output_main_loss: 0.0931 - classifier_output_aux_acc: 0.9620 - classifier_output_main_acc: 0.9727 - val_loss: 0.4221 - val_classifier_output_aux_loss: 0.1840 - val_classifier_output_main_loss: 0.2382 - val_classifier_output_aux_acc: 0.9528 - val_classifier_output_main_acc: 0.9458
Epoch 34/1000
 - 26s - loss: 0.1960 - classifier_output_aux_loss: 0.1166 - classifier_output_main_loss: 0.0794 - classifier_output_aux_acc: 0.9637 - classifier_output_main_acc: 0.9738 - val_loss: 0.3010 - val_classifier_output_aux_loss: 0.1803 - val_classifier_output_main_loss: 0.1207 - val_classifier_output_aux_acc: 0.9597 - val_classifier_output_main_acc: 0.9681
Epoch 35/1000
 - 26s - loss: 0.1978 - classifier_output_aux_loss: 0.1048 - classifier_output_main_loss: 0.0930 - classifier_output_aux_acc: 0.9682 - classifier_output_main_acc: 0.9728 - val_loss: 0.6005 - val_classifier_output_aux_loss: 0.3395 - val_classifier_output_main_loss: 0.2609 - val_classifier_output_aux_acc: 0.9097 - val_classifier_output_main_acc: 0.9597
Epoch 36/1000
 - 26s - loss: 0.1874 - classifier_output_aux_loss: 0.1027 - classifier_output_main_loss: 0.0847 - classifier_output_aux_acc: 0.9676 - classifier_output_main_acc: 0.9753 - val_loss: 0.3971 - val_classifier_output_aux_loss: 0.2430 - val_classifier_output_main_loss: 0.1541 - val_classifier_output_aux_acc: 0.9444 - val_classifier_output_main_acc: 0.9583
Epoch 37/1000
 - 26s - loss: 0.1804 - classifier_output_aux_loss: 0.1028 - classifier_output_main_loss: 0.0775 - classifier_output_aux_acc: 0.9681 - classifier_output_main_acc: 0.9745 - val_loss: 0.3832 - val_classifier_output_aux_loss: 0.2002 - val_classifier_output_main_loss: 0.1830 - val_classifier_output_aux_acc: 0.9458 - val_classifier_output_main_acc: 0.9569
Epoch 38/1000
 - 26s - loss: 0.1958 - classifier_output_aux_loss: 0.1145 - classifier_output_main_loss: 0.0813 - classifier_output_aux_acc: 0.9648 - classifier_output_main_acc: 0.9756 - val_loss: 0.3778 - val_classifier_output_aux_loss: 0.1590 - val_classifier_output_main_loss: 0.2187 - val_classifier_output_aux_acc: 0.9556 - val_classifier_output_main_acc: 0.9556
Epoch 39/1000
 - 27s - loss: 0.1849 - classifier_output_aux_loss: 0.1075 - classifier_output_main_loss: 0.0774 - classifier_output_aux_acc: 0.9668 - classifier_output_main_acc: 0.9762 - val_loss: 0.3395 - val_classifier_output_aux_loss: 0.2150 - val_classifier_output_main_loss: 0.1245 - val_classifier_output_aux_acc: 0.9486 - val_classifier_output_main_acc: 0.9750
Epoch 40/1000
 - 27s - loss: 0.1592 - classifier_output_aux_loss: 0.0965 - classifier_output_main_loss: 0.0627 - classifier_output_aux_acc: 0.9690 - classifier_output_main_acc: 0.9823 - val_loss: 0.4103 - val_classifier_output_aux_loss: 0.1906 - val_classifier_output_main_loss: 0.2197 - val_classifier_output_aux_acc: 0.9569 - val_classifier_output_main_acc: 0.9611
Epoch 41/1000
 - 27s - loss: 0.1681 - classifier_output_aux_loss: 0.0943 - classifier_output_main_loss: 0.0738 - classifier_output_aux_acc: 0.9713 - classifier_output_main_acc: 0.9769 - val_loss: 0.3335 - val_classifier_output_aux_loss: 0.1722 - val_classifier_output_main_loss: 0.1614 - val_classifier_output_aux_acc: 0.9583 - val_classifier_output_main_acc: 0.9694
Epoch 42/1000
 - 27s - loss: 0.1673 - classifier_output_aux_loss: 0.0950 - classifier_output_main_loss: 0.0723 - classifier_output_aux_acc: 0.9685 - classifier_output_main_acc: 0.9781 - val_loss: 0.3830 - val_classifier_output_aux_loss: 0.1714 - val_classifier_output_main_loss: 0.2116 - val_classifier_output_aux_acc: 0.9625 - val_classifier_output_main_acc: 0.9653
Epoch 43/1000
 - 27s - loss: 0.1582 - classifier_output_aux_loss: 0.0871 - classifier_output_main_loss: 0.0712 - classifier_output_aux_acc: 0.9747 - classifier_output_main_acc: 0.9804 - val_loss: 0.3626 - val_classifier_output_aux_loss: 0.1640 - val_classifier_output_main_loss: 0.1986 - val_classifier_output_aux_acc: 0.9528 - val_classifier_output_main_acc: 0.9639
Epoch 44/1000
 - 26s - loss: 0.1611 - classifier_output_aux_loss: 0.0913 - classifier_output_main_loss: 0.0697 - classifier_output_aux_acc: 0.9694 - classifier_output_main_acc: 0.9796 - val_loss: 0.3009 - val_classifier_output_aux_loss: 0.1987 - val_classifier_output_main_loss: 0.1021 - val_classifier_output_aux_acc: 0.9583 - val_classifier_output_main_acc: 0.9708
Epoch 45/1000
 - 22s - loss: 0.1610 - classifier_output_aux_loss: 0.0910 - classifier_output_main_loss: 0.0700 - classifier_output_aux_acc: 0.9739 - classifier_output_main_acc: 0.9799 - val_loss: 0.3532 - val_classifier_output_aux_loss: 0.1700 - val_classifier_output_main_loss: 0.1832 - val_classifier_output_aux_acc: 0.9583 - val_classifier_output_main_acc: 0.9639
Epoch 46/1000
 - 22s - loss: 0.1481 - classifier_output_aux_loss: 0.0847 - classifier_output_main_loss: 0.0634 - classifier_output_aux_acc: 0.9745 - classifier_output_main_acc: 0.9824 - val_loss: 0.3404 - val_classifier_output_aux_loss: 0.1570 - val_classifier_output_main_loss: 0.1834 - val_classifier_output_aux_acc: 0.9681 - val_classifier_output_main_acc: 0.9639
Epoch 47/1000
 - 22s - loss: 0.1331 - classifier_output_aux_loss: 0.0778 - classifier_output_main_loss: 0.0554 - classifier_output_aux_acc: 0.9775 - classifier_output_main_acc: 0.9833 - val_loss: 0.6127 - val_classifier_output_aux_loss: 0.2448 - val_classifier_output_main_loss: 0.3679 - val_classifier_output_aux_acc: 0.9486 - val_classifier_output_main_acc: 0.9278
Epoch 48/1000
 - 24s - loss: 0.1379 - classifier_output_aux_loss: 0.0797 - classifier_output_main_loss: 0.0582 - classifier_output_aux_acc: 0.9765 - classifier_output_main_acc: 0.9830 - val_loss: 0.3902 - val_classifier_output_aux_loss: 0.2086 - val_classifier_output_main_loss: 0.1816 - val_classifier_output_aux_acc: 0.9514 - val_classifier_output_main_acc: 0.9597
Epoch 49/1000
 - 44s - loss: 0.1605 - classifier_output_aux_loss: 0.0825 - classifier_output_main_loss: 0.0780 - classifier_output_aux_acc: 0.9755 - classifier_output_main_acc: 0.9799 - val_loss: 0.3992 - val_classifier_output_aux_loss: 0.2353 - val_classifier_output_main_loss: 0.1639 - val_classifier_output_aux_acc: 0.9514 - val_classifier_output_main_acc: 0.9639
Epoch 50/1000
 - 39s - loss: 0.1476 - classifier_output_aux_loss: 0.0893 - classifier_output_main_loss: 0.0582 - classifier_output_aux_acc: 0.9761 - classifier_output_main_acc: 0.9826 - val_loss: 0.3307 - val_classifier_output_aux_loss: 0.1700 - val_classifier_output_main_loss: 0.1608 - val_classifier_output_aux_acc: 0.9694 - val_classifier_output_main_acc: 0.9667
Epoch 51/1000
 - 44s - loss: 0.1332 - classifier_output_aux_loss: 0.0799 - classifier_output_main_loss: 0.0533 - classifier_output_aux_acc: 0.9778 - classifier_output_main_acc: 0.9855 - val_loss: 0.3116 - val_classifier_output_aux_loss: 0.1551 - val_classifier_output_main_loss: 0.1564 - val_classifier_output_aux_acc: 0.9722 - val_classifier_output_main_acc: 0.9681
Epoch 52/1000
 - 29s - loss: 0.1218 - classifier_output_aux_loss: 0.0628 - classifier_output_main_loss: 0.0589 - classifier_output_aux_acc: 0.9795 - classifier_output_main_acc: 0.9832 - val_loss: 0.3572 - val_classifier_output_aux_loss: 0.1487 - val_classifier_output_main_loss: 0.2084 - val_classifier_output_aux_acc: 0.9722 - val_classifier_output_main_acc: 0.9667
Epoch 53/1000
 - 27s - loss: 0.1390 - classifier_output_aux_loss: 0.0804 - classifier_output_main_loss: 0.0586 - classifier_output_aux_acc: 0.9759 - classifier_output_main_acc: 0.9823 - val_loss: 0.3735 - val_classifier_output_aux_loss: 0.2236 - val_classifier_output_main_loss: 0.1499 - val_classifier_output_aux_acc: 0.9528 - val_classifier_output_main_acc: 0.9722
Epoch 54/1000
 - 27s - loss: 0.1199 - classifier_output_aux_loss: 0.0676 - classifier_output_main_loss: 0.0523 - classifier_output_aux_acc: 0.9787 - classifier_output_main_acc: 0.9852 - val_loss: 0.3828 - val_classifier_output_aux_loss: 0.1516 - val_classifier_output_main_loss: 0.2313 - val_classifier_output_aux_acc: 0.9653 - val_classifier_output_main_acc: 0.9625
time_consuming: 4.710000000000036 1800 0.002616666666666687
cm_aux: [[199  48   1   0  21  31]
 [ 13 235   2   0  48   2]
 [ 15  27 202  15  15  26]
 [  0   9  13 229   5  44]
 [  6  29   3   1 248  13]
 [  2  26   1   1  38 232]]
cm_main: [[248   1  19  14  11   7]
 [  5 262   2  21   3   7]
 [  0   1 276  19   3   1]
 [  0   6   6 284   2   2]
 [ 12  24   2   1 247  14]
 [  7   4   1   5   0 283]]
normalized cm_main: [[0.82666667 0.00333333 0.06333333 0.04666667 0.03666667 0.02333333]
 [0.01666667 0.87333333 0.00666667 0.07       0.01       0.02333333]
 [0.         0.00333333 0.92       0.06333333 0.01       0.00333333]
 [0.         0.02       0.02       0.94666667 0.00666667 0.00666667]
 [0.04       0.08       0.00666667 0.00333333 0.82333333 0.04666667]
 [0.02333333 0.01333333 0.00333333 0.01666667 0.         0.94333333]]
metrics: ['loss', 'classifier_output_aux_loss', 'classifier_output_main_loss', 'classifier_output_aux_acc', 'classifier_output_main_acc']
Test score: [2.3012306135230594, 1.5303235142760807, 0.7709070953786811, 0.7472222222222222, 0.8888888888888888]
Test loss: 1.5303235142760807
Test accuracy of aux: 0.7472222222222222
Test accuracy of main: 0.8888888888888888
Saving model to disk 

__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
main_input_1 (InputLayer)       (None, 29, 6, 20, 3) 0                                            
__________________________________________________________________________________________________
main_input_2 (InputLayer)       (None, 29, 6, 20, 3) 0                                            
__________________________________________________________________________________________________
feature_output_aux (TimeDistrib (None, 29, 64)       78400       main_input_1[0][0]               
__________________________________________________________________________________________________
feature_output_main (TimeDistri (None, 29, 64)       78400       main_input_2[0][0]               
__________________________________________________________________________________________________
gru_1 (GRU)                     (None, 128)          74112       feature_output_aux[0][0]         
__________________________________________________________________________________________________
gru_2 (GRU)                     (None, 128)          74112       feature_output_main[0][0]        
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 128)          0           gru_1[0][0]                      
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 128)          0           gru_2[0][0]                      
__________________________________________________________________________________________________
gradient_reversal_1 (GradientRe (None, 128)          0           dropout_4[0][0]                  
__________________________________________________________________________________________________
gradient_reversal_2 (GradientRe (None, 128)          0           dropout_2[0][0]                  
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 256)          0           dropout_2[0][0]                  
                                                                 gradient_reversal_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 256)          0           dropout_4[0][0]                  
                                                                 gradient_reversal_2[0][0]        
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 128)          32896       concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_6 (Dense)                 (None, 128)          32896       concatenate_2[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 128)          0           dense_5[0][0]                    
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 128)          0           dense_6[0][0]                    
__________________________________________________________________________________________________
classifier_output_aux (Dense)   (None, 6)            774         dropout_5[0][0]                  
__________________________________________________________________________________________________
classifier_output_main (Dense)  (None, 6)            774         dropout_6[0][0]                  
==================================================================================================
Total params: 372,364
Trainable params: 372,364
Non-trainable params: 0
__________________________________________________________________________________________________
None
Loading Data...
domain_type: 2
Loaded Data wf_tally_slice 2 (7200, 29, 6, 20, 3) 4 (7200, 6) 2 (1800, 29, 6, 20, 3)
n_timesteps: 29
Train on 6480 samples, validate on 720 samples
Epoch 1/1000
 - 31s - loss: 3.2698 - classifier_output_aux_loss: 1.6099 - classifier_output_main_loss: 1.6599 - classifier_output_aux_acc: 0.3090 - classifier_output_main_acc: 0.2810 - val_loss: 2.8428 - val_classifier_output_aux_loss: 1.4335 - val_classifier_output_main_loss: 1.4093 - val_classifier_output_aux_acc: 0.4167 - val_classifier_output_main_acc: 0.4458
Epoch 2/1000
 - 27s - loss: 2.7336 - classifier_output_aux_loss: 1.3881 - classifier_output_main_loss: 1.3455 - classifier_output_aux_acc: 0.4508 - classifier_output_main_acc: 0.4722 - val_loss: 2.5263 - val_classifier_output_aux_loss: 1.3864 - val_classifier_output_main_loss: 1.1399 - val_classifier_output_aux_acc: 0.4611 - val_classifier_output_main_acc: 0.5792
Epoch 3/1000
 - 27s - loss: 2.4043 - classifier_output_aux_loss: 1.2325 - classifier_output_main_loss: 1.1718 - classifier_output_aux_acc: 0.5201 - classifier_output_main_acc: 0.5505 - val_loss: 2.1518 - val_classifier_output_aux_loss: 1.0784 - val_classifier_output_main_loss: 1.0734 - val_classifier_output_aux_acc: 0.5833 - val_classifier_output_main_acc: 0.5722
Epoch 4/1000
 - 27s - loss: 2.1276 - classifier_output_aux_loss: 1.0808 - classifier_output_main_loss: 1.0468 - classifier_output_aux_acc: 0.5798 - classifier_output_main_acc: 0.6088 - val_loss: 1.7292 - val_classifier_output_aux_loss: 0.8937 - val_classifier_output_main_loss: 0.8354 - val_classifier_output_aux_acc: 0.6639 - val_classifier_output_main_acc: 0.6861
Epoch 5/1000
 - 27s - loss: 1.8794 - classifier_output_aux_loss: 0.9640 - classifier_output_main_loss: 0.9154 - classifier_output_aux_acc: 0.6392 - classifier_output_main_acc: 0.6659 - val_loss: 2.0466 - val_classifier_output_aux_loss: 1.0814 - val_classifier_output_main_loss: 0.9652 - val_classifier_output_aux_acc: 0.6000 - val_classifier_output_main_acc: 0.6264
Epoch 6/1000
 - 27s - loss: 1.6181 - classifier_output_aux_loss: 0.8406 - classifier_output_main_loss: 0.7776 - classifier_output_aux_acc: 0.6892 - classifier_output_main_acc: 0.7168 - val_loss: 1.3730 - val_classifier_output_aux_loss: 0.7493 - val_classifier_output_main_loss: 0.6237 - val_classifier_output_aux_acc: 0.7208 - val_classifier_output_main_acc: 0.7819
Epoch 7/1000
 - 26s - loss: 1.4058 - classifier_output_aux_loss: 0.7363 - classifier_output_main_loss: 0.6695 - classifier_output_aux_acc: 0.7306 - classifier_output_main_acc: 0.7625 - val_loss: 1.3861 - val_classifier_output_aux_loss: 0.8467 - val_classifier_output_main_loss: 0.5395 - val_classifier_output_aux_acc: 0.6944 - val_classifier_output_main_acc: 0.7972
Epoch 8/1000
 - 27s - loss: 1.2441 - classifier_output_aux_loss: 0.6701 - classifier_output_main_loss: 0.5740 - classifier_output_aux_acc: 0.7613 - classifier_output_main_acc: 0.7978 - val_loss: 1.0720 - val_classifier_output_aux_loss: 0.5949 - val_classifier_output_main_loss: 0.4771 - val_classifier_output_aux_acc: 0.7750 - val_classifier_output_main_acc: 0.8236
Epoch 9/1000
 - 27s - loss: 1.0892 - classifier_output_aux_loss: 0.5811 - classifier_output_main_loss: 0.5080 - classifier_output_aux_acc: 0.7932 - classifier_output_main_acc: 0.8202 - val_loss: 0.9634 - val_classifier_output_aux_loss: 0.4882 - val_classifier_output_main_loss: 0.4752 - val_classifier_output_aux_acc: 0.8236 - val_classifier_output_main_acc: 0.8319
Epoch 10/1000
 - 27s - loss: 0.9726 - classifier_output_aux_loss: 0.5279 - classifier_output_main_loss: 0.4447 - classifier_output_aux_acc: 0.8147 - classifier_output_main_acc: 0.8426 - val_loss: 1.2025 - val_classifier_output_aux_loss: 0.4810 - val_classifier_output_main_loss: 0.7215 - val_classifier_output_aux_acc: 0.8153 - val_classifier_output_main_acc: 0.7597
Epoch 11/1000
 - 26s - loss: 0.8736 - classifier_output_aux_loss: 0.4711 - classifier_output_main_loss: 0.4026 - classifier_output_aux_acc: 0.8323 - classifier_output_main_acc: 0.8599 - val_loss: 0.7721 - val_classifier_output_aux_loss: 0.3993 - val_classifier_output_main_loss: 0.3727 - val_classifier_output_aux_acc: 0.8708 - val_classifier_output_main_acc: 0.8556
Epoch 12/1000
 - 26s - loss: 0.7942 - classifier_output_aux_loss: 0.4223 - classifier_output_main_loss: 0.3718 - classifier_output_aux_acc: 0.8478 - classifier_output_main_acc: 0.8707 - val_loss: 0.6682 - val_classifier_output_aux_loss: 0.3674 - val_classifier_output_main_loss: 0.3008 - val_classifier_output_aux_acc: 0.8639 - val_classifier_output_main_acc: 0.8861
Epoch 13/1000
 - 27s - loss: 0.7257 - classifier_output_aux_loss: 0.3945 - classifier_output_main_loss: 0.3312 - classifier_output_aux_acc: 0.8600 - classifier_output_main_acc: 0.8867 - val_loss: 0.5764 - val_classifier_output_aux_loss: 0.3163 - val_classifier_output_main_loss: 0.2600 - val_classifier_output_aux_acc: 0.8972 - val_classifier_output_main_acc: 0.9125
Epoch 14/1000
 - 27s - loss: 0.6657 - classifier_output_aux_loss: 0.3576 - classifier_output_main_loss: 0.3081 - classifier_output_aux_acc: 0.8824 - classifier_output_main_acc: 0.8958 - val_loss: 0.6891 - val_classifier_output_aux_loss: 0.4094 - val_classifier_output_main_loss: 0.2797 - val_classifier_output_aux_acc: 0.8583 - val_classifier_output_main_acc: 0.8889
Epoch 15/1000
 - 27s - loss: 0.5861 - classifier_output_aux_loss: 0.3149 - classifier_output_main_loss: 0.2712 - classifier_output_aux_acc: 0.8924 - classifier_output_main_acc: 0.9071 - val_loss: 0.5451 - val_classifier_output_aux_loss: 0.2981 - val_classifier_output_main_loss: 0.2470 - val_classifier_output_aux_acc: 0.9028 - val_classifier_output_main_acc: 0.9194
Epoch 16/1000
 - 26s - loss: 0.5536 - classifier_output_aux_loss: 0.3062 - classifier_output_main_loss: 0.2474 - classifier_output_aux_acc: 0.9000 - classifier_output_main_acc: 0.9151 - val_loss: 0.5471 - val_classifier_output_aux_loss: 0.2713 - val_classifier_output_main_loss: 0.2758 - val_classifier_output_aux_acc: 0.9056 - val_classifier_output_main_acc: 0.9153
Epoch 17/1000
 - 27s - loss: 0.4970 - classifier_output_aux_loss: 0.2740 - classifier_output_main_loss: 0.2230 - classifier_output_aux_acc: 0.9103 - classifier_output_main_acc: 0.9247 - val_loss: 0.4994 - val_classifier_output_aux_loss: 0.3082 - val_classifier_output_main_loss: 0.1912 - val_classifier_output_aux_acc: 0.9083 - val_classifier_output_main_acc: 0.9347
Epoch 18/1000
 - 26s - loss: 0.4728 - classifier_output_aux_loss: 0.2589 - classifier_output_main_loss: 0.2139 - classifier_output_aux_acc: 0.9069 - classifier_output_main_acc: 0.9306 - val_loss: 0.5889 - val_classifier_output_aux_loss: 0.4171 - val_classifier_output_main_loss: 0.1718 - val_classifier_output_aux_acc: 0.8736 - val_classifier_output_main_acc: 0.9361
Epoch 19/1000
 - 27s - loss: 0.4284 - classifier_output_aux_loss: 0.2351 - classifier_output_main_loss: 0.1933 - classifier_output_aux_acc: 0.9194 - classifier_output_main_acc: 0.9346 - val_loss: 0.4452 - val_classifier_output_aux_loss: 0.2378 - val_classifier_output_main_loss: 0.2074 - val_classifier_output_aux_acc: 0.9097 - val_classifier_output_main_acc: 0.9403
Epoch 20/1000
 - 26s - loss: 0.4072 - classifier_output_aux_loss: 0.2229 - classifier_output_main_loss: 0.1843 - classifier_output_aux_acc: 0.9287 - classifier_output_main_acc: 0.9370 - val_loss: 0.3624 - val_classifier_output_aux_loss: 0.2017 - val_classifier_output_main_loss: 0.1608 - val_classifier_output_aux_acc: 0.9306 - val_classifier_output_main_acc: 0.9542
Epoch 21/1000
 - 22s - loss: 0.3873 - classifier_output_aux_loss: 0.2172 - classifier_output_main_loss: 0.1701 - classifier_output_aux_acc: 0.9319 - classifier_output_main_acc: 0.9454 - val_loss: 0.3512 - val_classifier_output_aux_loss: 0.1803 - val_classifier_output_main_loss: 0.1709 - val_classifier_output_aux_acc: 0.9375 - val_classifier_output_main_acc: 0.9569
Epoch 22/1000
 - 22s - loss: 0.3669 - classifier_output_aux_loss: 0.1979 - classifier_output_main_loss: 0.1691 - classifier_output_aux_acc: 0.9324 - classifier_output_main_acc: 0.9488 - val_loss: 0.4481 - val_classifier_output_aux_loss: 0.2492 - val_classifier_output_main_loss: 0.1989 - val_classifier_output_aux_acc: 0.9222 - val_classifier_output_main_acc: 0.9306
Epoch 23/1000
 - 21s - loss: 0.3560 - classifier_output_aux_loss: 0.2039 - classifier_output_main_loss: 0.1521 - classifier_output_aux_acc: 0.9338 - classifier_output_main_acc: 0.9514 - val_loss: 0.5635 - val_classifier_output_aux_loss: 0.4151 - val_classifier_output_main_loss: 0.1484 - val_classifier_output_aux_acc: 0.9014 - val_classifier_output_main_acc: 0.9500
Epoch 24/1000
 - 21s - loss: 0.3178 - classifier_output_aux_loss: 0.1824 - classifier_output_main_loss: 0.1354 - classifier_output_aux_acc: 0.9401 - classifier_output_main_acc: 0.9557 - val_loss: 0.4360 - val_classifier_output_aux_loss: 0.2523 - val_classifier_output_main_loss: 0.1838 - val_classifier_output_aux_acc: 0.9194 - val_classifier_output_main_acc: 0.9486
Epoch 25/1000
 - 21s - loss: 0.2923 - classifier_output_aux_loss: 0.1486 - classifier_output_main_loss: 0.1437 - classifier_output_aux_acc: 0.9503 - classifier_output_main_acc: 0.9535 - val_loss: 0.4941 - val_classifier_output_aux_loss: 0.2699 - val_classifier_output_main_loss: 0.2242 - val_classifier_output_aux_acc: 0.9194 - val_classifier_output_main_acc: 0.9389
Epoch 26/1000
 - 21s - loss: 0.2735 - classifier_output_aux_loss: 0.1573 - classifier_output_main_loss: 0.1161 - classifier_output_aux_acc: 0.9463 - classifier_output_main_acc: 0.9628 - val_loss: 0.3827 - val_classifier_output_aux_loss: 0.2297 - val_classifier_output_main_loss: 0.1530 - val_classifier_output_aux_acc: 0.9278 - val_classifier_output_main_acc: 0.9528
Epoch 27/1000
 - 21s - loss: 0.2662 - classifier_output_aux_loss: 0.1465 - classifier_output_main_loss: 0.1197 - classifier_output_aux_acc: 0.9515 - classifier_output_main_acc: 0.9630 - val_loss: 0.3518 - val_classifier_output_aux_loss: 0.2155 - val_classifier_output_main_loss: 0.1363 - val_classifier_output_aux_acc: 0.9306 - val_classifier_output_main_acc: 0.9597
Epoch 28/1000
 - 21s - loss: 0.2550 - classifier_output_aux_loss: 0.1452 - classifier_output_main_loss: 0.1098 - classifier_output_aux_acc: 0.9534 - classifier_output_main_acc: 0.9636 - val_loss: 0.3903 - val_classifier_output_aux_loss: 0.2395 - val_classifier_output_main_loss: 0.1508 - val_classifier_output_aux_acc: 0.9306 - val_classifier_output_main_acc: 0.9611
Epoch 29/1000
 - 21s - loss: 0.2420 - classifier_output_aux_loss: 0.1286 - classifier_output_main_loss: 0.1134 - classifier_output_aux_acc: 0.9594 - classifier_output_main_acc: 0.9633 - val_loss: 0.4032 - val_classifier_output_aux_loss: 0.2516 - val_classifier_output_main_loss: 0.1515 - val_classifier_output_aux_acc: 0.9361 - val_classifier_output_main_acc: 0.9639
Epoch 30/1000
 - 21s - loss: 0.2463 - classifier_output_aux_loss: 0.1362 - classifier_output_main_loss: 0.1101 - classifier_output_aux_acc: 0.9591 - classifier_output_main_acc: 0.9648 - val_loss: 0.4152 - val_classifier_output_aux_loss: 0.1884 - val_classifier_output_main_loss: 0.2269 - val_classifier_output_aux_acc: 0.9375 - val_classifier_output_main_acc: 0.9444
Epoch 31/1000
 - 21s - loss: 0.2239 - classifier_output_aux_loss: 0.1255 - classifier_output_main_loss: 0.0984 - classifier_output_aux_acc: 0.9613 - classifier_output_main_acc: 0.9673 - val_loss: 0.3123 - val_classifier_output_aux_loss: 0.2428 - val_classifier_output_main_loss: 0.0694 - val_classifier_output_aux_acc: 0.9389 - val_classifier_output_main_acc: 0.9750
Epoch 32/1000
 - 21s - loss: 0.2164 - classifier_output_aux_loss: 0.1198 - classifier_output_main_loss: 0.0966 - classifier_output_aux_acc: 0.9613 - classifier_output_main_acc: 0.9713 - val_loss: 0.3689 - val_classifier_output_aux_loss: 0.2359 - val_classifier_output_main_loss: 0.1330 - val_classifier_output_aux_acc: 0.9319 - val_classifier_output_main_acc: 0.9611
Epoch 33/1000
 - 21s - loss: 0.2105 - classifier_output_aux_loss: 0.1133 - classifier_output_main_loss: 0.0972 - classifier_output_aux_acc: 0.9676 - classifier_output_main_acc: 0.9691 - val_loss: 0.3864 - val_classifier_output_aux_loss: 0.2519 - val_classifier_output_main_loss: 0.1345 - val_classifier_output_aux_acc: 0.9347 - val_classifier_output_main_acc: 0.9625
Epoch 34/1000
 - 21s - loss: 0.2182 - classifier_output_aux_loss: 0.1155 - classifier_output_main_loss: 0.1026 - classifier_output_aux_acc: 0.9648 - classifier_output_main_acc: 0.9705 - val_loss: 0.3851 - val_classifier_output_aux_loss: 0.2673 - val_classifier_output_main_loss: 0.1177 - val_classifier_output_aux_acc: 0.9361 - val_classifier_output_main_acc: 0.9639
Epoch 35/1000
 - 21s - loss: 0.2021 - classifier_output_aux_loss: 0.1169 - classifier_output_main_loss: 0.0852 - classifier_output_aux_acc: 0.9622 - classifier_output_main_acc: 0.9747 - val_loss: 0.3761 - val_classifier_output_aux_loss: 0.2935 - val_classifier_output_main_loss: 0.0827 - val_classifier_output_aux_acc: 0.9333 - val_classifier_output_main_acc: 0.9778
Epoch 36/1000
 - 21s - loss: 0.1931 - classifier_output_aux_loss: 0.1133 - classifier_output_main_loss: 0.0798 - classifier_output_aux_acc: 0.9651 - classifier_output_main_acc: 0.9748 - val_loss: 0.3821 - val_classifier_output_aux_loss: 0.2822 - val_classifier_output_main_loss: 0.0999 - val_classifier_output_aux_acc: 0.9403 - val_classifier_output_main_acc: 0.9750
Epoch 37/1000
 - 21s - loss: 0.1784 - classifier_output_aux_loss: 0.1016 - classifier_output_main_loss: 0.0768 - classifier_output_aux_acc: 0.9693 - classifier_output_main_acc: 0.9782 - val_loss: 0.3256 - val_classifier_output_aux_loss: 0.2116 - val_classifier_output_main_loss: 0.1140 - val_classifier_output_aux_acc: 0.9486 - val_classifier_output_main_acc: 0.9694
Epoch 38/1000
 - 22s - loss: 0.1859 - classifier_output_aux_loss: 0.1036 - classifier_output_main_loss: 0.0823 - classifier_output_aux_acc: 0.9670 - classifier_output_main_acc: 0.9765 - val_loss: 0.2983 - val_classifier_output_aux_loss: 0.1888 - val_classifier_output_main_loss: 0.1095 - val_classifier_output_aux_acc: 0.9556 - val_classifier_output_main_acc: 0.9722
Epoch 39/1000
 - 21s - loss: 0.1838 - classifier_output_aux_loss: 0.1048 - classifier_output_main_loss: 0.0790 - classifier_output_aux_acc: 0.9645 - classifier_output_main_acc: 0.9758 - val_loss: 0.2933 - val_classifier_output_aux_loss: 0.1558 - val_classifier_output_main_loss: 0.1375 - val_classifier_output_aux_acc: 0.9500 - val_classifier_output_main_acc: 0.9667
Epoch 40/1000
 - 22s - loss: 0.1745 - classifier_output_aux_loss: 0.1007 - classifier_output_main_loss: 0.0739 - classifier_output_aux_acc: 0.9696 - classifier_output_main_acc: 0.9792 - val_loss: 0.2648 - val_classifier_output_aux_loss: 0.1999 - val_classifier_output_main_loss: 0.0649 - val_classifier_output_aux_acc: 0.9403 - val_classifier_output_main_acc: 0.9806
Epoch 41/1000
 - 21s - loss: 0.1738 - classifier_output_aux_loss: 0.0915 - classifier_output_main_loss: 0.0823 - classifier_output_aux_acc: 0.9725 - classifier_output_main_acc: 0.9779 - val_loss: 0.1750 - val_classifier_output_aux_loss: 0.1102 - val_classifier_output_main_loss: 0.0648 - val_classifier_output_aux_acc: 0.9625 - val_classifier_output_main_acc: 0.9806
Epoch 42/1000
 - 22s - loss: 0.1618 - classifier_output_aux_loss: 0.0990 - classifier_output_main_loss: 0.0628 - classifier_output_aux_acc: 0.9701 - classifier_output_main_acc: 0.9809 - val_loss: 0.2381 - val_classifier_output_aux_loss: 0.1733 - val_classifier_output_main_loss: 0.0647 - val_classifier_output_aux_acc: 0.9500 - val_classifier_output_main_acc: 0.9778
Epoch 43/1000
 - 22s - loss: 0.1716 - classifier_output_aux_loss: 0.0932 - classifier_output_main_loss: 0.0785 - classifier_output_aux_acc: 0.9727 - classifier_output_main_acc: 0.9761 - val_loss: 0.1875 - val_classifier_output_aux_loss: 0.1545 - val_classifier_output_main_loss: 0.0330 - val_classifier_output_aux_acc: 0.9556 - val_classifier_output_main_acc: 0.9847
Epoch 44/1000
 - 22s - loss: 0.1581 - classifier_output_aux_loss: 0.0878 - classifier_output_main_loss: 0.0703 - classifier_output_aux_acc: 0.9725 - classifier_output_main_acc: 0.9792 - val_loss: 0.3026 - val_classifier_output_aux_loss: 0.1278 - val_classifier_output_main_loss: 0.1748 - val_classifier_output_aux_acc: 0.9653 - val_classifier_output_main_acc: 0.9611
Epoch 45/1000
 - 21s - loss: 0.1610 - classifier_output_aux_loss: 0.0807 - classifier_output_main_loss: 0.0803 - classifier_output_aux_acc: 0.9758 - classifier_output_main_acc: 0.9778 - val_loss: 0.2981 - val_classifier_output_aux_loss: 0.1938 - val_classifier_output_main_loss: 0.1043 - val_classifier_output_aux_acc: 0.9542 - val_classifier_output_main_acc: 0.9806
Epoch 46/1000
 - 21s - loss: 0.1411 - classifier_output_aux_loss: 0.0752 - classifier_output_main_loss: 0.0659 - classifier_output_aux_acc: 0.9756 - classifier_output_main_acc: 0.9804 - val_loss: 0.2863 - val_classifier_output_aux_loss: 0.1715 - val_classifier_output_main_loss: 0.1148 - val_classifier_output_aux_acc: 0.9528 - val_classifier_output_main_acc: 0.9667
Epoch 47/1000
 - 21s - loss: 0.1324 - classifier_output_aux_loss: 0.0757 - classifier_output_main_loss: 0.0567 - classifier_output_aux_acc: 0.9765 - classifier_output_main_acc: 0.9838 - val_loss: 0.2742 - val_classifier_output_aux_loss: 0.1829 - val_classifier_output_main_loss: 0.0913 - val_classifier_output_aux_acc: 0.9500 - val_classifier_output_main_acc: 0.9722
Epoch 48/1000
 - 21s - loss: 0.1590 - classifier_output_aux_loss: 0.0941 - classifier_output_main_loss: 0.0649 - classifier_output_aux_acc: 0.9725 - classifier_output_main_acc: 0.9810 - val_loss: 0.1925 - val_classifier_output_aux_loss: 0.1162 - val_classifier_output_main_loss: 0.0763 - val_classifier_output_aux_acc: 0.9667 - val_classifier_output_main_acc: 0.9778
Epoch 49/1000
 - 22s - loss: 0.1237 - classifier_output_aux_loss: 0.0706 - classifier_output_main_loss: 0.0532 - classifier_output_aux_acc: 0.9756 - classifier_output_main_acc: 0.9830 - val_loss: 0.4243 - val_classifier_output_aux_loss: 0.2472 - val_classifier_output_main_loss: 0.1771 - val_classifier_output_aux_acc: 0.9472 - val_classifier_output_main_acc: 0.9611
Epoch 50/1000
 - 21s - loss: 0.1454 - classifier_output_aux_loss: 0.0748 - classifier_output_main_loss: 0.0705 - classifier_output_aux_acc: 0.9765 - classifier_output_main_acc: 0.9809 - val_loss: 0.2342 - val_classifier_output_aux_loss: 0.1511 - val_classifier_output_main_loss: 0.0831 - val_classifier_output_aux_acc: 0.9597 - val_classifier_output_main_acc: 0.9736
Epoch 51/1000
 - 22s - loss: 0.1410 - classifier_output_aux_loss: 0.0741 - classifier_output_main_loss: 0.0669 - classifier_output_aux_acc: 0.9779 - classifier_output_main_acc: 0.9826 - val_loss: 0.1983 - val_classifier_output_aux_loss: 0.1586 - val_classifier_output_main_loss: 0.0397 - val_classifier_output_aux_acc: 0.9625 - val_classifier_output_main_acc: 0.9847
time_consuming: 4.489999999999782 1800 0.002494444444444323
cm_aux: [[214  52   1   1   9  23]
 [ 13 221  13   1  46   6]
 [  7  10 264   2  16   1]
 [  0   5  30 238   2  25]
 [ 16  28   7   0 235  14]
 [  7  18   3   0  50 222]]
cm_main: [[252   2  15   6  10  15]
 [  4 271   3   8   5   9]
 [  2   1 286   9   2   0]
 [  0   3  33 260   3   1]
 [  8  15   1   3 265   8]
 [ 12  10   1   0   5 272]]
normalized cm_main: [[0.84       0.00666667 0.05       0.02       0.03333333 0.05      ]
 [0.01333333 0.90333333 0.01       0.02666667 0.01666667 0.03      ]
 [0.00666667 0.00333333 0.95333333 0.03       0.00666667 0.        ]
 [0.         0.01       0.11       0.86666667 0.01       0.00333333]
 [0.02666667 0.05       0.00333333 0.01       0.88333333 0.02666667]
 [0.04       0.03333333 0.00333333 0.         0.01666667 0.90666667]]
metrics: ['loss', 'classifier_output_aux_loss', 'classifier_output_main_loss', 'classifier_output_aux_acc', 'classifier_output_main_acc']
Test score: [2.0738163340422844, 1.4106949453552564, 0.6631213896957686, 0.7744444444444445, 0.8922222222222222]
Test loss: 1.4106949453552564
Test accuracy of aux: 0.7744444444444445
Test accuracy of main: 0.8922222222222222
Saving model to disk 

__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
main_input_1 (InputLayer)       (None, 29, 6, 20, 3) 0                                            
__________________________________________________________________________________________________
main_input_2 (InputLayer)       (None, 29, 6, 20, 3) 0                                            
__________________________________________________________________________________________________
feature_output_aux (TimeDistrib (None, 29, 64)       78400       main_input_1[0][0]               
__________________________________________________________________________________________________
feature_output_main (TimeDistri (None, 29, 64)       78400       main_input_2[0][0]               
__________________________________________________________________________________________________
gru_3 (GRU)                     (None, 128)          74112       feature_output_aux[0][0]         
__________________________________________________________________________________________________
gru_4 (GRU)                     (None, 128)          74112       feature_output_main[0][0]        
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 128)          0           gru_3[0][0]                      
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 128)          0           gru_4[0][0]                      
__________________________________________________________________________________________________
gradient_reversal_3 (GradientRe (None, 128)          0           dropout_10[0][0]                 
__________________________________________________________________________________________________
gradient_reversal_4 (GradientRe (None, 128)          0           dropout_8[0][0]                  
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 256)          0           dropout_8[0][0]                  
                                                                 gradient_reversal_3[0][0]        
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 256)          0           dropout_10[0][0]                 
                                                                 gradient_reversal_4[0][0]        
__________________________________________________________________________________________________
dense_11 (Dense)                (None, 128)          32896       concatenate_3[0][0]              
__________________________________________________________________________________________________
dense_12 (Dense)                (None, 128)          32896       concatenate_4[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 128)          0           dense_11[0][0]                   
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 128)          0           dense_12[0][0]                   
__________________________________________________________________________________________________
classifier_output_aux (Dense)   (None, 6)            774         dropout_11[0][0]                 
__________________________________________________________________________________________________
classifier_output_main (Dense)  (None, 6)            774         dropout_12[0][0]                 
==================================================================================================
Total params: 372,364
Trainable params: 372,364
Non-trainable params: 0
__________________________________________________________________________________________________
None
Loading Data...
domain_type: 2
Loaded Data wf_tally_slice 2 (7200, 29, 6, 20, 3) 4 (7200, 6) 2 (1800, 29, 6, 20, 3)
n_timesteps: 29
Train on 6480 samples, validate on 720 samples
Epoch 1/1000
 - 40s - loss: 3.2307 - classifier_output_aux_loss: 1.5933 - classifier_output_main_loss: 1.6374 - classifier_output_aux_acc: 0.3174 - classifier_output_main_acc: 0.2861 - val_loss: 2.8224 - val_classifier_output_aux_loss: 1.3936 - val_classifier_output_main_loss: 1.4288 - val_classifier_output_aux_acc: 0.4375 - val_classifier_output_main_acc: 0.4278
Epoch 2/1000
 - 36s - loss: 2.6861 - classifier_output_aux_loss: 1.3660 - classifier_output_main_loss: 1.3201 - classifier_output_aux_acc: 0.4569 - classifier_output_main_acc: 0.4779 - val_loss: 2.2809 - val_classifier_output_aux_loss: 1.1603 - val_classifier_output_main_loss: 1.1205 - val_classifier_output_aux_acc: 0.5472 - val_classifier_output_main_acc: 0.5292
Epoch 3/1000
 - 36s - loss: 2.3028 - classifier_output_aux_loss: 1.1680 - classifier_output_main_loss: 1.1348 - classifier_output_aux_acc: 0.5508 - classifier_output_main_acc: 0.5605 - val_loss: 2.0511 - val_classifier_output_aux_loss: 0.9992 - val_classifier_output_main_loss: 1.0519 - val_classifier_output_aux_acc: 0.6083 - val_classifier_output_main_acc: 0.5861
Epoch 4/1000
 - 36s - loss: 1.9794 - classifier_output_aux_loss: 1.0191 - classifier_output_main_loss: 0.9603 - classifier_output_aux_acc: 0.6096 - classifier_output_main_acc: 0.6293 - val_loss: 1.8313 - val_classifier_output_aux_loss: 0.9808 - val_classifier_output_main_loss: 0.8505 - val_classifier_output_aux_acc: 0.6167 - val_classifier_output_main_acc: 0.6764
Epoch 5/1000
 - 37s - loss: 1.7152 - classifier_output_aux_loss: 0.8971 - classifier_output_main_loss: 0.8182 - classifier_output_aux_acc: 0.6583 - classifier_output_main_acc: 0.7009 - val_loss: 1.4816 - val_classifier_output_aux_loss: 0.7606 - val_classifier_output_main_loss: 0.7210 - val_classifier_output_aux_acc: 0.7111 - val_classifier_output_main_acc: 0.7278
Epoch 6/1000
 - 37s - loss: 1.4714 - classifier_output_aux_loss: 0.7888 - classifier_output_main_loss: 0.6825 - classifier_output_aux_acc: 0.7160 - classifier_output_main_acc: 0.7562 - val_loss: 1.4662 - val_classifier_output_aux_loss: 0.8820 - val_classifier_output_main_loss: 0.5842 - val_classifier_output_aux_acc: 0.6833 - val_classifier_output_main_acc: 0.8000
Epoch 7/1000
 - 37s - loss: 1.2517 - classifier_output_aux_loss: 0.6839 - classifier_output_main_loss: 0.5678 - classifier_output_aux_acc: 0.7551 - classifier_output_main_acc: 0.8035 - val_loss: 1.1481 - val_classifier_output_aux_loss: 0.5538 - val_classifier_output_main_loss: 0.5943 - val_classifier_output_aux_acc: 0.7833 - val_classifier_output_main_acc: 0.7861
Epoch 8/1000
 - 36s - loss: 1.1069 - classifier_output_aux_loss: 0.5990 - classifier_output_main_loss: 0.5079 - classifier_output_aux_acc: 0.7793 - classifier_output_main_acc: 0.8279 - val_loss: 1.1067 - val_classifier_output_aux_loss: 0.4727 - val_classifier_output_main_loss: 0.6339 - val_classifier_output_aux_acc: 0.8194 - val_classifier_output_main_acc: 0.7889
Epoch 9/1000
 - 36s - loss: 0.9859 - classifier_output_aux_loss: 0.5540 - classifier_output_main_loss: 0.4319 - classifier_output_aux_acc: 0.8017 - classifier_output_main_acc: 0.8522 - val_loss: 1.1847 - val_classifier_output_aux_loss: 0.6783 - val_classifier_output_main_loss: 0.5064 - val_classifier_output_aux_acc: 0.7625 - val_classifier_output_main_acc: 0.8458
Epoch 10/1000
 - 38s - loss: 0.8603 - classifier_output_aux_loss: 0.4773 - classifier_output_main_loss: 0.3829 - classifier_output_aux_acc: 0.8327 - classifier_output_main_acc: 0.8687 - val_loss: 0.9134 - val_classifier_output_aux_loss: 0.5674 - val_classifier_output_main_loss: 0.3460 - val_classifier_output_aux_acc: 0.8042 - val_classifier_output_main_acc: 0.8792
Epoch 11/1000
 - 39s - loss: 0.7712 - classifier_output_aux_loss: 0.4245 - classifier_output_main_loss: 0.3467 - classifier_output_aux_acc: 0.8502 - classifier_output_main_acc: 0.8829 - val_loss: 0.6927 - val_classifier_output_aux_loss: 0.3447 - val_classifier_output_main_loss: 0.3480 - val_classifier_output_aux_acc: 0.8694 - val_classifier_output_main_acc: 0.8819
Epoch 12/1000
 - 39s - loss: 0.6806 - classifier_output_aux_loss: 0.3754 - classifier_output_main_loss: 0.3053 - classifier_output_aux_acc: 0.8705 - classifier_output_main_acc: 0.8974 - val_loss: 0.6909 - val_classifier_output_aux_loss: 0.3912 - val_classifier_output_main_loss: 0.2996 - val_classifier_output_aux_acc: 0.8611 - val_classifier_output_main_acc: 0.8931
Epoch 13/1000
 - 36s - loss: 0.6216 - classifier_output_aux_loss: 0.3483 - classifier_output_main_loss: 0.2733 - classifier_output_aux_acc: 0.8793 - classifier_output_main_acc: 0.9066 - val_loss: 0.6926 - val_classifier_output_aux_loss: 0.2993 - val_classifier_output_main_loss: 0.3933 - val_classifier_output_aux_acc: 0.8972 - val_classifier_output_main_acc: 0.8903
Epoch 14/1000
 - 39s - loss: 0.5688 - classifier_output_aux_loss: 0.3200 - classifier_output_main_loss: 0.2488 - classifier_output_aux_acc: 0.8900 - classifier_output_main_acc: 0.9184 - val_loss: 0.5555 - val_classifier_output_aux_loss: 0.3661 - val_classifier_output_main_loss: 0.1894 - val_classifier_output_aux_acc: 0.8653 - val_classifier_output_main_acc: 0.9292
Epoch 15/1000
 - 40s - loss: 0.5281 - classifier_output_aux_loss: 0.3019 - classifier_output_main_loss: 0.2262 - classifier_output_aux_acc: 0.8980 - classifier_output_main_acc: 0.9221 - val_loss: 0.6608 - val_classifier_output_aux_loss: 0.4167 - val_classifier_output_main_loss: 0.2441 - val_classifier_output_aux_acc: 0.8639 - val_classifier_output_main_acc: 0.9167
Epoch 16/1000
 - 36s - loss: 0.4790 - classifier_output_aux_loss: 0.2667 - classifier_output_main_loss: 0.2123 - classifier_output_aux_acc: 0.9127 - classifier_output_main_acc: 0.9289 - val_loss: 0.5198 - val_classifier_output_aux_loss: 0.2784 - val_classifier_output_main_loss: 0.2415 - val_classifier_output_aux_acc: 0.8972 - val_classifier_output_main_acc: 0.9264
Epoch 17/1000
 - 39s - loss: 0.4325 - classifier_output_aux_loss: 0.2424 - classifier_output_main_loss: 0.1901 - classifier_output_aux_acc: 0.9150 - classifier_output_main_acc: 0.9375 - val_loss: 0.4449 - val_classifier_output_aux_loss: 0.2942 - val_classifier_output_main_loss: 0.1507 - val_classifier_output_aux_acc: 0.9111 - val_classifier_output_main_acc: 0.9569
Epoch 18/1000
 - 39s - loss: 0.4062 - classifier_output_aux_loss: 0.2254 - classifier_output_main_loss: 0.1809 - classifier_output_aux_acc: 0.9239 - classifier_output_main_acc: 0.9384 - val_loss: 0.3281 - val_classifier_output_aux_loss: 0.1771 - val_classifier_output_main_loss: 0.1511 - val_classifier_output_aux_acc: 0.9347 - val_classifier_output_main_acc: 0.9569
Epoch 19/1000
 - 36s - loss: 0.3617 - classifier_output_aux_loss: 0.2096 - classifier_output_main_loss: 0.1521 - classifier_output_aux_acc: 0.9309 - classifier_output_main_acc: 0.9489 - val_loss: 0.5848 - val_classifier_output_aux_loss: 0.3836 - val_classifier_output_main_loss: 0.2012 - val_classifier_output_aux_acc: 0.8806 - val_classifier_output_main_acc: 0.9389
Epoch 20/1000
 - 34s - loss: 0.3358 - classifier_output_aux_loss: 0.1918 - classifier_output_main_loss: 0.1440 - classifier_output_aux_acc: 0.9364 - classifier_output_main_acc: 0.9537 - val_loss: 0.4094 - val_classifier_output_aux_loss: 0.2592 - val_classifier_output_main_loss: 0.1502 - val_classifier_output_aux_acc: 0.9222 - val_classifier_output_main_acc: 0.9542
Epoch 21/1000
 - 34s - loss: 0.3270 - classifier_output_aux_loss: 0.1832 - classifier_output_main_loss: 0.1439 - classifier_output_aux_acc: 0.9381 - classifier_output_main_acc: 0.9534 - val_loss: 0.3902 - val_classifier_output_aux_loss: 0.1861 - val_classifier_output_main_loss: 0.2042 - val_classifier_output_aux_acc: 0.9361 - val_classifier_output_main_acc: 0.9403
Epoch 22/1000
 - 34s - loss: 0.2999 - classifier_output_aux_loss: 0.1690 - classifier_output_main_loss: 0.1309 - classifier_output_aux_acc: 0.9437 - classifier_output_main_acc: 0.9568 - val_loss: 0.2854 - val_classifier_output_aux_loss: 0.1634 - val_classifier_output_main_loss: 0.1220 - val_classifier_output_aux_acc: 0.9375 - val_classifier_output_main_acc: 0.9681
Epoch 23/1000
 - 33s - loss: 0.2686 - classifier_output_aux_loss: 0.1499 - classifier_output_main_loss: 0.1187 - classifier_output_aux_acc: 0.9514 - classifier_output_main_acc: 0.9623 - val_loss: 0.3570 - val_classifier_output_aux_loss: 0.2167 - val_classifier_output_main_loss: 0.1403 - val_classifier_output_aux_acc: 0.9319 - val_classifier_output_main_acc: 0.9639
Epoch 24/1000
 - 34s - loss: 0.2642 - classifier_output_aux_loss: 0.1584 - classifier_output_main_loss: 0.1058 - classifier_output_aux_acc: 0.9486 - classifier_output_main_acc: 0.9665 - val_loss: 0.4785 - val_classifier_output_aux_loss: 0.2707 - val_classifier_output_main_loss: 0.2078 - val_classifier_output_aux_acc: 0.9250 - val_classifier_output_main_acc: 0.9542
Epoch 25/1000
 - 35s - loss: 0.2686 - classifier_output_aux_loss: 0.1561 - classifier_output_main_loss: 0.1125 - classifier_output_aux_acc: 0.9475 - classifier_output_main_acc: 0.9668 - val_loss: 0.3966 - val_classifier_output_aux_loss: 0.2596 - val_classifier_output_main_loss: 0.1370 - val_classifier_output_aux_acc: 0.9236 - val_classifier_output_main_acc: 0.9611
Epoch 26/1000
 - 34s - loss: 0.2572 - classifier_output_aux_loss: 0.1348 - classifier_output_main_loss: 0.1224 - classifier_output_aux_acc: 0.9559 - classifier_output_main_acc: 0.9622 - val_loss: 0.3499 - val_classifier_output_aux_loss: 0.1848 - val_classifier_output_main_loss: 0.1650 - val_classifier_output_aux_acc: 0.9500 - val_classifier_output_main_acc: 0.9611
Epoch 27/1000
 - 34s - loss: 0.2265 - classifier_output_aux_loss: 0.1337 - classifier_output_main_loss: 0.0928 - classifier_output_aux_acc: 0.9576 - classifier_output_main_acc: 0.9708 - val_loss: 0.4781 - val_classifier_output_aux_loss: 0.1451 - val_classifier_output_main_loss: 0.3330 - val_classifier_output_aux_acc: 0.9486 - val_classifier_output_main_acc: 0.9139
Epoch 28/1000
 - 35s - loss: 0.2389 - classifier_output_aux_loss: 0.1363 - classifier_output_main_loss: 0.1025 - classifier_output_aux_acc: 0.9591 - classifier_output_main_acc: 0.9685 - val_loss: 0.3209 - val_classifier_output_aux_loss: 0.2109 - val_classifier_output_main_loss: 0.1100 - val_classifier_output_aux_acc: 0.9333 - val_classifier_output_main_acc: 0.9694
Epoch 29/1000
 - 34s - loss: 0.2141 - classifier_output_aux_loss: 0.1302 - classifier_output_main_loss: 0.0839 - classifier_output_aux_acc: 0.9623 - classifier_output_main_acc: 0.9739 - val_loss: 0.2822 - val_classifier_output_aux_loss: 0.1485 - val_classifier_output_main_loss: 0.1337 - val_classifier_output_aux_acc: 0.9569 - val_classifier_output_main_acc: 0.9681
Epoch 30/1000
 - 34s - loss: 0.2149 - classifier_output_aux_loss: 0.1262 - classifier_output_main_loss: 0.0888 - classifier_output_aux_acc: 0.9606 - classifier_output_main_acc: 0.9738 - val_loss: 0.3011 - val_classifier_output_aux_loss: 0.1392 - val_classifier_output_main_loss: 0.1619 - val_classifier_output_aux_acc: 0.9500 - val_classifier_output_main_acc: 0.9694
Epoch 31/1000
 - 34s - loss: 0.2028 - classifier_output_aux_loss: 0.1105 - classifier_output_main_loss: 0.0923 - classifier_output_aux_acc: 0.9631 - classifier_output_main_acc: 0.9728 - val_loss: 0.3424 - val_classifier_output_aux_loss: 0.1972 - val_classifier_output_main_loss: 0.1451 - val_classifier_output_aux_acc: 0.9458 - val_classifier_output_main_acc: 0.9611
Epoch 32/1000
 - 34s - loss: 0.1994 - classifier_output_aux_loss: 0.1221 - classifier_output_main_loss: 0.0773 - classifier_output_aux_acc: 0.9653 - classifier_output_main_acc: 0.9762 - val_loss: 0.4150 - val_classifier_output_aux_loss: 0.1866 - val_classifier_output_main_loss: 0.2284 - val_classifier_output_aux_acc: 0.9486 - val_classifier_output_main_acc: 0.9556
Epoch 33/1000
 - 34s - loss: 0.1780 - classifier_output_aux_loss: 0.1077 - classifier_output_main_loss: 0.0703 - classifier_output_aux_acc: 0.9651 - classifier_output_main_acc: 0.9772 - val_loss: 0.6124 - val_classifier_output_aux_loss: 0.3159 - val_classifier_output_main_loss: 0.2965 - val_classifier_output_aux_acc: 0.9125 - val_classifier_output_main_acc: 0.9319
Epoch 34/1000
 - 35s - loss: 0.1847 - classifier_output_aux_loss: 0.1076 - classifier_output_main_loss: 0.0770 - classifier_output_aux_acc: 0.9677 - classifier_output_main_acc: 0.9765 - val_loss: 0.3512 - val_classifier_output_aux_loss: 0.1520 - val_classifier_output_main_loss: 0.1992 - val_classifier_output_aux_acc: 0.9583 - val_classifier_output_main_acc: 0.9625
Epoch 35/1000
 - 34s - loss: 0.1700 - classifier_output_aux_loss: 0.1047 - classifier_output_main_loss: 0.0653 - classifier_output_aux_acc: 0.9668 - classifier_output_main_acc: 0.9801 - val_loss: 0.3980 - val_classifier_output_aux_loss: 0.2213 - val_classifier_output_main_loss: 0.1767 - val_classifier_output_aux_acc: 0.9542 - val_classifier_output_main_acc: 0.9653
Epoch 36/1000
 - 34s - loss: 0.1693 - classifier_output_aux_loss: 0.0975 - classifier_output_main_loss: 0.0718 - classifier_output_aux_acc: 0.9721 - classifier_output_main_acc: 0.9784 - val_loss: 0.3380 - val_classifier_output_aux_loss: 0.1334 - val_classifier_output_main_loss: 0.2046 - val_classifier_output_aux_acc: 0.9611 - val_classifier_output_main_acc: 0.9681
Epoch 37/1000
 - 35s - loss: 0.1660 - classifier_output_aux_loss: 0.0969 - classifier_output_main_loss: 0.0691 - classifier_output_aux_acc: 0.9702 - classifier_output_main_acc: 0.9813 - val_loss: 0.3061 - val_classifier_output_aux_loss: 0.1326 - val_classifier_output_main_loss: 0.1735 - val_classifier_output_aux_acc: 0.9653 - val_classifier_output_main_acc: 0.9653
Epoch 38/1000
 - 34s - loss: 0.1596 - classifier_output_aux_loss: 0.0917 - classifier_output_main_loss: 0.0679 - classifier_output_aux_acc: 0.9721 - classifier_output_main_acc: 0.9784 - val_loss: 0.3241 - val_classifier_output_aux_loss: 0.2044 - val_classifier_output_main_loss: 0.1197 - val_classifier_output_aux_acc: 0.9500 - val_classifier_output_main_acc: 0.9764
Epoch 39/1000
 - 34s - loss: 0.1606 - classifier_output_aux_loss: 0.0917 - classifier_output_main_loss: 0.0689 - classifier_output_aux_acc: 0.9710 - classifier_output_main_acc: 0.9812 - val_loss: 0.4282 - val_classifier_output_aux_loss: 0.2478 - val_classifier_output_main_loss: 0.1804 - val_classifier_output_aux_acc: 0.9375 - val_classifier_output_main_acc: 0.9611
time_consuming: 4.270000000000437 1800 0.0023722222222224646
cm_aux: [[173  12   7   1  62  45]
 [  2 123  10   1 130  34]
 [  7   2 178  41  49  23]
 [  0   3   3 261   6  27]
 [  1   7   1   0 274  17]
 [  4   0   2   0  68 226]]
cm_main: [[253   9  18   3  10   7]
 [  1 265   2   3  12  17]
 [  1   2 289   4   2   2]
 [  0   2  43 240   7   8]
 [ 10  13   0   1 263  13]
 [ 16   2   4   0   4 274]]
normalized cm_main: [[0.84333333 0.03       0.06       0.01       0.03333333 0.02333333]
 [0.00333333 0.88333333 0.00666667 0.01       0.04       0.05666667]
 [0.00333333 0.00666667 0.96333333 0.01333333 0.00666667 0.00666667]
 [0.         0.00666667 0.14333333 0.8        0.02333333 0.02666667]
 [0.03333333 0.04333333 0.         0.00333333 0.87666667 0.04333333]
 [0.05333333 0.00666667 0.01333333 0.         0.01333333 0.91333333]]
metrics: ['loss', 'classifier_output_aux_loss', 'classifier_output_main_loss', 'classifier_output_aux_acc', 'classifier_output_main_acc']
Test score: [2.4981938531663683, 1.733615997367435, 0.764577874593709, 0.6861111111111111, 0.88]
Test loss: 1.733615997367435
Test accuracy of aux: 0.6861111111111111
Test accuracy of main: 0.88
Saving model to disk 

__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
main_input_1 (InputLayer)       (None, 29, 6, 20, 3) 0                                            
__________________________________________________________________________________________________
main_input_2 (InputLayer)       (None, 29, 6, 20, 3) 0                                            
__________________________________________________________________________________________________
feature_output_aux (TimeDistrib (None, 29, 64)       78400       main_input_1[0][0]               
__________________________________________________________________________________________________
feature_output_main (TimeDistri (None, 29, 64)       78400       main_input_2[0][0]               
__________________________________________________________________________________________________
gru_5 (GRU)                     (None, 128)          74112       feature_output_aux[0][0]         
__________________________________________________________________________________________________
gru_6 (GRU)                     (None, 128)          74112       feature_output_main[0][0]        
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 128)          0           gru_5[0][0]                      
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 128)          0           gru_6[0][0]                      
__________________________________________________________________________________________________
gradient_reversal_5 (GradientRe (None, 128)          0           dropout_16[0][0]                 
__________________________________________________________________________________________________
gradient_reversal_6 (GradientRe (None, 128)          0           dropout_14[0][0]                 
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 256)          0           dropout_14[0][0]                 
                                                                 gradient_reversal_5[0][0]        
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 256)          0           dropout_16[0][0]                 
                                                                 gradient_reversal_6[0][0]        
__________________________________________________________________________________________________
dense_17 (Dense)                (None, 128)          32896       concatenate_5[0][0]              
__________________________________________________________________________________________________
dense_18 (Dense)                (None, 128)          32896       concatenate_6[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 128)          0           dense_17[0][0]                   
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 128)          0           dense_18[0][0]                   
__________________________________________________________________________________________________
classifier_output_aux (Dense)   (None, 6)            774         dropout_17[0][0]                 
__________________________________________________________________________________________________
classifier_output_main (Dense)  (None, 6)            774         dropout_18[0][0]                 
==================================================================================================
Total params: 372,364
Trainable params: 372,364
Non-trainable params: 0
__________________________________________________________________________________________________
None