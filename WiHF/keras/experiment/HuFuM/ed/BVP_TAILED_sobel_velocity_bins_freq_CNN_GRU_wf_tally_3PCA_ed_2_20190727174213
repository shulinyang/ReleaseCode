argsï¼š Namespace(datasource='wf_tally', domaintype=0, envdomain=2, gesturelist=[1, 2, 3, 4, 5, 6], gpuloadratio=0.15, gradientreversalrate=0.0, instancelist=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10], matlabname=['velocity_bins_freq'], mode='train', nettype='CNN_GRU_wf_tally', numberofpath=5, orientationdomain=4, pathtype='BVP_TAILED_sobel', patience=30, pcalist=[0, 1, 2], positiondomain=4, receiverlist=[0, 1, 2, 3, 4, 5], serverset='remote', sizeoffeature=64, targettype=1, timelimit=29, traintestratio=0.8, userlist=[1, 2, 3, 4, 5, 6, 7, 8], yaxislength=20)
ed:  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] pd:  [1, 2, 3, 4, 5] od:  [1, 2, 3, 4, 5]
Loading Data...
domain_type: 0
Loaded Data wf_tally 1 (5998, 29, 6, 20, 3) 4 (5998, 10) 1 (1500, 29, 6, 20, 3)
n_timesteps: 29
Train on 5398 samples, validate on 600 samples
Epoch 1/1000
 - 16s - loss: 1.5898 - acc: 0.2771 - val_loss: 1.4529 - val_acc: 0.2618
Epoch 2/1000
 - 15s - loss: 1.3535 - acc: 0.4089 - val_loss: 1.2302 - val_acc: 0.4091
Epoch 3/1000
 - 15s - loss: 1.1239 - acc: 0.5416 - val_loss: 1.0669 - val_acc: 0.4964
Epoch 4/1000
 - 15s - loss: 0.9878 - acc: 0.6083 - val_loss: 1.0269 - val_acc: 0.5527
Epoch 5/1000
 - 15s - loss: 0.8561 - acc: 0.6752 - val_loss: 0.9766 - val_acc: 0.5945
Epoch 6/1000
 - 15s - loss: 0.7810 - acc: 0.7072 - val_loss: 0.9244 - val_acc: 0.6200
Epoch 7/1000
 - 15s - loss: 0.6762 - acc: 0.7546 - val_loss: 0.8334 - val_acc: 0.6636
Epoch 8/1000
 - 15s - loss: 0.5938 - acc: 0.7846 - val_loss: 0.6722 - val_acc: 0.7509
Epoch 9/1000
 - 15s - loss: 0.5224 - acc: 0.8114 - val_loss: 0.5388 - val_acc: 0.8236
Epoch 10/1000
 - 15s - loss: 0.4677 - acc: 0.8304 - val_loss: 0.7352 - val_acc: 0.7382
Epoch 11/1000
 - 15s - loss: 0.4024 - acc: 0.8567 - val_loss: 0.5199 - val_acc: 0.8309
Epoch 12/1000
 - 15s - loss: 0.3441 - acc: 0.8779 - val_loss: 0.5219 - val_acc: 0.8127
Epoch 13/1000
 - 15s - loss: 0.3026 - acc: 0.8941 - val_loss: 0.5909 - val_acc: 0.8145
Epoch 14/1000
 - 15s - loss: 0.2737 - acc: 0.9026 - val_loss: 0.5041 - val_acc: 0.8255
Epoch 15/1000
 - 15s - loss: 0.2485 - acc: 0.9103 - val_loss: 0.4581 - val_acc: 0.8509
Epoch 16/1000
 - 15s - loss: 0.2244 - acc: 0.9214 - val_loss: 0.3174 - val_acc: 0.9018
Epoch 17/1000
 - 15s - loss: 0.2110 - acc: 0.9258 - val_loss: 0.4485 - val_acc: 0.8564
Epoch 18/1000
 - 15s - loss: 0.1762 - acc: 0.9369 - val_loss: 0.3021 - val_acc: 0.9145
Epoch 19/1000
 - 15s - loss: 0.1693 - acc: 0.9382 - val_loss: 0.2944 - val_acc: 0.9145
Epoch 20/1000
 - 15s - loss: 0.1411 - acc: 0.9507 - val_loss: 0.3686 - val_acc: 0.8945
Epoch 21/1000
 - 15s - loss: 0.1327 - acc: 0.9515 - val_loss: 0.4466 - val_acc: 0.8836
Epoch 22/1000
 - 15s - loss: 0.1190 - acc: 0.9561 - val_loss: 0.3421 - val_acc: 0.9182
Epoch 23/1000
 - 15s - loss: 0.1095 - acc: 0.9606 - val_loss: 0.3601 - val_acc: 0.9073
Epoch 24/1000
 - 15s - loss: 0.1055 - acc: 0.9638 - val_loss: 0.3786 - val_acc: 0.9091
Epoch 25/1000
 - 15s - loss: 0.1039 - acc: 0.9594 - val_loss: 0.3166 - val_acc: 0.9255
Epoch 26/1000
 - 13s - loss: 0.1059 - acc: 0.9644 - val_loss: 0.2778 - val_acc: 0.9291
Epoch 27/1000
 - 13s - loss: 0.0781 - acc: 0.9743 - val_loss: 0.3740 - val_acc: 0.9127
Epoch 28/1000
 - 13s - loss: 0.0819 - acc: 0.9719 - val_loss: 0.3357 - val_acc: 0.9109
Epoch 29/1000
 - 13s - loss: 0.0742 - acc: 0.9737 - val_loss: 0.3404 - val_acc: 0.9127
Epoch 30/1000
 - 15s - loss: 0.0636 - acc: 0.9784 - val_loss: 0.2671 - val_acc: 0.9364
Epoch 31/1000
 - 15s - loss: 0.0626 - acc: 0.9786 - val_loss: 0.2986 - val_acc: 0.9309
Epoch 32/1000
 - 15s - loss: 0.0692 - acc: 0.9762 - val_loss: 0.3553 - val_acc: 0.9218
Epoch 33/1000
 - 15s - loss: 0.0548 - acc: 0.9808 - val_loss: 0.2879 - val_acc: 0.9309
Epoch 34/1000
 - 15s - loss: 0.0532 - acc: 0.9822 - val_loss: 0.4413 - val_acc: 0.9091
Epoch 35/1000
 - 15s - loss: 0.0577 - acc: 0.9792 - val_loss: 0.2997 - val_acc: 0.9345
Epoch 36/1000
 - 15s - loss: 0.0496 - acc: 0.9812 - val_loss: 0.3554 - val_acc: 0.9255
Epoch 37/1000
 - 15s - loss: 0.0569 - acc: 0.9810 - val_loss: 0.4042 - val_acc: 0.9055
Epoch 38/1000
 - 15s - loss: 0.0479 - acc: 0.9850 - val_loss: 0.5454 - val_acc: 0.8782
Epoch 39/1000
 - 15s - loss: 0.0523 - acc: 0.9820 - val_loss: 0.2711 - val_acc: 0.9455
Epoch 40/1000
 - 15s - loss: 0.0475 - acc: 0.9857 - val_loss: 0.2852 - val_acc: 0.9400
Epoch 41/1000
 - 15s - loss: 0.0427 - acc: 0.9848 - val_loss: 0.3613 - val_acc: 0.9164
Epoch 42/1000
 - 15s - loss: 0.0367 - acc: 0.9871 - val_loss: 0.4068 - val_acc: 0.9127
Epoch 43/1000
 - 15s - loss: 0.0430 - acc: 0.9873 - val_loss: 0.3118 - val_acc: 0.9291
Epoch 44/1000
 - 15s - loss: 0.0388 - acc: 0.9879 - val_loss: 0.3832 - val_acc: 0.9145
Epoch 45/1000
 - 15s - loss: 0.0360 - acc: 0.9889 - val_loss: 0.3784 - val_acc: 0.9273
Epoch 46/1000
 - 15s - loss: 0.0374 - acc: 0.9877 - val_loss: 0.3787 - val_acc: 0.9200
Epoch 47/1000
 - 15s - loss: 0.0357 - acc: 0.9887 - val_loss: 0.3974 - val_acc: 0.9182
Epoch 48/1000
 - 15s - loss: 0.0367 - acc: 0.9867 - val_loss: 0.4096 - val_acc: 0.9109
Epoch 49/1000
 - 15s - loss: 0.0466 - acc: 0.9857 - val_loss: 0.3768 - val_acc: 0.9291
Epoch 50/1000
 - 15s - loss: 0.0361 - acc: 0.9881 - val_loss: 0.3195 - val_acc: 0.9255
Epoch 51/1000
 - 15s - loss: 0.0295 - acc: 0.9897 - val_loss: 0.3754 - val_acc: 0.9273
Epoch 52/1000
 - 15s - loss: 0.0337 - acc: 0.9889 - val_loss: 0.3979 - val_acc: 0.9200
Epoch 53/1000
 - 15s - loss: 0.0283 - acc: 0.9899 - val_loss: 0.3207 - val_acc: 0.9255
Epoch 54/1000
 - 14s - loss: 0.0298 - acc: 0.9895 - val_loss: 0.2786 - val_acc: 0.9436
Epoch 55/1000
 - 12s - loss: 0.0352 - acc: 0.9877 - val_loss: 0.4393 - val_acc: 0.9055
Epoch 56/1000
 - 12s - loss: 0.0170 - acc: 0.9937 - val_loss: 0.4162 - val_acc: 0.9255
Epoch 57/1000
 - 13s - loss: 0.0403 - acc: 0.9897 - val_loss: 0.3503 - val_acc: 0.9309
Epoch 58/1000
 - 15s - loss: 0.0313 - acc: 0.9895 - val_loss: 0.3114 - val_acc: 0.9291
Epoch 59/1000
 - 15s - loss: 0.0270 - acc: 0.9901 - val_loss: 0.3974 - val_acc: 0.9218
Epoch 60/1000
 - 15s - loss: 0.0230 - acc: 0.9929 - val_loss: 0.3366 - val_acc: 0.9345
dict_keys(['val_loss', 'acc', 'loss', 'val_acc'])
[[120   6   0   0   0   0]
 [  2 246   0   0   1   1]
 [ 20  12 188  14   5  10]
 [  5   5   3 229   6   2]
 [  2   2   0   0 244   2]
 [  2   5   0   0   1 242]]
[[0.95238095 0.04761905 0.         0.         0.         0.        ]
 [0.008      0.984      0.         0.         0.004      0.004     ]
 [0.08032129 0.04819277 0.75502008 0.0562249  0.02008032 0.04016064]
 [0.02       0.02       0.012      0.916      0.024      0.008     ]
 [0.008      0.008      0.         0.         0.976      0.008     ]
 [0.008      0.02       0.         0.         0.004      0.968     ]]
metrics: ['loss', 'acc']
Test score: [0.42713640475870024, 0.9229090909090909]
Test loss: 0.42713640475870024
Test accuracy: 0.9229090909090909
Saving model to disk 

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
time_distributed_2 (TimeDist (None, 29, 64)            78400     
_________________________________________________________________
gru_output (GRU)             (None, 128)               74112     
_________________________________________________________________
dropout_4 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_6 (Dense)              (None, 6)                 774       
=================================================================
Total params: 153,286
Trainable params: 153,286
Non-trainable params: 0
_________________________________________________________________
None
Loading Data...
domain_type: 0
Loaded Data wf_tally 1 (5998, 29, 6, 20, 3) 4 (5998, 10) 1 (1500, 29, 6, 20, 3)
n_timesteps: 29
Train on 5398 samples, validate on 600 samples
Epoch 1/1000
 - 14s - loss: 1.5839 - acc: 0.2823 - val_loss: 1.3711 - val_acc: 0.3945
Epoch 2/1000
 - 12s - loss: 1.3694 - acc: 0.3965 - val_loss: 1.2608 - val_acc: 0.4764
Epoch 3/1000
 - 13s - loss: 1.1812 - acc: 0.5012 - val_loss: 1.3204 - val_acc: 0.4182
Epoch 4/1000
 - 15s - loss: 1.0063 - acc: 0.6002 - val_loss: 1.0827 - val_acc: 0.4964
Epoch 5/1000
 - 15s - loss: 0.8773 - acc: 0.6673 - val_loss: 0.9770 - val_acc: 0.5782
Epoch 6/1000
 - 15s - loss: 0.7733 - acc: 0.7059 - val_loss: 0.8216 - val_acc: 0.6655
Epoch 7/1000
 - 15s - loss: 0.7059 - acc: 0.7340 - val_loss: 0.8278 - val_acc: 0.6873
Epoch 8/1000
 - 15s - loss: 0.6304 - acc: 0.7635 - val_loss: 0.7632 - val_acc: 0.6927
Epoch 9/1000
 - 15s - loss: 0.5655 - acc: 0.7951 - val_loss: 0.7538 - val_acc: 0.7036
Epoch 10/1000
 - 15s - loss: 0.4985 - acc: 0.8226 - val_loss: 0.8709 - val_acc: 0.7055
Epoch 11/1000
 - 15s - loss: 0.4262 - acc: 0.8454 - val_loss: 0.5667 - val_acc: 0.7964
Epoch 12/1000
 - 15s - loss: 0.3861 - acc: 0.8628 - val_loss: 0.5985 - val_acc: 0.7709
Epoch 13/1000
 - 15s - loss: 0.3376 - acc: 0.8759 - val_loss: 0.3930 - val_acc: 0.8782
Epoch 14/1000
 - 15s - loss: 0.2969 - acc: 0.8949 - val_loss: 0.3360 - val_acc: 0.8964
Epoch 15/1000
 - 15s - loss: 0.2680 - acc: 0.9046 - val_loss: 0.3639 - val_acc: 0.8909
Epoch 16/1000
 - 15s - loss: 0.2432 - acc: 0.9123 - val_loss: 0.3644 - val_acc: 0.8927
Epoch 17/1000
 - 15s - loss: 0.2161 - acc: 0.9222 - val_loss: 0.3545 - val_acc: 0.8782
Epoch 18/1000
 - 15s - loss: 0.1882 - acc: 0.9333 - val_loss: 0.3290 - val_acc: 0.9036
Epoch 19/1000
 - 15s - loss: 0.1736 - acc: 0.9414 - val_loss: 0.4696 - val_acc: 0.8764
Epoch 20/1000
 - 15s - loss: 0.1571 - acc: 0.9436 - val_loss: 0.5570 - val_acc: 0.8345
Epoch 21/1000
 - 15s - loss: 0.1377 - acc: 0.9535 - val_loss: 0.3447 - val_acc: 0.9109
Epoch 22/1000
 - 15s - loss: 0.1228 - acc: 0.9586 - val_loss: 0.3488 - val_acc: 0.9091
Epoch 23/1000
 - 15s - loss: 0.1187 - acc: 0.9592 - val_loss: 0.3446 - val_acc: 0.9145
Epoch 24/1000
 - 15s - loss: 0.1079 - acc: 0.9624 - val_loss: 0.4623 - val_acc: 0.8691
Epoch 25/1000
 - 15s - loss: 0.0850 - acc: 0.9691 - val_loss: 0.4026 - val_acc: 0.9000
Epoch 26/1000
 - 15s - loss: 0.0915 - acc: 0.9689 - val_loss: 0.3092 - val_acc: 0.9164
Epoch 27/1000
 - 15s - loss: 0.0889 - acc: 0.9705 - val_loss: 0.3382 - val_acc: 0.9091
Epoch 28/1000
 - 15s - loss: 0.0737 - acc: 0.9737 - val_loss: 0.3490 - val_acc: 0.9055
Epoch 29/1000
 - 15s - loss: 0.0791 - acc: 0.9729 - val_loss: 0.3596 - val_acc: 0.9127
Epoch 30/1000
 - 15s - loss: 0.0720 - acc: 0.9739 - val_loss: 0.3854 - val_acc: 0.9091
Epoch 31/1000
 - 15s - loss: 0.0656 - acc: 0.9778 - val_loss: 0.4503 - val_acc: 0.8964
Epoch 32/1000
 - 15s - loss: 0.0657 - acc: 0.9778 - val_loss: 0.3449 - val_acc: 0.9164
Epoch 33/1000
 - 15s - loss: 0.0576 - acc: 0.9786 - val_loss: 0.3663 - val_acc: 0.9218
Epoch 34/1000
 - 15s - loss: 0.0619 - acc: 0.9802 - val_loss: 0.3653 - val_acc: 0.9200
Epoch 35/1000
 - 13s - loss: 0.0549 - acc: 0.9824 - val_loss: 0.3304 - val_acc: 0.9273
Epoch 36/1000
 - 12s - loss: 0.0547 - acc: 0.9804 - val_loss: 0.4077 - val_acc: 0.9127
Epoch 37/1000
 - 12s - loss: 0.0498 - acc: 0.9830 - val_loss: 0.5142 - val_acc: 0.8873
Epoch 38/1000
 - 13s - loss: 0.0503 - acc: 0.9838 - val_loss: 0.3698 - val_acc: 0.9109
Epoch 39/1000
 - 15s - loss: 0.0533 - acc: 0.9818 - val_loss: 0.3389 - val_acc: 0.9182
Epoch 40/1000
 - 15s - loss: 0.0500 - acc: 0.9826 - val_loss: 0.2838 - val_acc: 0.9273
Epoch 41/1000
 - 15s - loss: 0.0408 - acc: 0.9861 - val_loss: 0.4277 - val_acc: 0.9000
Epoch 42/1000
 - 15s - loss: 0.0437 - acc: 0.9848 - val_loss: 0.4039 - val_acc: 0.9200
Epoch 43/1000
 - 15s - loss: 0.0458 - acc: 0.9865 - val_loss: 0.3046 - val_acc: 0.9273
Epoch 44/1000
 - 15s - loss: 0.0387 - acc: 0.9879 - val_loss: 0.3477 - val_acc: 0.9182
Epoch 45/1000
 - 15s - loss: 0.0415 - acc: 0.9881 - val_loss: 0.4809 - val_acc: 0.8927
Epoch 46/1000
 - 15s - loss: 0.0454 - acc: 0.9834 - val_loss: 0.3661 - val_acc: 0.9255
Epoch 47/1000
 - 15s - loss: 0.0326 - acc: 0.9899 - val_loss: 0.4108 - val_acc: 0.9164
Epoch 48/1000
 - 15s - loss: 0.0415 - acc: 0.9861 - val_loss: 0.3355 - val_acc: 0.9382
Epoch 49/1000
 - 15s - loss: 0.0435 - acc: 0.9857 - val_loss: 0.3917 - val_acc: 0.9145
Epoch 50/1000
 - 15s - loss: 0.0352 - acc: 0.9895 - val_loss: 0.4217 - val_acc: 0.9000
Epoch 51/1000
 - 15s - loss: 0.0378 - acc: 0.9873 - val_loss: 0.3975 - val_acc: 0.9255
Epoch 52/1000
 - 15s - loss: 0.0344 - acc: 0.9887 - val_loss: 0.4108 - val_acc: 0.9236
Epoch 53/1000
 - 15s - loss: 0.0342 - acc: 0.9889 - val_loss: 0.3286 - val_acc: 0.9364
Epoch 54/1000
 - 15s - loss: 0.0305 - acc: 0.9903 - val_loss: 0.3344 - val_acc: 0.9273
Epoch 55/1000
 - 15s - loss: 0.0289 - acc: 0.9907 - val_loss: 0.5056 - val_acc: 0.9000
Epoch 56/1000
 - 15s - loss: 0.0285 - acc: 0.9911 - val_loss: 0.3836 - val_acc: 0.9182
Epoch 57/1000
 - 14s - loss: 0.0238 - acc: 0.9911 - val_loss: 0.3889 - val_acc: 0.9218
Epoch 58/1000
 - 12s - loss: 0.0300 - acc: 0.9911 - val_loss: 0.4516 - val_acc: 0.9018
Epoch 59/1000
 - 12s - loss: 0.0363 - acc: 0.9897 - val_loss: 0.4975 - val_acc: 0.9109
Epoch 60/1000
 - 13s - loss: 0.0335 - acc: 0.9907 - val_loss: 0.4083 - val_acc: 0.9164
Epoch 61/1000
 - 15s - loss: 0.0298 - acc: 0.9905 - val_loss: 0.3753 - val_acc: 0.9218
Epoch 62/1000
 - 13s - loss: 0.0292 - acc: 0.9921 - val_loss: 0.3617 - val_acc: 0.9291
Epoch 63/1000
 - 13s - loss: 0.0217 - acc: 0.9929 - val_loss: 0.4178 - val_acc: 0.9145
Epoch 64/1000
 - 12s - loss: 0.0275 - acc: 0.9919 - val_loss: 0.4820 - val_acc: 0.9073
Epoch 65/1000
 - 14s - loss: 0.0272 - acc: 0.9909 - val_loss: 0.4823 - val_acc: 0.9036
Epoch 66/1000
 - 15s - loss: 0.0271 - acc: 0.9931 - val_loss: 0.4189 - val_acc: 0.9327
Epoch 67/1000
 - 15s - loss: 0.0204 - acc: 0.9923 - val_loss: 0.5006 - val_acc: 0.9036
Epoch 68/1000
 - 15s - loss: 0.0306 - acc: 0.9889 - val_loss: 0.4533 - val_acc: 0.9182
Epoch 69/1000
 - 15s - loss: 0.0231 - acc: 0.9919 - val_loss: 0.4575 - val_acc: 0.9127
Epoch 70/1000
 - 15s - loss: 0.0205 - acc: 0.9947 - val_loss: 0.3401 - val_acc: 0.9327
dict_keys(['val_loss', 'acc', 'loss', 'val_acc'])
[[123   3   0   0   0   0]
 [  6 240   0   0   2   2]
 [ 25  14 190   8   4   8]
 [  5   3   5 232   4   1]
 [  0   1   0   0 247   2]
 [  2   4   0   0   1 243]]
[[0.97619048 0.02380952 0.         0.         0.         0.        ]
 [0.024      0.96       0.         0.         0.008      0.008     ]
 [0.10040161 0.0562249  0.76305221 0.03212851 0.01606426 0.03212851]
 [0.02       0.012      0.02       0.928      0.016      0.004     ]
 [0.         0.004      0.         0.         0.988      0.008     ]
 [0.008      0.016      0.         0.         0.004      0.972     ]]
metrics: ['loss', 'acc']
Test score: [0.3673138951886742, 0.9272727272727272]
Test loss: 0.3673138951886742
Test accuracy: 0.9272727272727272
Saving model to disk 

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
time_distributed_3 (TimeDist (None, 29, 64)            78400     
_________________________________________________________________
gru_output (GRU)             (None, 128)               74112     
_________________________________________________________________
dropout_6 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_9 (Dense)              (None, 6)                 774       
=================================================================
Total params: 153,286
Trainable params: 153,286
Non-trainable params: 0
_________________________________________________________________
None
Loading Data...
domain_type: 0
Loaded Data wf_tally 1 (5998, 29, 6, 20, 3) 4 (5998, 10) 1 (1500, 29, 6, 20, 3)
n_timesteps: 29
Train on 5398 samples, validate on 600 samples
Epoch 1/1000
 - 17s - loss: 1.6035 - acc: 0.2892 - val_loss: 1.3480 - val_acc: 0.3727
Epoch 2/1000
 - 15s - loss: 1.3320 - acc: 0.4184 - val_loss: 1.1778 - val_acc: 0.4582
Epoch 3/1000
 - 15s - loss: 1.1511 - acc: 0.5202 - val_loss: 1.1260 - val_acc: 0.5309
Epoch 4/1000
 - 15s - loss: 0.9869 - acc: 0.6077 - val_loss: 1.2352 - val_acc: 0.4745
Epoch 5/1000
 - 15s - loss: 0.8612 - acc: 0.6631 - val_loss: 0.8950 - val_acc: 0.6000
Epoch 6/1000
 - 15s - loss: 0.7706 - acc: 0.7017 - val_loss: 0.6896 - val_acc: 0.7036
Epoch 7/1000
 - 15s - loss: 0.6823 - acc: 0.7411 - val_loss: 0.7267 - val_acc: 0.7182
Epoch 8/1000
 - 15s - loss: 0.6079 - acc: 0.7738 - val_loss: 0.6784 - val_acc: 0.7291
Epoch 9/1000
 - 15s - loss: 0.5234 - acc: 0.8044 - val_loss: 0.5532 - val_acc: 0.7855
Epoch 10/1000
 - 15s - loss: 0.4593 - acc: 0.8331 - val_loss: 0.6207 - val_acc: 0.7727
Epoch 11/1000
 - 15s - loss: 0.4094 - acc: 0.8492 - val_loss: 0.4580 - val_acc: 0.8327
Epoch 12/1000
 - 15s - loss: 0.3749 - acc: 0.8622 - val_loss: 0.5814 - val_acc: 0.7836
Epoch 13/1000
 - 15s - loss: 0.3364 - acc: 0.8812 - val_loss: 0.4120 - val_acc: 0.8600
Epoch 14/1000
 - 15s - loss: 0.2982 - acc: 0.8953 - val_loss: 0.3796 - val_acc: 0.8618
Epoch 15/1000
 - 15s - loss: 0.2451 - acc: 0.9101 - val_loss: 0.5866 - val_acc: 0.8073
Epoch 16/1000
 - 15s - loss: 0.2300 - acc: 0.9212 - val_loss: 0.4322 - val_acc: 0.8673
Epoch 17/1000
 - 16s - loss: 0.2048 - acc: 0.9238 - val_loss: 0.3766 - val_acc: 0.8855
Epoch 18/1000
 - 15s - loss: 0.1828 - acc: 0.9380 - val_loss: 0.2960 - val_acc: 0.9073
Epoch 19/1000
 - 15s - loss: 0.1711 - acc: 0.9376 - val_loss: 0.3500 - val_acc: 0.8909
Epoch 20/1000
 - 15s - loss: 0.1626 - acc: 0.9414 - val_loss: 0.4393 - val_acc: 0.8818
Epoch 21/1000
 - 15s - loss: 0.1348 - acc: 0.9515 - val_loss: 0.3075 - val_acc: 0.9000
Epoch 22/1000
 - 15s - loss: 0.1273 - acc: 0.9541 - val_loss: 0.2815 - val_acc: 0.9182
Epoch 23/1000
 - 15s - loss: 0.1199 - acc: 0.9570 - val_loss: 0.3075 - val_acc: 0.9109
Epoch 24/1000
 - 15s - loss: 0.1074 - acc: 0.9608 - val_loss: 0.2931 - val_acc: 0.9200
Epoch 25/1000
 - 15s - loss: 0.1023 - acc: 0.9620 - val_loss: 0.2713 - val_acc: 0.9273
Epoch 26/1000
 - 15s - loss: 0.0966 - acc: 0.9656 - val_loss: 0.3632 - val_acc: 0.9036
Epoch 27/1000
 - 15s - loss: 0.0865 - acc: 0.9693 - val_loss: 0.3105 - val_acc: 0.9218
Epoch 28/1000
 - 15s - loss: 0.0793 - acc: 0.9733 - val_loss: 0.3159 - val_acc: 0.9182
Epoch 29/1000
 - 15s - loss: 0.0713 - acc: 0.9766 - val_loss: 0.3172 - val_acc: 0.9236
Epoch 30/1000
 - 15s - loss: 0.0734 - acc: 0.9737 - val_loss: 0.5967 - val_acc: 0.8527
Epoch 31/1000
 - 15s - loss: 0.0662 - acc: 0.9766 - val_loss: 0.2682 - val_acc: 0.9364
Epoch 32/1000
 - 15s - loss: 0.0763 - acc: 0.9743 - val_loss: 0.3207 - val_acc: 0.9200
Epoch 33/1000
 - 15s - loss: 0.0659 - acc: 0.9780 - val_loss: 0.4213 - val_acc: 0.9109
Epoch 34/1000
 - 15s - loss: 0.0648 - acc: 0.9776 - val_loss: 0.2972 - val_acc: 0.9309
Epoch 35/1000
 - 15s - loss: 0.0597 - acc: 0.9806 - val_loss: 0.3293 - val_acc: 0.9309
Epoch 36/1000
 - 15s - loss: 0.0562 - acc: 0.9806 - val_loss: 0.3419 - val_acc: 0.9236
Epoch 37/1000
 - 15s - loss: 0.0501 - acc: 0.9854 - val_loss: 0.2924 - val_acc: 0.9255
Epoch 38/1000
 - 15s - loss: 0.0596 - acc: 0.9812 - val_loss: 0.3396 - val_acc: 0.9255
Epoch 39/1000
 - 15s - loss: 0.0508 - acc: 0.9840 - val_loss: 0.3560 - val_acc: 0.9327
Epoch 40/1000
 - 15s - loss: 0.0421 - acc: 0.9836 - val_loss: 0.3778 - val_acc: 0.9236
Epoch 41/1000
 - 15s - loss: 0.0405 - acc: 0.9842 - val_loss: 0.5188 - val_acc: 0.8836
Epoch 42/1000
 - 15s - loss: 0.0456 - acc: 0.9867 - val_loss: 0.3788 - val_acc: 0.9309
Epoch 43/1000
 - 15s - loss: 0.0396 - acc: 0.9861 - val_loss: 0.3669 - val_acc: 0.9182
Epoch 44/1000
 - 14s - loss: 0.0421 - acc: 0.9863 - val_loss: 0.4412 - val_acc: 0.9109
Epoch 45/1000
 - 13s - loss: 0.0357 - acc: 0.9863 - val_loss: 0.3182 - val_acc: 0.9418
Epoch 46/1000
 - 13s - loss: 0.0409 - acc: 0.9869 - val_loss: 0.3350 - val_acc: 0.9327
Epoch 47/1000
 - 11s - loss: 0.0430 - acc: 0.9875 - val_loss: 0.3605 - val_acc: 0.9236
Epoch 48/1000
 - 10s - loss: 0.0288 - acc: 0.9887 - val_loss: 0.4277 - val_acc: 0.9218
Epoch 49/1000
 - 12s - loss: 0.0396 - acc: 0.9857 - val_loss: 0.4310 - val_acc: 0.9200
Epoch 50/1000
 - 13s - loss: 0.0365 - acc: 0.9893 - val_loss: 0.3760 - val_acc: 0.9255
Epoch 51/1000
 - 15s - loss: 0.0378 - acc: 0.9869 - val_loss: 0.4383 - val_acc: 0.9200
Epoch 52/1000
 - 15s - loss: 0.0347 - acc: 0.9901 - val_loss: 0.3804 - val_acc: 0.9236
Epoch 53/1000
 - 15s - loss: 0.0321 - acc: 0.9917 - val_loss: 0.3384 - val_acc: 0.9345
Epoch 54/1000
 - 15s - loss: 0.0400 - acc: 0.9871 - val_loss: 0.3168 - val_acc: 0.9236
Epoch 55/1000
 - 15s - loss: 0.0330 - acc: 0.9891 - val_loss: 0.2655 - val_acc: 0.9418
Epoch 56/1000
 - 15s - loss: 0.0272 - acc: 0.9905 - val_loss: 0.4681 - val_acc: 0.9145
Epoch 57/1000
 - 15s - loss: 0.0315 - acc: 0.9905 - val_loss: 0.3607 - val_acc: 0.9309
Epoch 58/1000
 - 15s - loss: 0.0252 - acc: 0.9923 - val_loss: 0.4015 - val_acc: 0.9345
Epoch 59/1000
 - 15s - loss: 0.0258 - acc: 0.9925 - val_loss: 0.4000 - val_acc: 0.9291
Epoch 60/1000
 - 15s - loss: 0.0351 - acc: 0.9885 - val_loss: 0.2541 - val_acc: 0.9473
Epoch 61/1000
 - 16s - loss: 0.0249 - acc: 0.9925 - val_loss: 0.3762 - val_acc: 0.9309
Epoch 62/1000
 - 15s - loss: 0.0202 - acc: 0.9935 - val_loss: 0.4005 - val_acc: 0.9255
Epoch 63/1000
 - 15s - loss: 0.0390 - acc: 0.9869 - val_loss: 0.3568 - val_acc: 0.9327
Epoch 64/1000
 - 15s - loss: 0.0257 - acc: 0.9919 - val_loss: 0.3961 - val_acc: 0.9327
Epoch 65/1000
 - 15s - loss: 0.0289 - acc: 0.9909 - val_loss: 0.3229 - val_acc: 0.9455
Epoch 66/1000
 - 15s - loss: 0.0284 - acc: 0.9911 - val_loss: 0.4296 - val_acc: 0.9200
Epoch 67/1000
 - 15s - loss: 0.0251 - acc: 0.9911 - val_loss: 0.4001 - val_acc: 0.9273
Epoch 68/1000
 - 13s - loss: 0.0273 - acc: 0.9933 - val_loss: 0.3529 - val_acc: 0.9345
Epoch 69/1000
 - 12s - loss: 0.0239 - acc: 0.9927 - val_loss: 0.4065 - val_acc: 0.9273
Epoch 70/1000
 - 12s - loss: 0.0277 - acc: 0.9921 - val_loss: 0.3506 - val_acc: 0.9309
Epoch 71/1000
 - 15s - loss: 0.0220 - acc: 0.9935 - val_loss: 0.3615 - val_acc: 0.9291
Epoch 72/1000
 - 15s - loss: 0.0287 - acc: 0.9917 - val_loss: 0.3811 - val_acc: 0.9327
Epoch 73/1000
 - 15s - loss: 0.0286 - acc: 0.9909 - val_loss: 0.3167 - val_acc: 0.9345
Epoch 74/1000
 - 15s - loss: 0.0245 - acc: 0.9919 - val_loss: 0.3383 - val_acc: 0.9327
Epoch 75/1000
 - 15s - loss: 0.0284 - acc: 0.9911 - val_loss: 0.4238 - val_acc: 0.9218
Epoch 76/1000
 - 15s - loss: 0.0281 - acc: 0.9917 - val_loss: 0.3843 - val_acc: 0.9309
Epoch 77/1000
 - 15s - loss: 0.0202 - acc: 0.9935 - val_loss: 0.3929 - val_acc: 0.9291
Epoch 78/1000
 - 15s - loss: 0.0203 - acc: 0.9933 - val_loss: 0.3987 - val_acc: 0.9309
Epoch 79/1000
 - 15s - loss: 0.0262 - acc: 0.9915 - val_loss: 0.3346 - val_acc: 0.9291
Epoch 80/1000
 - 15s - loss: 0.0267 - acc: 0.9931 - val_loss: 0.3545 - val_acc: 0.9400
Epoch 81/1000
 - 15s - loss: 0.0233 - acc: 0.9935 - val_loss: 0.3266 - val_acc: 0.9400
Epoch 82/1000
 - 15s - loss: 0.0215 - acc: 0.9933 - val_loss: 0.5305 - val_acc: 0.9182
Epoch 83/1000
 - 15s - loss: 0.0212 - acc: 0.9931 - val_loss: 0.3947 - val_acc: 0.9327
Epoch 84/1000
 - 15s - loss: 0.0144 - acc: 0.9951 - val_loss: 0.4352 - val_acc: 0.9309
Epoch 85/1000
 - 15s - loss: 0.0207 - acc: 0.9941 - val_loss: 0.3811 - val_acc: 0.9364
Epoch 86/1000
 - 15s - loss: 0.0172 - acc: 0.9956 - val_loss: 0.4199 - val_acc: 0.9236
Epoch 87/1000
 - 15s - loss: 0.0191 - acc: 0.9939 - val_loss: 0.3661 - val_acc: 0.9455
Epoch 88/1000
 - 15s - loss: 0.0159 - acc: 0.9941 - val_loss: 0.4680 - val_acc: 0.9200
Epoch 89/1000
 - 15s - loss: 0.0192 - acc: 0.9943 - val_loss: 0.3505 - val_acc: 0.9309
Epoch 90/1000
 - 15s - loss: 0.0179 - acc: 0.9939 - val_loss: 0.3976 - val_acc: 0.9327
dict_keys(['val_loss', 'acc', 'loss', 'val_acc'])
[[122   2   0   0   1   1]
 [  2 238   0   0   6   4]
 [ 19   3 197   4   6  20]
 [  7   6  11 216   4   6]
 [  0   0   0   1 249   0]
 [  0   2   0   0   2 246]]
[[0.96825397 0.01587302 0.         0.         0.00793651 0.00793651]
 [0.008      0.952      0.         0.         0.024      0.016     ]
 [0.07630522 0.01204819 0.79116466 0.01606426 0.02409639 0.08032129]
 [0.028      0.024      0.044      0.864      0.016      0.024     ]
 [0.         0.         0.         0.004      0.996      0.        ]
 [0.         0.008      0.         0.         0.008      0.984     ]]
metrics: ['loss', 'acc']
Test score: [0.44016273727655064, 0.9221818181818182]
Test loss: 0.44016273727655064
Test accuracy: 0.9221818181818182
Saving model to disk 

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
time_distributed_4 (TimeDist (None, 29, 64)            78400     
_________________________________________________________________
gru_output (GRU)             (None, 128)               74112     
_________________________________________________________________
dropout_8 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_12 (Dense)             (None, 6)                 774       
=================================================================
Total params: 153,286
Trainable params: 153,286
Non-trainable params: 0
_________________________________________________________________
None
Loading Data...
domain_type: 0
Loaded Data wf_tally 1 (5998, 29, 6, 20, 3) 4 (5998, 10) 1 (1500, 29, 6, 20, 3)
n_timesteps: 29
Train on 5398 samples, validate on 600 samples
Epoch 1/1000
 - 17s - loss: 1.5966 - acc: 0.2801 - val_loss: 1.3947 - val_acc: 0.3218
Epoch 2/1000
 - 15s - loss: 1.3448 - acc: 0.4058 - val_loss: 1.3088 - val_acc: 0.4091
Epoch 3/1000
 - 15s - loss: 1.1539 - acc: 0.5228 - val_loss: 1.0949 - val_acc: 0.4964
Epoch 4/1000
 - 15s - loss: 0.9980 - acc: 0.6075 - val_loss: 1.0343 - val_acc: 0.5255
Epoch 5/1000
 - 15s - loss: 0.8714 - acc: 0.6647 - val_loss: 0.8143 - val_acc: 0.6400
Epoch 6/1000
 - 15s - loss: 0.7713 - acc: 0.7065 - val_loss: 0.8982 - val_acc: 0.6236
Epoch 7/1000
 - 15s - loss: 0.6851 - acc: 0.7454 - val_loss: 0.8616 - val_acc: 0.6309
Epoch 8/1000
 - 15s - loss: 0.6121 - acc: 0.7775 - val_loss: 0.6731 - val_acc: 0.7164
Epoch 9/1000
 - 15s - loss: 0.5271 - acc: 0.8048 - val_loss: 0.5742 - val_acc: 0.7891
Epoch 10/1000
 - 15s - loss: 0.4651 - acc: 0.8316 - val_loss: 0.4219 - val_acc: 0.8491
Epoch 11/1000
 - 15s - loss: 0.4030 - acc: 0.8557 - val_loss: 0.5620 - val_acc: 0.7982
Epoch 12/1000
 - 13s - loss: 0.3491 - acc: 0.8775 - val_loss: 0.4591 - val_acc: 0.8436
Epoch 13/1000
 - 13s - loss: 0.3046 - acc: 0.8927 - val_loss: 0.3965 - val_acc: 0.8600
Epoch 14/1000
 - 11s - loss: 0.2510 - acc: 0.9151 - val_loss: 0.4843 - val_acc: 0.8382
Epoch 15/1000
 - 10s - loss: 0.2370 - acc: 0.9188 - val_loss: 0.4544 - val_acc: 0.8655
Epoch 16/1000
 - 12s - loss: 0.2122 - acc: 0.9232 - val_loss: 0.4297 - val_acc: 0.8564
Epoch 17/1000
 - 13s - loss: 0.1784 - acc: 0.9359 - val_loss: 0.4102 - val_acc: 0.8800
Epoch 18/1000
 - 15s - loss: 0.1496 - acc: 0.9485 - val_loss: 0.3792 - val_acc: 0.8855
Epoch 19/1000
 - 15s - loss: 0.1425 - acc: 0.9501 - val_loss: 0.2963 - val_acc: 0.9182
Epoch 20/1000
 - 15s - loss: 0.1341 - acc: 0.9535 - val_loss: 0.3573 - val_acc: 0.9073
Epoch 21/1000
 - 15s - loss: 0.1160 - acc: 0.9612 - val_loss: 0.4420 - val_acc: 0.8855
Epoch 22/1000
 - 15s - loss: 0.1123 - acc: 0.9614 - val_loss: 0.3718 - val_acc: 0.8964
Epoch 23/1000
 - 15s - loss: 0.1080 - acc: 0.9614 - val_loss: 0.4695 - val_acc: 0.8709
Epoch 24/1000
 - 15s - loss: 0.0963 - acc: 0.9673 - val_loss: 0.4340 - val_acc: 0.8891
Epoch 25/1000
 - 15s - loss: 0.0921 - acc: 0.9697 - val_loss: 0.4860 - val_acc: 0.8818
Epoch 26/1000
 - 15s - loss: 0.0891 - acc: 0.9660 - val_loss: 0.3201 - val_acc: 0.9218
Epoch 27/1000
 - 15s - loss: 0.0801 - acc: 0.9707 - val_loss: 0.3776 - val_acc: 0.9036
Epoch 28/1000
 - 15s - loss: 0.0854 - acc: 0.9711 - val_loss: 0.3628 - val_acc: 0.9200
Epoch 29/1000
 - 15s - loss: 0.0773 - acc: 0.9725 - val_loss: 0.4002 - val_acc: 0.8982
Epoch 30/1000
 - 15s - loss: 0.0688 - acc: 0.9774 - val_loss: 0.4902 - val_acc: 0.8800
Epoch 31/1000
 - 15s - loss: 0.0646 - acc: 0.9776 - val_loss: 0.3137 - val_acc: 0.9291
Epoch 32/1000
 - 16s - loss: 0.0599 - acc: 0.9794 - val_loss: 0.2902 - val_acc: 0.9345
Epoch 33/1000
 - 15s - loss: 0.0535 - acc: 0.9814 - val_loss: 0.2782 - val_acc: 0.9291
Epoch 34/1000
 - 15s - loss: 0.0564 - acc: 0.9822 - val_loss: 0.4027 - val_acc: 0.9091
Epoch 35/1000
 - 15s - loss: 0.0488 - acc: 0.9854 - val_loss: 0.3185 - val_acc: 0.9218
Epoch 36/1000
 - 15s - loss: 0.0520 - acc: 0.9816 - val_loss: 0.3410 - val_acc: 0.9309
Epoch 37/1000
 - 15s - loss: 0.0431 - acc: 0.9842 - val_loss: 0.3630 - val_acc: 0.9273
Epoch 38/1000
 - 15s - loss: 0.0534 - acc: 0.9818 - val_loss: 0.3134 - val_acc: 0.9309
Epoch 39/1000
 - 15s - loss: 0.0350 - acc: 0.9873 - val_loss: 0.3074 - val_acc: 0.9291
Epoch 40/1000
 - 16s - loss: 0.0432 - acc: 0.9844 - val_loss: 0.3614 - val_acc: 0.9236
Epoch 41/1000
 - 15s - loss: 0.0487 - acc: 0.9846 - val_loss: 0.4108 - val_acc: 0.9164
Epoch 42/1000
 - 15s - loss: 0.0432 - acc: 0.9859 - val_loss: 0.3670 - val_acc: 0.9182
Epoch 43/1000
 - 15s - loss: 0.0388 - acc: 0.9875 - val_loss: 0.3936 - val_acc: 0.9218
Epoch 44/1000
 - 15s - loss: 0.0335 - acc: 0.9893 - val_loss: 0.3029 - val_acc: 0.9327
Epoch 45/1000
 - 15s - loss: 0.0379 - acc: 0.9854 - val_loss: 0.3397 - val_acc: 0.9291
Epoch 46/1000
 - 15s - loss: 0.0383 - acc: 0.9861 - val_loss: 0.4251 - val_acc: 0.9091
Epoch 47/1000
 - 15s - loss: 0.0452 - acc: 0.9846 - val_loss: 0.2975 - val_acc: 0.9400
Epoch 48/1000
 - 15s - loss: 0.0411 - acc: 0.9850 - val_loss: 0.4305 - val_acc: 0.9145
Epoch 49/1000
 - 15s - loss: 0.0264 - acc: 0.9917 - val_loss: 0.4039 - val_acc: 0.9091
Epoch 50/1000
 - 16s - loss: 0.0350 - acc: 0.9889 - val_loss: 0.3047 - val_acc: 0.9291
Epoch 51/1000
 - 15s - loss: 0.0343 - acc: 0.9897 - val_loss: 0.4220 - val_acc: 0.9182
Epoch 52/1000
 - 15s - loss: 0.0284 - acc: 0.9907 - val_loss: 0.3596 - val_acc: 0.9291
Epoch 53/1000
 - 15s - loss: 0.0297 - acc: 0.9907 - val_loss: 0.5207 - val_acc: 0.9091
Epoch 54/1000
 - 15s - loss: 0.0394 - acc: 0.9887 - val_loss: 0.3530 - val_acc: 0.9327
Epoch 55/1000
 - 15s - loss: 0.0391 - acc: 0.9879 - val_loss: 0.4533 - val_acc: 0.9127
Epoch 56/1000
 - 13s - loss: 0.0315 - acc: 0.9899 - val_loss: 0.4029 - val_acc: 0.9255
Epoch 57/1000
 - 12s - loss: 0.0251 - acc: 0.9921 - val_loss: 0.3367 - val_acc: 0.9382
Epoch 58/1000
 - 13s - loss: 0.0306 - acc: 0.9895 - val_loss: 0.5024 - val_acc: 0.9036
Epoch 59/1000
 - 15s - loss: 0.0294 - acc: 0.9905 - val_loss: 0.3435 - val_acc: 0.9200
Epoch 60/1000
 - 15s - loss: 0.0256 - acc: 0.9911 - val_loss: 0.4595 - val_acc: 0.9218
Epoch 61/1000
 - 15s - loss: 0.0245 - acc: 0.9905 - val_loss: 0.4184 - val_acc: 0.9255
Epoch 62/1000
 - 15s - loss: 0.0265 - acc: 0.9917 - val_loss: 0.3828 - val_acc: 0.9364
Epoch 63/1000
 - 13s - loss: 0.0353 - acc: 0.9887 - val_loss: 0.4532 - val_acc: 0.9145
dict_keys(['val_loss', 'acc', 'loss', 'val_acc'])
[[124   1   0   0   0   1]
 [  7 236   2   1   3   1]
 [ 30   5 202   3   2   7]
 [ 11   4   8 223   0   4]
 [  2   1   0   3 243   1]
 [  1  10   0   0   3 236]]
[[0.98412698 0.00793651 0.         0.         0.         0.00793651]
 [0.028      0.944      0.008      0.004      0.012      0.004     ]
 [0.12048193 0.02008032 0.81124498 0.01204819 0.00803213 0.02811245]
 [0.044      0.016      0.032      0.892      0.         0.016     ]
 [0.008      0.004      0.         0.012      0.972      0.004     ]
 [0.004      0.04       0.         0.         0.012      0.944     ]]
metrics: ['loss', 'acc']
Test score: [0.33901752973415633, 0.9192727266224948]
Test loss: 0.33901752973415633
Test accuracy: 0.9192727266224948
Saving model to disk 

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
time_distributed_5 (TimeDist (None, 29, 64)            78400     
_________________________________________________________________
gru_output (GRU)             (None, 128)               74112     
_________________________________________________________________
dropout_10 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_15 (Dense)             (None, 6)                 774       
=================================================================
Total params: 153,286
Trainable params: 153,286
Non-trainable params: 0
_________________________________________________________________
None
Loading Data...
domain_type: 0
Loaded Data wf_tally 1 (5998, 29, 6, 20, 3) 4 (5998, 10) 1 (1500, 29, 6, 20, 3)
n_timesteps: 29
Train on 5398 samples, validate on 600 samples
Epoch 1/1000
 - 18s - loss: 1.6232 - acc: 0.2759 - val_loss: 1.3417 - val_acc: 0.3545
Epoch 2/1000
 - 15s - loss: 1.3599 - acc: 0.3998 - val_loss: 1.2099 - val_acc: 0.4600
Epoch 3/1000
 - 15s - loss: 1.1668 - acc: 0.5174 - val_loss: 1.1690 - val_acc: 0.5109
Epoch 4/1000
 - 15s - loss: 1.0000 - acc: 0.6043 - val_loss: 1.0132 - val_acc: 0.5545
Epoch 5/1000
 - 15s - loss: 0.8758 - acc: 0.6625 - val_loss: 0.9504 - val_acc: 0.6255
Epoch 6/1000
 - 15s - loss: 0.7731 - acc: 0.7078 - val_loss: 0.7996 - val_acc: 0.6636
Epoch 7/1000
 - 15s - loss: 0.6992 - acc: 0.7346 - val_loss: 0.7109 - val_acc: 0.7509
Epoch 8/1000
 - 15s - loss: 0.6301 - acc: 0.7672 - val_loss: 0.5788 - val_acc: 0.7782
Epoch 9/1000
 - 15s - loss: 0.5596 - acc: 0.8042 - val_loss: 0.5592 - val_acc: 0.7727
Epoch 10/1000
 - 15s - loss: 0.4982 - acc: 0.8163 - val_loss: 0.4439 - val_acc: 0.8418
Epoch 11/1000
 - 15s - loss: 0.4360 - acc: 0.8426 - val_loss: 0.5586 - val_acc: 0.7982
Epoch 12/1000
 - 15s - loss: 0.4014 - acc: 0.8553 - val_loss: 0.4962 - val_acc: 0.8255
Epoch 13/1000
 - 15s - loss: 0.3403 - acc: 0.8781 - val_loss: 0.4361 - val_acc: 0.8509
Epoch 14/1000
 - 15s - loss: 0.3037 - acc: 0.8923 - val_loss: 0.3911 - val_acc: 0.8764
Epoch 15/1000
 - 13s - loss: 0.2723 - acc: 0.9038 - val_loss: 0.6435 - val_acc: 0.7873
Epoch 16/1000
 - 12s - loss: 0.2385 - acc: 0.9206 - val_loss: 0.3947 - val_acc: 0.8818
Epoch 17/1000
 - 12s - loss: 0.2051 - acc: 0.9268 - val_loss: 0.4250 - val_acc: 0.8800
Epoch 18/1000
 - 13s - loss: 0.1838 - acc: 0.9345 - val_loss: 0.4134 - val_acc: 0.8727
Epoch 19/1000
 - 14s - loss: 0.1757 - acc: 0.9373 - val_loss: 0.4240 - val_acc: 0.8782
Epoch 20/1000
 - 15s - loss: 0.1594 - acc: 0.9440 - val_loss: 0.3617 - val_acc: 0.8964
Epoch 21/1000
 - 15s - loss: 0.1301 - acc: 0.9574 - val_loss: 0.4134 - val_acc: 0.8873
Epoch 22/1000
 - 15s - loss: 0.1296 - acc: 0.9523 - val_loss: 0.2683 - val_acc: 0.9164
Epoch 23/1000
 - 15s - loss: 0.1141 - acc: 0.9602 - val_loss: 0.3453 - val_acc: 0.9145
Epoch 24/1000
 - 15s - loss: 0.1179 - acc: 0.9604 - val_loss: 0.3609 - val_acc: 0.9091
Epoch 25/1000
 - 15s - loss: 0.1017 - acc: 0.9646 - val_loss: 0.2856 - val_acc: 0.9218
Epoch 26/1000
 - 15s - loss: 0.0947 - acc: 0.9673 - val_loss: 0.3378 - val_acc: 0.9109
Epoch 27/1000
 - 15s - loss: 0.0844 - acc: 0.9719 - val_loss: 0.3509 - val_acc: 0.9073
Epoch 28/1000
 - 15s - loss: 0.0784 - acc: 0.9715 - val_loss: 0.3010 - val_acc: 0.9309
Epoch 29/1000
 - 15s - loss: 0.0757 - acc: 0.9717 - val_loss: 0.3410 - val_acc: 0.9236
Epoch 30/1000
 - 15s - loss: 0.0779 - acc: 0.9713 - val_loss: 0.3209 - val_acc: 0.9164
Epoch 31/1000
 - 15s - loss: 0.0722 - acc: 0.9747 - val_loss: 0.3445 - val_acc: 0.9145
Epoch 32/1000
 - 15s - loss: 0.0687 - acc: 0.9780 - val_loss: 0.3209 - val_acc: 0.9218
Epoch 33/1000
 - 15s - loss: 0.0558 - acc: 0.9822 - val_loss: 0.4460 - val_acc: 0.8945
Epoch 34/1000
 - 15s - loss: 0.0689 - acc: 0.9747 - val_loss: 0.3513 - val_acc: 0.9182
Epoch 35/1000
 - 15s - loss: 0.0618 - acc: 0.9778 - val_loss: 0.3301 - val_acc: 0.9200
Epoch 36/1000
 - 15s - loss: 0.0611 - acc: 0.9794 - val_loss: 0.3718 - val_acc: 0.9182
Epoch 37/1000
 - 13s - loss: 0.0553 - acc: 0.9820 - val_loss: 0.3153 - val_acc: 0.9273
Epoch 38/1000
 - 13s - loss: 0.0508 - acc: 0.9824 - val_loss: 0.4520 - val_acc: 0.8945
Epoch 39/1000
 - 12s - loss: 0.0496 - acc: 0.9830 - val_loss: 0.4145 - val_acc: 0.9182
Epoch 40/1000
 - 14s - loss: 0.0387 - acc: 0.9883 - val_loss: 0.3992 - val_acc: 0.9200
Epoch 41/1000
 - 15s - loss: 0.0531 - acc: 0.9820 - val_loss: 0.3906 - val_acc: 0.9145
Epoch 42/1000
 - 15s - loss: 0.0559 - acc: 0.9798 - val_loss: 0.3438 - val_acc: 0.9273
Epoch 43/1000
 - 15s - loss: 0.0395 - acc: 0.9863 - val_loss: 0.3428 - val_acc: 0.9327
Epoch 44/1000
 - 15s - loss: 0.0430 - acc: 0.9848 - val_loss: 0.3098 - val_acc: 0.9255
Epoch 45/1000
 - 15s - loss: 0.0334 - acc: 0.9893 - val_loss: 0.4686 - val_acc: 0.9091
Epoch 46/1000
 - 15s - loss: 0.0393 - acc: 0.9871 - val_loss: 0.4189 - val_acc: 0.9145
Epoch 47/1000
 - 15s - loss: 0.0417 - acc: 0.9863 - val_loss: 0.4047 - val_acc: 0.9127
Epoch 48/1000
 - 15s - loss: 0.0419 - acc: 0.9871 - val_loss: 0.4168 - val_acc: 0.9291
Epoch 49/1000
 - 13s - loss: 0.0412 - acc: 0.9875 - val_loss: 0.4395 - val_acc: 0.9145
Epoch 50/1000
 - 12s - loss: 0.0392 - acc: 0.9867 - val_loss: 0.4027 - val_acc: 0.9309
Epoch 51/1000
 - 12s - loss: 0.0373 - acc: 0.9881 - val_loss: 0.4852 - val_acc: 0.9055
Epoch 52/1000
 - 13s - loss: 0.0314 - acc: 0.9883 - val_loss: 0.4231 - val_acc: 0.9255
dict_keys(['val_loss', 'acc', 'loss', 'val_acc'])
[[122   2   0   0   1   1]
 [  6 239   0   0   2   3]
 [ 22   3 211   2   2   9]
 [  8   7  18 212   2   3]
 [  0   2   1   1 244   2]
 [  1  11   0   0   0 238]]
[[0.96825397 0.01587302 0.         0.         0.00793651 0.00793651]
 [0.024      0.956      0.         0.         0.008      0.012     ]
 [0.08835341 0.01204819 0.84738956 0.00803213 0.00803213 0.03614458]
 [0.032      0.028      0.072      0.848      0.008      0.012     ]
 [0.         0.008      0.004      0.004      0.976      0.008     ]
 [0.004      0.044      0.         0.         0.         0.952     ]]
metrics: ['loss', 'acc']
Test score: [0.38864267249197954, 0.9207272727272727]
Test loss: 0.38864267249197954
Test accuracy: 0.9207272727272727
Saving model to disk 

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
time_distributed_9 (TimeDist (None, 29, 64)            78400     
_________________________________________________________________
gru_output (GRU)             (None, 128)               74112     
_________________________________________________________________
dropout_18 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_27 (Dense)             (None, 6)                 774       
=================================================================
Total params: 153,286
Trainable params: 153,286
Non-trainable params: 0
_________________________________________________________________
None
Loading Data...
domain_type: 0
Loaded Data wf_tally 1 (5998, 29, 6, 20, 3) 4 (5998, 10) 1 (1500, 29, 6, 20, 3)
n_timesteps: 29
Train on 5398 samples, validate on 600 samples
Epoch 1/1000
 - 18s - loss: 1.5786 - acc: 0.2872 - val_loss: 1.3280 - val_acc: 0.3673
Epoch 2/1000
 - 15s - loss: 1.3318 - acc: 0.4177 - val_loss: 1.1800 - val_acc: 0.4382
Epoch 3/1000
 - 15s - loss: 1.1527 - acc: 0.5283 - val_loss: 1.1724 - val_acc: 0.4655
Epoch 4/1000
 - 15s - loss: 0.9717 - acc: 0.6093 - val_loss: 0.9721 - val_acc: 0.5382
Epoch 5/1000
 - 15s - loss: 0.8516 - acc: 0.6653 - val_loss: 0.8052 - val_acc: 0.6291
Epoch 6/1000
 - 15s - loss: 0.7581 - acc: 0.7063 - val_loss: 0.8023 - val_acc: 0.6800
Epoch 7/1000
 - 15s - loss: 0.6679 - acc: 0.7443 - val_loss: 0.8768 - val_acc: 0.6309
Epoch 8/1000
 - 15s - loss: 0.5782 - acc: 0.7846 - val_loss: 0.7032 - val_acc: 0.7309
Epoch 9/1000
 - 15s - loss: 0.5008 - acc: 0.8195 - val_loss: 0.6680 - val_acc: 0.7636
Epoch 10/1000
 - 15s - loss: 0.4328 - acc: 0.8436 - val_loss: 0.4726 - val_acc: 0.8382
Epoch 11/1000
 - 15s - loss: 0.3635 - acc: 0.8707 - val_loss: 0.6156 - val_acc: 0.8109
Epoch 12/1000
 - 15s - loss: 0.3353 - acc: 0.8816 - val_loss: 0.4982 - val_acc: 0.8382
Epoch 13/1000
 - 15s - loss: 0.2844 - acc: 0.9020 - val_loss: 0.4143 - val_acc: 0.8727
Epoch 14/1000
 - 15s - loss: 0.2543 - acc: 0.9093 - val_loss: 0.3471 - val_acc: 0.9000
Epoch 15/1000
 - 15s - loss: 0.2291 - acc: 0.9181 - val_loss: 0.4641 - val_acc: 0.8709
Epoch 16/1000
 - 15s - loss: 0.2084 - acc: 0.9264 - val_loss: 0.3663 - val_acc: 0.8836
Epoch 17/1000
 - 15s - loss: 0.1855 - acc: 0.9323 - val_loss: 0.3918 - val_acc: 0.8964
Epoch 18/1000
 - 15s - loss: 0.1679 - acc: 0.9436 - val_loss: 0.2916 - val_acc: 0.9255
Epoch 19/1000
 - 15s - loss: 0.1482 - acc: 0.9473 - val_loss: 0.4158 - val_acc: 0.8800
Epoch 20/1000
 - 13s - loss: 0.1431 - acc: 0.9529 - val_loss: 0.3769 - val_acc: 0.9091
Epoch 21/1000
 - 13s - loss: 0.1177 - acc: 0.9610 - val_loss: 0.4265 - val_acc: 0.8909
Epoch 22/1000
 - 12s - loss: 0.1263 - acc: 0.9584 - val_loss: 0.3387 - val_acc: 0.9145
Epoch 23/1000
 - 13s - loss: 0.1109 - acc: 0.9646 - val_loss: 0.3153 - val_acc: 0.9309
Epoch 24/1000
 - 15s - loss: 0.1113 - acc: 0.9624 - val_loss: 0.3613 - val_acc: 0.8964
Epoch 25/1000
 - 15s - loss: 0.0899 - acc: 0.9687 - val_loss: 0.3843 - val_acc: 0.9000
Epoch 26/1000
 - 15s - loss: 0.0796 - acc: 0.9733 - val_loss: 0.3217 - val_acc: 0.9073
Epoch 27/1000
 - 15s - loss: 0.0855 - acc: 0.9699 - val_loss: 0.4021 - val_acc: 0.9055
Epoch 28/1000
 - 15s - loss: 0.0872 - acc: 0.9713 - val_loss: 0.3227 - val_acc: 0.9164
Epoch 29/1000
 - 15s - loss: 0.0723 - acc: 0.9755 - val_loss: 0.3362 - val_acc: 0.9218
Epoch 30/1000
 - 14s - loss: 0.0636 - acc: 0.9792 - val_loss: 0.4653 - val_acc: 0.8982
Epoch 31/1000
 - 12s - loss: 0.0677 - acc: 0.9776 - val_loss: 0.3257 - val_acc: 0.9164
Epoch 32/1000
 - 12s - loss: 0.0512 - acc: 0.9826 - val_loss: 0.3389 - val_acc: 0.9145
Epoch 33/1000
 - 12s - loss: 0.0666 - acc: 0.9780 - val_loss: 0.2820 - val_acc: 0.9455
Epoch 34/1000
 - 15s - loss: 0.0561 - acc: 0.9818 - val_loss: 0.3222 - val_acc: 0.9327
Epoch 35/1000
 - 15s - loss: 0.0602 - acc: 0.9800 - val_loss: 0.3059 - val_acc: 0.9291
Epoch 36/1000
 - 15s - loss: 0.0511 - acc: 0.9836 - val_loss: 0.4362 - val_acc: 0.9091
Epoch 37/1000
 - 15s - loss: 0.0468 - acc: 0.9838 - val_loss: 0.3351 - val_acc: 0.9091
Epoch 38/1000
 - 15s - loss: 0.0454 - acc: 0.9859 - val_loss: 0.4487 - val_acc: 0.9073
Epoch 39/1000
 - 15s - loss: 0.0442 - acc: 0.9830 - val_loss: 0.3462 - val_acc: 0.9236
Epoch 40/1000
 - 15s - loss: 0.0507 - acc: 0.9846 - val_loss: 0.3080 - val_acc: 0.9291
Epoch 41/1000
 - 15s - loss: 0.0464 - acc: 0.9850 - val_loss: 0.3051 - val_acc: 0.9345
Epoch 42/1000
 - 15s - loss: 0.0447 - acc: 0.9840 - val_loss: 0.4078 - val_acc: 0.9145
Epoch 43/1000
 - 15s - loss: 0.0428 - acc: 0.9863 - val_loss: 0.3697 - val_acc: 0.9109
Epoch 44/1000
 - 15s - loss: 0.0381 - acc: 0.9865 - val_loss: 0.3270 - val_acc: 0.9273
Epoch 45/1000
 - 15s - loss: 0.0433 - acc: 0.9840 - val_loss: 0.3723 - val_acc: 0.9127
Epoch 46/1000
 - 15s - loss: 0.0336 - acc: 0.9887 - val_loss: 0.2679 - val_acc: 0.9436
Epoch 47/1000
 - 15s - loss: 0.0411 - acc: 0.9869 - val_loss: 0.3410 - val_acc: 0.9164
Epoch 48/1000
 - 15s - loss: 0.0380 - acc: 0.9875 - val_loss: 0.3048 - val_acc: 0.9418
Epoch 49/1000
 - 15s - loss: 0.0398 - acc: 0.9883 - val_loss: 0.2999 - val_acc: 0.9327
Epoch 50/1000
 - 15s - loss: 0.0236 - acc: 0.9917 - val_loss: 0.4169 - val_acc: 0.9127
Epoch 51/1000
 - 14s - loss: 0.0384 - acc: 0.9883 - val_loss: 0.3282 - val_acc: 0.9273
Epoch 52/1000
 - 12s - loss: 0.0324 - acc: 0.9891 - val_loss: 0.2819 - val_acc: 0.9382
Epoch 53/1000
 - 12s - loss: 0.0387 - acc: 0.9871 - val_loss: 0.3449 - val_acc: 0.9255
Epoch 54/1000
 - 12s - loss: 0.0361 - acc: 0.9899 - val_loss: 0.4486 - val_acc: 0.9073
Epoch 55/1000
 - 13s - loss: 0.0266 - acc: 0.9921 - val_loss: 0.4874 - val_acc: 0.8964
Epoch 56/1000
 - 15s - loss: 0.0291 - acc: 0.9913 - val_loss: 0.2623 - val_acc: 0.9418
Epoch 57/1000
 - 15s - loss: 0.0255 - acc: 0.9911 - val_loss: 0.3808 - val_acc: 0.9236
Epoch 58/1000
 - 15s - loss: 0.0264 - acc: 0.9915 - val_loss: 0.4192 - val_acc: 0.9255
Epoch 59/1000
 - 15s - loss: 0.0239 - acc: 0.9911 - val_loss: 0.4608 - val_acc: 0.9182
Epoch 60/1000
 - 15s - loss: 0.0262 - acc: 0.9907 - val_loss: 0.3964 - val_acc: 0.9164
Epoch 61/1000
 - 15s - loss: 0.0279 - acc: 0.9899 - val_loss: 0.3762 - val_acc: 0.9309
Epoch 62/1000
 - 15s - loss: 0.0281 - acc: 0.9893 - val_loss: 0.2481 - val_acc: 0.9436
Epoch 63/1000
 - 15s - loss: 0.0316 - acc: 0.9903 - val_loss: 0.3913 - val_acc: 0.9364
Epoch 64/1000
 - 15s - loss: 0.0232 - acc: 0.9917 - val_loss: 0.3500 - val_acc: 0.9291
Epoch 65/1000
 - 15s - loss: 0.0298 - acc: 0.9893 - val_loss: 0.3075 - val_acc: 0.9400
Epoch 66/1000
 - 15s - loss: 0.0236 - acc: 0.9929 - val_loss: 0.3123 - val_acc: 0.9345
Epoch 67/1000
 - 15s - loss: 0.0266 - acc: 0.9903 - val_loss: 0.2518 - val_acc: 0.9509
Epoch 68/1000
 - 15s - loss: 0.0194 - acc: 0.9951 - val_loss: 0.3210 - val_acc: 0.9291
Epoch 69/1000
 - 15s - loss: 0.0206 - acc: 0.9951 - val_loss: 0.3275 - val_acc: 0.9309
Epoch 70/1000
 - 13s - loss: 0.0171 - acc: 0.9931 - val_loss: 0.3226 - val_acc: 0.9382
Epoch 71/1000
 - 12s - loss: 0.0209 - acc: 0.9933 - val_loss: 0.3245 - val_acc: 0.9364
Epoch 72/1000
 - 12s - loss: 0.0263 - acc: 0.9925 - val_loss: 0.2749 - val_acc: 0.9473
Epoch 73/1000
 - 13s - loss: 0.0228 - acc: 0.9921 - val_loss: 0.4066 - val_acc: 0.9291
Epoch 74/1000
 - 15s - loss: 0.0224 - acc: 0.9929 - val_loss: 0.4072 - val_acc: 0.9309
Epoch 75/1000
 - 15s - loss: 0.0233 - acc: 0.9917 - val_loss: 0.3619 - val_acc: 0.9218
Epoch 76/1000
 - 15s - loss: 0.0211 - acc: 0.9941 - val_loss: 0.3807 - val_acc: 0.9236
Epoch 77/1000
 - 15s - loss: 0.0277 - acc: 0.9903 - val_loss: 0.3845 - val_acc: 0.9182
Epoch 78/1000
 - 15s - loss: 0.0170 - acc: 0.9939 - val_loss: 0.3741 - val_acc: 0.9309
Epoch 79/1000
 - 15s - loss: 0.0187 - acc: 0.9956 - val_loss: 0.3950 - val_acc: 0.9291
Epoch 80/1000
 - 15s - loss: 0.0269 - acc: 0.9919 - val_loss: 0.3851 - val_acc: 0.9273
Epoch 81/1000
 - 15s - loss: 0.0243 - acc: 0.9923 - val_loss: 0.6084 - val_acc: 0.9036
Epoch 82/1000
 - 15s - loss: 0.0197 - acc: 0.9923 - val_loss: 0.4616 - val_acc: 0.9236
Epoch 83/1000
 - 15s - loss: 0.0293 - acc: 0.9917 - val_loss: 0.3943 - val_acc: 0.9218
Epoch 84/1000
 - 15s - loss: 0.0182 - acc: 0.9927 - val_loss: 0.3926 - val_acc: 0.9327
Epoch 85/1000
 - 15s - loss: 0.0243 - acc: 0.9929 - val_loss: 0.3511 - val_acc: 0.9364
Epoch 86/1000
 - 15s - loss: 0.0218 - acc: 0.9929 - val_loss: 0.4062 - val_acc: 0.9309
Epoch 87/1000
 - 15s - loss: 0.0210 - acc: 0.9939 - val_loss: 0.4172 - val_acc: 0.9273
Epoch 88/1000
 - 15s - loss: 0.0186 - acc: 0.9933 - val_loss: 0.4912 - val_acc: 0.9145
Epoch 89/1000
 - 15s - loss: 0.0160 - acc: 0.9954 - val_loss: 0.4696 - val_acc: 0.9073
Epoch 90/1000
 - 15s - loss: 0.0228 - acc: 0.9925 - val_loss: 0.4656 - val_acc: 0.9255
Epoch 91/1000
 - 15s - loss: 0.0182 - acc: 0.9921 - val_loss: 0.4799 - val_acc: 0.9145
Epoch 92/1000
 - 15s - loss: 0.0170 - acc: 0.9939 - val_loss: 0.4011 - val_acc: 0.9327
dict_keys(['val_loss', 'acc', 'loss', 'val_acc'])
[[122   2   1   0   1   0]
 [  2 236   3   0   5   4]
 [ 12   4 221   3   1   8]
 [  3   5  15 222   1   4]
 [  1   0   1   0 247   1]
 [  0   3   0   0   0 247]]
[[0.96825397 0.01587302 0.00793651 0.         0.00793651 0.        ]
 [0.008      0.944      0.012      0.         0.02       0.016     ]
 [0.04819277 0.01606426 0.8875502  0.01204819 0.00401606 0.03212851]
 [0.012      0.02       0.06       0.888      0.004      0.016     ]
 [0.004      0.         0.004      0.         0.988      0.004     ]
 [0.         0.012      0.         0.         0.         0.988     ]]
metrics: ['loss', 'acc']
Test score: [0.34864595302142104, 0.9418181818181818]
Test loss: 0.34864595302142104
Test accuracy: 0.9418181818181818
Saving model to disk 

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
time_distributed_10 (TimeDis (None, 29, 64)            78400     
_________________________________________________________________
gru_output (GRU)             (None, 128)               74112     
_________________________________________________________________
dropout_20 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_30 (Dense)             (None, 6)                 774       
=================================================================
Total params: 153,286
Trainable params: 153,286
Non-trainable params: 0
_________________________________________________________________
None
