argsï¼š Namespace(datasource='wf_tally', domaintype=4, envdomain=1, gesturelist=[1, 2, 3, 4, 5, 6], gpuloadratio=0.25, gradientreversalrate=0.0, instancelist=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10], matlabname=['velocity_bins_freq'], mode='train', nettype='CNN_GRU_wf_tally', numberofpath=5, orientationdomain=4, pathtype='INSTANCE_sobel', patience=10, pcalist=[0, 1, 2], positiondomain=4, receiverlist=[0, 1, 2, 3, 4, 5], serverset='remote', sizeoffeature=64, targettype=1, timelimit=58, traintestratio=0.8, userlist=[1, 2, 3, 4, 5, 6, 7, 8], yaxislength=20)
ed:  [1, 2, 3, 4, 5, 6, 7, 8] pd:  [1, 2, 3, 4, 5] od:  [1, 2, 3, 4, 5]
Loading Data...
domain_type: 4
Loaded Data wf_tally 1 (9600, 58, 6, 20, 3) 4 (9600, 8) 1 (2400, 58, 6, 20, 3)
n_timesteps: 58
Train on 8640 samples, validate on 960 samples
Epoch 1/1000
 - 37s - loss: 1.5056 - acc: 0.3459 - val_loss: 1.1874 - val_acc: 0.4792
Epoch 2/1000
 - 35s - loss: 1.2127 - acc: 0.4779 - val_loss: 1.1458 - val_acc: 0.5354
Epoch 3/1000
 - 35s - loss: 1.0236 - acc: 0.5887 - val_loss: 0.8876 - val_acc: 0.6510
Epoch 4/1000
 - 33s - loss: 0.8213 - acc: 0.6832 - val_loss: 0.6441 - val_acc: 0.7698
Epoch 5/1000
 - 33s - loss: 0.6706 - acc: 0.7483 - val_loss: 0.6196 - val_acc: 0.7594
Epoch 6/1000
 - 32s - loss: 0.5820 - acc: 0.7837 - val_loss: 0.4916 - val_acc: 0.8167
Epoch 7/1000
 - 32s - loss: 0.4822 - acc: 0.8273 - val_loss: 0.4935 - val_acc: 0.8083
Epoch 8/1000
 - 32s - loss: 0.4155 - acc: 0.8513 - val_loss: 0.4089 - val_acc: 0.8604
Epoch 9/1000
 - 31s - loss: 0.3526 - acc: 0.8758 - val_loss: 0.2715 - val_acc: 0.9073
Epoch 10/1000
 - 31s - loss: 0.3027 - acc: 0.8909 - val_loss: 0.3081 - val_acc: 0.8896
Epoch 11/1000
 - 31s - loss: 0.2628 - acc: 0.9102 - val_loss: 0.2199 - val_acc: 0.9354
Epoch 12/1000
 - 31s - loss: 0.2280 - acc: 0.9213 - val_loss: 0.2215 - val_acc: 0.9250
Epoch 13/1000
 - 30s - loss: 0.2041 - acc: 0.9296 - val_loss: 0.2213 - val_acc: 0.9208
Epoch 14/1000
 - 30s - loss: 0.1776 - acc: 0.9409 - val_loss: 0.1687 - val_acc: 0.9510
Epoch 15/1000
 - 29s - loss: 0.1506 - acc: 0.9483 - val_loss: 0.2212 - val_acc: 0.9260
Epoch 16/1000
 - 26s - loss: 0.1379 - acc: 0.9521 - val_loss: 0.1348 - val_acc: 0.9521
Epoch 17/1000
 - 27s - loss: 0.1237 - acc: 0.9573 - val_loss: 0.1384 - val_acc: 0.9510
Epoch 18/1000
 - 28s - loss: 0.1113 - acc: 0.9631 - val_loss: 0.1844 - val_acc: 0.9479
Epoch 19/1000
 - 30s - loss: 0.1041 - acc: 0.9653 - val_loss: 0.2009 - val_acc: 0.9375
Epoch 20/1000
 - 29s - loss: 0.0898 - acc: 0.9696 - val_loss: 0.1044 - val_acc: 0.9740
Epoch 21/1000
 - 29s - loss: 0.0871 - acc: 0.9703 - val_loss: 0.1389 - val_acc: 0.9573
Epoch 22/1000
 - 30s - loss: 0.0810 - acc: 0.9736 - val_loss: 0.0870 - val_acc: 0.9708
Epoch 23/1000
 - 29s - loss: 0.0745 - acc: 0.9758 - val_loss: 0.1022 - val_acc: 0.9719
Epoch 24/1000
 - 30s - loss: 0.0718 - acc: 0.9757 - val_loss: 0.0815 - val_acc: 0.9771
Epoch 25/1000
 - 30s - loss: 0.0676 - acc: 0.9775 - val_loss: 0.1302 - val_acc: 0.9594
Epoch 26/1000
 - 30s - loss: 0.0569 - acc: 0.9809 - val_loss: 0.1611 - val_acc: 0.9552
Epoch 27/1000
 - 30s - loss: 0.0602 - acc: 0.9796 - val_loss: 0.1835 - val_acc: 0.9458
Epoch 28/1000
 - 29s - loss: 0.0539 - acc: 0.9825 - val_loss: 0.0810 - val_acc: 0.9740
Epoch 29/1000
 - 29s - loss: 0.0501 - acc: 0.9829 - val_loss: 0.0996 - val_acc: 0.9708
Epoch 30/1000
 - 30s - loss: 0.0497 - acc: 0.9844 - val_loss: 0.0824 - val_acc: 0.9708
Epoch 31/1000
 - 29s - loss: 0.0494 - acc: 0.9844 - val_loss: 0.1248 - val_acc: 0.9719
Epoch 32/1000
 - 29s - loss: 0.0515 - acc: 0.9841 - val_loss: 0.1030 - val_acc: 0.9740
Epoch 33/1000
 - 30s - loss: 0.0479 - acc: 0.9845 - val_loss: 0.0827 - val_acc: 0.9750
Epoch 34/1000
 - 29s - loss: 0.0467 - acc: 0.9840 - val_loss: 0.1120 - val_acc: 0.9698
Epoch 35/1000
 - 30s - loss: 0.0372 - acc: 0.9872 - val_loss: 0.0929 - val_acc: 0.9740
Epoch 36/1000
 - 29s - loss: 0.0410 - acc: 0.9860 - val_loss: 0.1483 - val_acc: 0.9646
Epoch 37/1000
 - 30s - loss: 0.0381 - acc: 0.9882 - val_loss: 0.0730 - val_acc: 0.9833
Epoch 38/1000
 - 29s - loss: 0.0382 - acc: 0.9875 - val_loss: 0.1268 - val_acc: 0.9688
Epoch 39/1000
 - 29s - loss: 0.0369 - acc: 0.9868 - val_loss: 0.0856 - val_acc: 0.9760
Epoch 40/1000
 - 30s - loss: 0.0356 - acc: 0.9882 - val_loss: 0.1414 - val_acc: 0.9656
Epoch 41/1000
 - 29s - loss: 0.0316 - acc: 0.9890 - val_loss: 0.0979 - val_acc: 0.9708
Epoch 42/1000
 - 29s - loss: 0.0337 - acc: 0.9883 - val_loss: 0.0950 - val_acc: 0.9771
Epoch 43/1000
 - 30s - loss: 0.0338 - acc: 0.9892 - val_loss: 0.0724 - val_acc: 0.9792
Epoch 44/1000
 - 29s - loss: 0.0328 - acc: 0.9900 - val_loss: 0.0690 - val_acc: 0.9771
Epoch 45/1000
 - 29s - loss: 0.0317 - acc: 0.9905 - val_loss: 0.1146 - val_acc: 0.9719
Epoch 46/1000
 - 30s - loss: 0.0308 - acc: 0.9891 - val_loss: 0.1410 - val_acc: 0.9604
Epoch 47/1000
 - 29s - loss: 0.0307 - acc: 0.9910 - val_loss: 0.1334 - val_acc: 0.9698
Epoch 48/1000
 - 29s - loss: 0.0244 - acc: 0.9914 - val_loss: 0.0802 - val_acc: 0.9781
Epoch 49/1000
 - 29s - loss: 0.0317 - acc: 0.9898 - val_loss: 0.1818 - val_acc: 0.9615
Epoch 50/1000
 - 29s - loss: 0.0235 - acc: 0.9916 - val_loss: 0.0925 - val_acc: 0.9792
Epoch 51/1000
 - 30s - loss: 0.0254 - acc: 0.9913 - val_loss: 0.0716 - val_acc: 0.9792
Epoch 52/1000
 - 29s - loss: 0.0268 - acc: 0.9905 - val_loss: 0.0810 - val_acc: 0.9802
Epoch 53/1000
 - 29s - loss: 0.0287 - acc: 0.9920 - val_loss: 0.2109 - val_acc: 0.9469
Epoch 54/1000
 - 30s - loss: 0.0252 - acc: 0.9921 - val_loss: 0.0862 - val_acc: 0.9781
dict_keys(['val_loss', 'acc', 'val_acc', 'loss'])
[[390   0   0   0   0   1]
 [  4 399   0   0   5   5]
 [  1   1 384   4   0   0]
 [  3   2   1 385   5   2]
 [  1   0   0   1 390   1]
 [  3   1   0   0   4 407]]
[[0.99744246 0.         0.         0.         0.         0.00255754]
 [0.00968523 0.96610169 0.         0.         0.01210654 0.01210654]
 [0.0025641  0.0025641  0.98461538 0.01025641 0.         0.        ]
 [0.00753769 0.00502513 0.00251256 0.96733668 0.01256281 0.00502513]
 [0.00254453 0.         0.         0.00254453 0.99236641 0.00254453]
 [0.00722892 0.00240964 0.         0.         0.00963855 0.98072289]]
metrics: ['loss', 'acc']
Test score: [0.08167567604842285, 0.98125]
Test loss: 0.08167567604842285
Test accuracy: 0.98125
Saving model to disk 

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
time_distributed_1 (TimeDist (None, 58, 64)            78400     
_________________________________________________________________
gru_output (GRU)             (None, 128)               74112     
_________________________________________________________________
dropout_2 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 6)                 774       
=================================================================
Total params: 153,286
Trainable params: 153,286
Non-trainable params: 0
_________________________________________________________________
None
Loading Data...
domain_type: 4
Loaded Data wf_tally 1 (9600, 58, 6, 20, 3) 4 (9600, 8) 1 (2400, 58, 6, 20, 3)
n_timesteps: 58
Train on 8640 samples, validate on 960 samples
Epoch 1/1000
 - 32s - loss: 1.5581 - acc: 0.3183 - val_loss: 1.3159 - val_acc: 0.4333
Epoch 2/1000
 - 30s - loss: 1.2258 - acc: 0.4800 - val_loss: 1.0391 - val_acc: 0.5990
Epoch 3/1000
 - 31s - loss: 1.0203 - acc: 0.5955 - val_loss: 0.8479 - val_acc: 0.6635
Epoch 4/1000
 - 31s - loss: 0.8325 - acc: 0.6825 - val_loss: 0.6480 - val_acc: 0.7677
Epoch 5/1000
 - 32s - loss: 0.6850 - acc: 0.7443 - val_loss: 0.5224 - val_acc: 0.8167
Epoch 6/1000
 - 32s - loss: 0.5843 - acc: 0.7847 - val_loss: 0.4391 - val_acc: 0.8500
Epoch 7/1000
 - 33s - loss: 0.4885 - acc: 0.8212 - val_loss: 0.3828 - val_acc: 0.8688
Epoch 8/1000
 - 34s - loss: 0.4171 - acc: 0.8531 - val_loss: 0.3310 - val_acc: 0.8969
Epoch 9/1000
 - 34s - loss: 0.3547 - acc: 0.8747 - val_loss: 0.2863 - val_acc: 0.9031
Epoch 10/1000
 - 34s - loss: 0.2963 - acc: 0.8965 - val_loss: 0.3203 - val_acc: 0.9052
Epoch 11/1000
 - 33s - loss: 0.2608 - acc: 0.9106 - val_loss: 0.2659 - val_acc: 0.9229
Epoch 12/1000
 - 33s - loss: 0.2220 - acc: 0.9196 - val_loss: 0.2382 - val_acc: 0.9219
Epoch 13/1000
 - 33s - loss: 0.1852 - acc: 0.9363 - val_loss: 0.2300 - val_acc: 0.9260
Epoch 14/1000
 - 33s - loss: 0.1727 - acc: 0.9403 - val_loss: 0.1751 - val_acc: 0.9396
Epoch 15/1000
 - 33s - loss: 0.1588 - acc: 0.9459 - val_loss: 0.1626 - val_acc: 0.9437
Epoch 16/1000
 - 32s - loss: 0.1409 - acc: 0.9529 - val_loss: 0.1388 - val_acc: 0.9490
Epoch 17/1000
 - 32s - loss: 0.1150 - acc: 0.9616 - val_loss: 0.1361 - val_acc: 0.9573
Epoch 18/1000
 - 49s - loss: 0.1078 - acc: 0.9625 - val_loss: 0.1715 - val_acc: 0.9427
Epoch 19/1000
 - 90s - loss: 0.0932 - acc: 0.9698 - val_loss: 0.1441 - val_acc: 0.9427
Epoch 20/1000
 - 91s - loss: 0.0928 - acc: 0.9686 - val_loss: 0.1242 - val_acc: 0.9604
Epoch 21/1000
 - 70s - loss: 0.0843 - acc: 0.9701 - val_loss: 0.1604 - val_acc: 0.9500
Epoch 22/1000
 - 29s - loss: 0.0805 - acc: 0.9738 - val_loss: 0.1542 - val_acc: 0.9594
Epoch 23/1000
 - 29s - loss: 0.0747 - acc: 0.9745 - val_loss: 0.1276 - val_acc: 0.9615
Epoch 24/1000
 - 31s - loss: 0.0678 - acc: 0.9771 - val_loss: 0.1091 - val_acc: 0.9688
Epoch 25/1000
 - 32s - loss: 0.0659 - acc: 0.9789 - val_loss: 0.1138 - val_acc: 0.9667
Epoch 26/1000
 - 32s - loss: 0.0610 - acc: 0.9791 - val_loss: 0.1135 - val_acc: 0.9656
Epoch 27/1000
 - 32s - loss: 0.0588 - acc: 0.9810 - val_loss: 0.1057 - val_acc: 0.9719
Epoch 28/1000
 - 32s - loss: 0.0569 - acc: 0.9824 - val_loss: 0.0882 - val_acc: 0.9729
Epoch 29/1000
 - 33s - loss: 0.0558 - acc: 0.9816 - val_loss: 0.1841 - val_acc: 0.9510
Epoch 30/1000
 - 32s - loss: 0.0518 - acc: 0.9828 - val_loss: 0.1281 - val_acc: 0.9688
Epoch 31/1000
 - 33s - loss: 0.0462 - acc: 0.9858 - val_loss: 0.1062 - val_acc: 0.9750
Epoch 32/1000
 - 32s - loss: 0.0395 - acc: 0.9874 - val_loss: 0.0950 - val_acc: 0.9708
Epoch 33/1000
 - 33s - loss: 0.0404 - acc: 0.9875 - val_loss: 0.1050 - val_acc: 0.9740
Epoch 34/1000
 - 33s - loss: 0.0444 - acc: 0.9854 - val_loss: 0.1155 - val_acc: 0.9708
Epoch 35/1000
 - 32s - loss: 0.0470 - acc: 0.9856 - val_loss: 0.1026 - val_acc: 0.9688
Epoch 36/1000
 - 33s - loss: 0.0395 - acc: 0.9868 - val_loss: 0.1157 - val_acc: 0.9708
Epoch 37/1000
 - 32s - loss: 0.0402 - acc: 0.9869 - val_loss: 0.1338 - val_acc: 0.9708
Epoch 38/1000
 - 32s - loss: 0.0348 - acc: 0.9887 - val_loss: 0.1271 - val_acc: 0.9719
dict_keys(['val_loss', 'acc', 'val_acc', 'loss'])
[[399   4   1   0   3   1]
 [  1 395   0   1   1   5]
 [  0   3 366  14   1   0]
 [  4   0   0 419   2   0]
 [  0   2   0   0 390   0]
 [  8   5   1   5   5 364]]
[[0.97794118 0.00980392 0.00245098 0.         0.00735294 0.00245098]
 [0.00248139 0.98014888 0.         0.00248139 0.00248139 0.01240695]
 [0.         0.0078125  0.953125   0.03645833 0.00260417 0.        ]
 [0.00941176 0.         0.         0.98588235 0.00470588 0.        ]
 [0.         0.00510204 0.         0.         0.99489796 0.        ]
 [0.02061856 0.0128866  0.00257732 0.0128866  0.0128866  0.93814433]]
metrics: ['loss', 'acc']
Test score: [0.11134291522592928, 0.9720833333333333]
Test loss: 0.11134291522592928
Test accuracy: 0.9720833333333333
Saving model to disk 

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
time_distributed_2 (TimeDist (None, 58, 64)            78400     
_________________________________________________________________
gru_output (GRU)             (None, 128)               74112     
_________________________________________________________________
dropout_4 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_6 (Dense)              (None, 6)                 774       
=================================================================
Total params: 153,286
Trainable params: 153,286
Non-trainable params: 0
_________________________________________________________________
None
Loading Data...
domain_type: 4
Loaded Data wf_tally 1 (9600, 58, 6, 20, 3) 4 (9600, 8) 1 (2400, 58, 6, 20, 3)
n_timesteps: 58
Train on 8640 samples, validate on 960 samples
Epoch 1/1000
 - 34s - loss: 1.5302 - acc: 0.3300 - val_loss: 1.2819 - val_acc: 0.4448
Epoch 2/1000
 - 31s - loss: 1.2246 - acc: 0.4750 - val_loss: 1.0712 - val_acc: 0.5531
Epoch 3/1000
 - 30s - loss: 1.0252 - acc: 0.5860 - val_loss: 0.9347 - val_acc: 0.6135
Epoch 4/1000
 - 30s - loss: 0.8416 - acc: 0.6764 - val_loss: 0.7981 - val_acc: 0.7063
Epoch 5/1000
 - 30s - loss: 0.7182 - acc: 0.7304 - val_loss: 0.6234 - val_acc: 0.7771
Epoch 6/1000
 - 31s - loss: 0.6055 - acc: 0.7792 - val_loss: 0.5266 - val_acc: 0.8125
Epoch 7/1000
 - 31s - loss: 0.5109 - acc: 0.8133 - val_loss: 0.4264 - val_acc: 0.8510
Epoch 8/1000
 - 31s - loss: 0.4402 - acc: 0.8412 - val_loss: 0.3755 - val_acc: 0.8594
Epoch 9/1000
 - 31s - loss: 0.3749 - acc: 0.8666 - val_loss: 0.3909 - val_acc: 0.8635
Epoch 10/1000
 - 30s - loss: 0.3248 - acc: 0.8878 - val_loss: 0.2958 - val_acc: 0.9052
Epoch 11/1000
 - 31s - loss: 0.2747 - acc: 0.9024 - val_loss: 0.3043 - val_acc: 0.8927
Epoch 12/1000
 - 30s - loss: 0.2486 - acc: 0.9153 - val_loss: 0.2349 - val_acc: 0.9198
Epoch 13/1000
 - 29s - loss: 0.1969 - acc: 0.9336 - val_loss: 0.2389 - val_acc: 0.9198
Epoch 14/1000
 - 29s - loss: 0.1822 - acc: 0.9370 - val_loss: 0.1730 - val_acc: 0.9396
Epoch 15/1000
 - 29s - loss: 0.1562 - acc: 0.9484 - val_loss: 0.1962 - val_acc: 0.9344
Epoch 16/1000
 - 28s - loss: 0.1430 - acc: 0.9520 - val_loss: 0.1881 - val_acc: 0.9396
Epoch 17/1000
 - 29s - loss: 0.1250 - acc: 0.9569 - val_loss: 0.1538 - val_acc: 0.9469
Epoch 18/1000
 - 29s - loss: 0.1182 - acc: 0.9590 - val_loss: 0.1464 - val_acc: 0.9490
Epoch 19/1000
 - 29s - loss: 0.1079 - acc: 0.9637 - val_loss: 0.1162 - val_acc: 0.9615
Epoch 20/1000
 - 29s - loss: 0.0984 - acc: 0.9677 - val_loss: 0.1395 - val_acc: 0.9542
Epoch 21/1000
 - 29s - loss: 0.0910 - acc: 0.9692 - val_loss: 0.1422 - val_acc: 0.9573
Epoch 22/1000
 - 29s - loss: 0.0851 - acc: 0.9737 - val_loss: 0.1138 - val_acc: 0.9656
Epoch 23/1000
 - 29s - loss: 0.0715 - acc: 0.9757 - val_loss: 0.1449 - val_acc: 0.9531
Epoch 24/1000
 - 29s - loss: 0.0693 - acc: 0.9770 - val_loss: 0.1529 - val_acc: 0.9604
Epoch 25/1000
 - 29s - loss: 0.0714 - acc: 0.9777 - val_loss: 0.1275 - val_acc: 0.9615
Epoch 26/1000
 - 29s - loss: 0.0725 - acc: 0.9773 - val_loss: 0.1271 - val_acc: 0.9542
Epoch 27/1000
 - 29s - loss: 0.0565 - acc: 0.9809 - val_loss: 0.1241 - val_acc: 0.9625
Epoch 28/1000
 - 29s - loss: 0.0560 - acc: 0.9814 - val_loss: 0.1067 - val_acc: 0.9625
Epoch 29/1000
 - 26s - loss: 0.0513 - acc: 0.9840 - val_loss: 0.1123 - val_acc: 0.9604
Epoch 30/1000
 - 27s - loss: 0.0535 - acc: 0.9831 - val_loss: 0.1428 - val_acc: 0.9563
Epoch 31/1000
 - 27s - loss: 0.0503 - acc: 0.9825 - val_loss: 0.1481 - val_acc: 0.9583
Epoch 32/1000
 - 30s - loss: 0.0490 - acc: 0.9841 - val_loss: 0.1295 - val_acc: 0.9667
Epoch 33/1000
 - 29s - loss: 0.0501 - acc: 0.9831 - val_loss: 0.1352 - val_acc: 0.9625
Epoch 34/1000
 - 29s - loss: 0.0470 - acc: 0.9850 - val_loss: 0.1237 - val_acc: 0.9667
Epoch 35/1000
 - 29s - loss: 0.0446 - acc: 0.9839 - val_loss: 0.1535 - val_acc: 0.9573
Epoch 36/1000
 - 29s - loss: 0.0414 - acc: 0.9858 - val_loss: 0.0898 - val_acc: 0.9740
Epoch 37/1000
 - 29s - loss: 0.0373 - acc: 0.9880 - val_loss: 0.1125 - val_acc: 0.9688
Epoch 38/1000
 - 29s - loss: 0.0374 - acc: 0.9884 - val_loss: 0.1119 - val_acc: 0.9760
Epoch 39/1000
 - 29s - loss: 0.0335 - acc: 0.9894 - val_loss: 0.1240 - val_acc: 0.9719
Epoch 40/1000
 - 29s - loss: 0.0350 - acc: 0.9881 - val_loss: 0.1351 - val_acc: 0.9688
Epoch 41/1000
 - 29s - loss: 0.0441 - acc: 0.9867 - val_loss: 0.0970 - val_acc: 0.9781
Epoch 42/1000
 - 29s - loss: 0.0318 - acc: 0.9905 - val_loss: 0.1121 - val_acc: 0.9688
Epoch 43/1000
 - 28s - loss: 0.0236 - acc: 0.9931 - val_loss: 0.1021 - val_acc: 0.9740
Epoch 44/1000
 - 29s - loss: 0.0335 - acc: 0.9903 - val_loss: 0.1223 - val_acc: 0.9708
Epoch 45/1000
 - 29s - loss: 0.0297 - acc: 0.9903 - val_loss: 0.0989 - val_acc: 0.9771
Epoch 46/1000
 - 29s - loss: 0.0335 - acc: 0.9891 - val_loss: 0.1176 - val_acc: 0.9688
dict_keys(['val_loss', 'acc', 'val_acc', 'loss'])
[[421   0   1   0   0   0]
 [  1 368   2   2   0  10]
 [  0   1 373   6   1   0]
 [  2   1   6 394   1   2]
 [  2   6   1   0 399   4]
 [  2   1   0   1   1 391]]
[[0.99763033 0.         0.00236967 0.         0.         0.        ]
 [0.00261097 0.96083551 0.00522193 0.00522193 0.         0.02610966]
 [0.         0.00262467 0.97900262 0.01574803 0.00262467 0.        ]
 [0.00492611 0.00246305 0.01477833 0.97044335 0.00246305 0.00492611]
 [0.00485437 0.01456311 0.00242718 0.         0.9684466  0.00970874]
 [0.00505051 0.00252525 0.         0.00252525 0.00252525 0.98737374]]
metrics: ['loss', 'acc']
Test score: [0.09046276943248813, 0.9775]
Test loss: 0.09046276943248813
Test accuracy: 0.9775
Saving model to disk 

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
time_distributed_3 (TimeDist (None, 58, 64)            78400     
_________________________________________________________________
gru_output (GRU)             (None, 128)               74112     
_________________________________________________________________
dropout_6 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_9 (Dense)              (None, 6)                 774       
=================================================================
Total params: 153,286
Trainable params: 153,286
Non-trainable params: 0
_________________________________________________________________
None
Loading Data...
domain_type: 4
Loaded Data wf_tally 1 (9600, 58, 6, 20, 3) 4 (9600, 8) 1 (2400, 58, 6, 20, 3)
n_timesteps: 58
Train on 8640 samples, validate on 960 samples
Epoch 1/1000
 - 32s - loss: 1.5367 - acc: 0.3439 - val_loss: 1.2511 - val_acc: 0.4490
Epoch 2/1000
 - 30s - loss: 1.1898 - acc: 0.4946 - val_loss: 0.9868 - val_acc: 0.5948
Epoch 3/1000
 - 31s - loss: 0.9359 - acc: 0.6197 - val_loss: 0.7406 - val_acc: 0.7073
Epoch 4/1000
 - 30s - loss: 0.7883 - acc: 0.6948 - val_loss: 0.7583 - val_acc: 0.7042
Epoch 5/1000
 - 31s - loss: 0.6680 - acc: 0.7487 - val_loss: 0.4951 - val_acc: 0.8250
Epoch 6/1000
 - 31s - loss: 0.5539 - acc: 0.7953 - val_loss: 0.5437 - val_acc: 0.7781
Epoch 7/1000
 - 31s - loss: 0.4656 - acc: 0.8336 - val_loss: 0.3624 - val_acc: 0.8750
Epoch 8/1000
 - 32s - loss: 0.3849 - acc: 0.8598 - val_loss: 0.3335 - val_acc: 0.8885
Epoch 9/1000
 - 32s - loss: 0.3194 - acc: 0.8862 - val_loss: 0.2967 - val_acc: 0.9031
Epoch 10/1000
 - 32s - loss: 0.2699 - acc: 0.9047 - val_loss: 0.2504 - val_acc: 0.9094
Epoch 11/1000
 - 31s - loss: 0.2397 - acc: 0.9194 - val_loss: 0.2347 - val_acc: 0.9260
Epoch 12/1000
 - 32s - loss: 0.2045 - acc: 0.9286 - val_loss: 0.2296 - val_acc: 0.9229
Epoch 13/1000
 - 32s - loss: 0.1693 - acc: 0.9431 - val_loss: 0.1596 - val_acc: 0.9437
Epoch 14/1000
 - 32s - loss: 0.1549 - acc: 0.9473 - val_loss: 0.1904 - val_acc: 0.9365
Epoch 15/1000
 - 33s - loss: 0.1343 - acc: 0.9528 - val_loss: 0.1337 - val_acc: 0.9531
Epoch 16/1000
 - 32s - loss: 0.1252 - acc: 0.9564 - val_loss: 0.1583 - val_acc: 0.9479
Epoch 17/1000
 - 32s - loss: 0.1107 - acc: 0.9626 - val_loss: 0.1146 - val_acc: 0.9615
Epoch 18/1000
 - 33s - loss: 0.1013 - acc: 0.9653 - val_loss: 0.0928 - val_acc: 0.9698
Epoch 19/1000
 - 32s - loss: 0.0900 - acc: 0.9693 - val_loss: 0.1111 - val_acc: 0.9688
Epoch 20/1000
 - 32s - loss: 0.0837 - acc: 0.9734 - val_loss: 0.0948 - val_acc: 0.9719
Epoch 21/1000
 - 32s - loss: 0.0827 - acc: 0.9733 - val_loss: 0.1131 - val_acc: 0.9677
Epoch 22/1000
 - 33s - loss: 0.0703 - acc: 0.9778 - val_loss: 0.1104 - val_acc: 0.9708
Epoch 23/1000
 - 30s - loss: 0.0649 - acc: 0.9788 - val_loss: 0.1247 - val_acc: 0.9594
Epoch 24/1000
 - 30s - loss: 0.0609 - acc: 0.9809 - val_loss: 0.2352 - val_acc: 0.9385
Epoch 25/1000
 - 31s - loss: 0.0561 - acc: 0.9817 - val_loss: 0.0942 - val_acc: 0.9677
Epoch 26/1000
 - 32s - loss: 0.0538 - acc: 0.9821 - val_loss: 0.1059 - val_acc: 0.9646
Epoch 27/1000
 - 32s - loss: 0.0475 - acc: 0.9833 - val_loss: 0.1173 - val_acc: 0.9667
Epoch 28/1000
 - 33s - loss: 0.0488 - acc: 0.9850 - val_loss: 0.1019 - val_acc: 0.9688
dict_keys(['val_loss', 'acc', 'val_acc', 'loss'])
[[360   3   0   0   0   0]
 [  0 412   4   1   7   3]
 [  7   1 386   4   1   2]
 [  0   0   9 381   3   0]
 [  1   1   0   0 395   8]
 [  3   5   0   2   2 399]]
[[0.99173554 0.00826446 0.         0.         0.         0.        ]
 [0.         0.96487119 0.00936768 0.00234192 0.01639344 0.00702576]
 [0.01745636 0.00249377 0.96259352 0.00997506 0.00249377 0.00498753]
 [0.         0.         0.02290076 0.96946565 0.00763359 0.        ]
 [0.00246914 0.00246914 0.         0.         0.97530864 0.01975309]
 [0.00729927 0.01216545 0.         0.00486618 0.00486618 0.97080292]]
metrics: ['loss', 'acc']
Test score: [0.09634187723121916, 0.9720833333333333]
Test loss: 0.09634187723121916
Test accuracy: 0.9720833333333333
Saving model to disk 

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
time_distributed_4 (TimeDist (None, 58, 64)            78400     
_________________________________________________________________
gru_output (GRU)             (None, 128)               74112     
_________________________________________________________________
dropout_8 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_12 (Dense)             (None, 6)                 774       
=================================================================
Total params: 153,286
Trainable params: 153,286
Non-trainable params: 0
_________________________________________________________________
None
Loading Data...
domain_type: 4
Loaded Data wf_tally 1 (9600, 58, 6, 20, 3) 4 (9600, 8) 1 (2400, 58, 6, 20, 3)
n_timesteps: 58
Train on 8640 samples, validate on 960 samples
Epoch 1/1000
 - 35s - loss: 1.5401 - acc: 0.3332 - val_loss: 1.2716 - val_acc: 0.4615
Epoch 2/1000
 - 33s - loss: 1.1782 - acc: 0.5073 - val_loss: 0.9854 - val_acc: 0.6010
Epoch 3/1000
 - 33s - loss: 0.9347 - acc: 0.6319 - val_loss: 0.8085 - val_acc: 0.6875
Epoch 4/1000
 - 33s - loss: 0.7442 - acc: 0.7113 - val_loss: 0.6149 - val_acc: 0.7562
Epoch 5/1000
 - 31s - loss: 0.6032 - acc: 0.7645 - val_loss: 0.4992 - val_acc: 0.8250
Epoch 6/1000
 - 30s - loss: 0.4942 - acc: 0.8191 - val_loss: 0.3840 - val_acc: 0.8531
Epoch 7/1000
 - 31s - loss: 0.4166 - acc: 0.8464 - val_loss: 0.3399 - val_acc: 0.8771
Epoch 8/1000
 - 32s - loss: 0.3388 - acc: 0.8799 - val_loss: 0.2694 - val_acc: 0.9167
Epoch 9/1000
 - 31s - loss: 0.2868 - acc: 0.8990 - val_loss: 0.2544 - val_acc: 0.9052
Epoch 10/1000
 - 30s - loss: 0.2496 - acc: 0.9134 - val_loss: 0.2304 - val_acc: 0.9271
Epoch 11/1000
 - 30s - loss: 0.2112 - acc: 0.9269 - val_loss: 0.2201 - val_acc: 0.9313
Epoch 12/1000
 - 29s - loss: 0.1846 - acc: 0.9387 - val_loss: 0.1699 - val_acc: 0.9427
Epoch 13/1000
 - 29s - loss: 0.1539 - acc: 0.9481 - val_loss: 0.1768 - val_acc: 0.9417
Epoch 14/1000
 - 30s - loss: 0.1335 - acc: 0.9522 - val_loss: 0.1418 - val_acc: 0.9583
Epoch 15/1000
 - 30s - loss: 0.1294 - acc: 0.9556 - val_loss: 0.1400 - val_acc: 0.9521
Epoch 16/1000
 - 30s - loss: 0.1093 - acc: 0.9620 - val_loss: 0.1611 - val_acc: 0.9542
Epoch 17/1000
 - 30s - loss: 0.0921 - acc: 0.9694 - val_loss: 0.1103 - val_acc: 0.9656
Epoch 18/1000
 - 29s - loss: 0.0927 - acc: 0.9706 - val_loss: 0.1571 - val_acc: 0.9604
Epoch 19/1000
 - 29s - loss: 0.0825 - acc: 0.9718 - val_loss: 0.1338 - val_acc: 0.9563
Epoch 20/1000
 - 29s - loss: 0.0791 - acc: 0.9748 - val_loss: 0.1427 - val_acc: 0.9583
Epoch 21/1000
 - 30s - loss: 0.0737 - acc: 0.9738 - val_loss: 0.1019 - val_acc: 0.9677
Epoch 22/1000
 - 30s - loss: 0.0639 - acc: 0.9775 - val_loss: 0.1038 - val_acc: 0.9677
Epoch 23/1000
 - 30s - loss: 0.0589 - acc: 0.9784 - val_loss: 0.1164 - val_acc: 0.9667
Epoch 24/1000
 - 30s - loss: 0.0611 - acc: 0.9808 - val_loss: 0.1166 - val_acc: 0.9583
Epoch 25/1000
 - 29s - loss: 0.0540 - acc: 0.9821 - val_loss: 0.0948 - val_acc: 0.9719
Epoch 26/1000
 - 30s - loss: 0.0529 - acc: 0.9834 - val_loss: 0.1230 - val_acc: 0.9635
Epoch 27/1000
 - 30s - loss: 0.0487 - acc: 0.9832 - val_loss: 0.1003 - val_acc: 0.9688
Epoch 28/1000
 - 29s - loss: 0.0520 - acc: 0.9831 - val_loss: 0.1191 - val_acc: 0.9667
Epoch 29/1000
 - 26s - loss: 0.0456 - acc: 0.9875 - val_loss: 0.0965 - val_acc: 0.9740
Epoch 30/1000
 - 27s - loss: 0.0448 - acc: 0.9865 - val_loss: 0.1069 - val_acc: 0.9760
Epoch 31/1000
 - 29s - loss: 0.0417 - acc: 0.9860 - val_loss: 0.0895 - val_acc: 0.9740
Epoch 32/1000
 - 30s - loss: 0.0361 - acc: 0.9878 - val_loss: 0.0983 - val_acc: 0.9771
Epoch 33/1000
 - 30s - loss: 0.0387 - acc: 0.9875 - val_loss: 0.1112 - val_acc: 0.9688
Epoch 34/1000
 - 30s - loss: 0.0336 - acc: 0.9899 - val_loss: 0.0808 - val_acc: 0.9833
Epoch 35/1000
 - 30s - loss: 0.0379 - acc: 0.9887 - val_loss: 0.0911 - val_acc: 0.9740
Epoch 36/1000
 - 30s - loss: 0.0266 - acc: 0.9907 - val_loss: 0.1075 - val_acc: 0.9688
Epoch 37/1000
 - 30s - loss: 0.0298 - acc: 0.9907 - val_loss: 0.0854 - val_acc: 0.9760
Epoch 38/1000
 - 30s - loss: 0.0375 - acc: 0.9888 - val_loss: 0.1040 - val_acc: 0.9729
Epoch 39/1000
 - 30s - loss: 0.0286 - acc: 0.9907 - val_loss: 0.1169 - val_acc: 0.9719
Epoch 40/1000
 - 30s - loss: 0.0307 - acc: 0.9910 - val_loss: 0.1830 - val_acc: 0.9594
Epoch 41/1000
 - 30s - loss: 0.0290 - acc: 0.9904 - val_loss: 0.1380 - val_acc: 0.9698
Epoch 42/1000
 - 30s - loss: 0.0240 - acc: 0.9904 - val_loss: 0.0990 - val_acc: 0.9781
Epoch 43/1000
 - 30s - loss: 0.0281 - acc: 0.9909 - val_loss: 0.1051 - val_acc: 0.9719
Epoch 44/1000
 - 30s - loss: 0.0282 - acc: 0.9907 - val_loss: 0.1025 - val_acc: 0.9719
dict_keys(['val_loss', 'acc', 'val_acc', 'loss'])
[[380  10   2   0   0   2]
 [  0 402   2   1   0   2]
 [  1   2 371   7   0   0]
 [  0   1   5 416   1   0]
 [  1   8   1   0 359   9]
 [  2   1   2   3   2 407]]
[[0.96446701 0.02538071 0.00507614 0.         0.         0.00507614]
 [0.         0.98771499 0.004914   0.002457   0.         0.004914  ]
 [0.00262467 0.00524934 0.97375328 0.0183727  0.         0.        ]
 [0.         0.00236407 0.01182033 0.98345154 0.00236407 0.        ]
 [0.0026455  0.02116402 0.0026455  0.         0.94973545 0.02380952]
 [0.00479616 0.00239808 0.00479616 0.00719424 0.00479616 0.97601918]]
metrics: ['loss', 'acc']
Test score: [0.12301255508578227, 0.9729166666666667]
Test loss: 0.12301255508578227
Test accuracy: 0.9729166666666667
Saving model to disk 

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
time_distributed_5 (TimeDist (None, 58, 64)            78400     
_________________________________________________________________
gru_output (GRU)             (None, 128)               74112     
_________________________________________________________________
dropout_10 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_15 (Dense)             (None, 6)                 774       
=================================================================
Total params: 153,286
Trainable params: 153,286
Non-trainable params: 0
_________________________________________________________________
None
Loading Data...
domain_type: 4
Loaded Data wf_tally 1 (9600, 58, 6, 20, 3) 4 (9600, 8) 1 (2400, 58, 6, 20, 3)
n_timesteps: 58
Train on 8640 samples, validate on 960 samples
Epoch 1/1000
 - 34s - loss: 1.4686 - acc: 0.3637 - val_loss: 1.2294 - val_acc: 0.4781
Epoch 2/1000
 - 33s - loss: 1.1517 - acc: 0.5204 - val_loss: 1.0984 - val_acc: 0.5531
Epoch 3/1000
 - 32s - loss: 0.9094 - acc: 0.6455 - val_loss: 0.7665 - val_acc: 0.7042
Epoch 4/1000
 - 32s - loss: 0.7335 - acc: 0.7221 - val_loss: 0.6734 - val_acc: 0.7552
Epoch 5/1000
 - 32s - loss: 0.6206 - acc: 0.7751 - val_loss: 0.5243 - val_acc: 0.8104
Epoch 6/1000
 - 32s - loss: 0.5348 - acc: 0.8008 - val_loss: 0.5016 - val_acc: 0.7990
Epoch 7/1000
 - 33s - loss: 0.4503 - acc: 0.8374 - val_loss: 0.4502 - val_acc: 0.8292
Epoch 8/1000
 - 32s - loss: 0.3885 - acc: 0.8612 - val_loss: 0.3345 - val_acc: 0.8740
Epoch 9/1000
 - 31s - loss: 0.3274 - acc: 0.8854 - val_loss: 0.3926 - val_acc: 0.8573
Epoch 10/1000
 - 32s - loss: 0.2840 - acc: 0.9001 - val_loss: 0.4350 - val_acc: 0.8594
Epoch 11/1000
 - 31s - loss: 0.2488 - acc: 0.9122 - val_loss: 0.2505 - val_acc: 0.9083
Epoch 12/1000
 - 31s - loss: 0.2105 - acc: 0.9301 - val_loss: 0.2040 - val_acc: 0.9302
Epoch 13/1000
 - 31s - loss: 0.1935 - acc: 0.9334 - val_loss: 0.2384 - val_acc: 0.9229
Epoch 14/1000
 - 31s - loss: 0.1667 - acc: 0.9453 - val_loss: 0.2034 - val_acc: 0.9375
Epoch 15/1000
 - 31s - loss: 0.1496 - acc: 0.9492 - val_loss: 0.1932 - val_acc: 0.9396
Epoch 16/1000
 - 31s - loss: 0.1266 - acc: 0.9567 - val_loss: 0.2398 - val_acc: 0.9250
Epoch 17/1000
 - 31s - loss: 0.1172 - acc: 0.9590 - val_loss: 0.1328 - val_acc: 0.9583
Epoch 18/1000
 - 31s - loss: 0.1084 - acc: 0.9637 - val_loss: 0.1338 - val_acc: 0.9583
Epoch 19/1000
 - 31s - loss: 0.0955 - acc: 0.9677 - val_loss: 0.1378 - val_acc: 0.9563
Epoch 20/1000
 - 31s - loss: 0.0882 - acc: 0.9713 - val_loss: 0.1330 - val_acc: 0.9646
Epoch 21/1000
 - 31s - loss: 0.0768 - acc: 0.9741 - val_loss: 0.1704 - val_acc: 0.9469
Epoch 22/1000
 - 31s - loss: 0.0803 - acc: 0.9719 - val_loss: 0.1000 - val_acc: 0.9667
Epoch 23/1000
 - 31s - loss: 0.0659 - acc: 0.9765 - val_loss: 0.1571 - val_acc: 0.9510
Epoch 24/1000
 - 31s - loss: 0.0658 - acc: 0.9759 - val_loss: 0.1287 - val_acc: 0.9563
Epoch 25/1000
 - 32s - loss: 0.0672 - acc: 0.9765 - val_loss: 0.2059 - val_acc: 0.9406
Epoch 26/1000
 - 31s - loss: 0.0524 - acc: 0.9828 - val_loss: 0.1105 - val_acc: 0.9635
Epoch 27/1000
 - 31s - loss: 0.0570 - acc: 0.9812 - val_loss: 0.1653 - val_acc: 0.9510
Epoch 28/1000
 - 32s - loss: 0.0550 - acc: 0.9808 - val_loss: 0.0923 - val_acc: 0.9719
Epoch 29/1000
 - 33s - loss: 0.0508 - acc: 0.9833 - val_loss: 0.1443 - val_acc: 0.9604
Epoch 30/1000
 - 30s - loss: 0.0464 - acc: 0.9845 - val_loss: 0.1680 - val_acc: 0.9531
Epoch 31/1000
 - 30s - loss: 0.0453 - acc: 0.9848 - val_loss: 0.0952 - val_acc: 0.9760
Epoch 32/1000
 - 30s - loss: 0.0449 - acc: 0.9870 - val_loss: 0.0957 - val_acc: 0.9740
Epoch 33/1000
 - 30s - loss: 0.0380 - acc: 0.9884 - val_loss: 0.1077 - val_acc: 0.9708
Epoch 34/1000
 - 30s - loss: 0.0343 - acc: 0.9882 - val_loss: 0.1171 - val_acc: 0.9698
Epoch 35/1000
 - 30s - loss: 0.0360 - acc: 0.9877 - val_loss: 0.1865 - val_acc: 0.9458
Epoch 36/1000
 - 30s - loss: 0.0377 - acc: 0.9883 - val_loss: 0.0987 - val_acc: 0.9708
Epoch 37/1000
 - 30s - loss: 0.0384 - acc: 0.9863 - val_loss: 0.0965 - val_acc: 0.9781
Epoch 38/1000
 - 30s - loss: 0.0321 - acc: 0.9894 - val_loss: 0.0803 - val_acc: 0.9781
Epoch 39/1000
 - 29s - loss: 0.0333 - acc: 0.9899 - val_loss: 0.0834 - val_acc: 0.9781
Epoch 40/1000
 - 27s - loss: 0.0339 - acc: 0.9891 - val_loss: 0.0961 - val_acc: 0.9729
Epoch 41/1000
 - 27s - loss: 0.0285 - acc: 0.9906 - val_loss: 0.0755 - val_acc: 0.9865
Epoch 42/1000
 - 29s - loss: 0.0334 - acc: 0.9895 - val_loss: 0.1450 - val_acc: 0.9698
Epoch 43/1000
 - 30s - loss: 0.0285 - acc: 0.9917 - val_loss: 0.0897 - val_acc: 0.9792
Epoch 44/1000
 - 29s - loss: 0.0312 - acc: 0.9888 - val_loss: 0.0743 - val_acc: 0.9812
Epoch 45/1000
 - 29s - loss: 0.0269 - acc: 0.9907 - val_loss: 0.1064 - val_acc: 0.9750
Epoch 46/1000
 - 30s - loss: 0.0294 - acc: 0.9910 - val_loss: 0.0992 - val_acc: 0.9802
Epoch 47/1000
 - 29s - loss: 0.0219 - acc: 0.9935 - val_loss: 0.1010 - val_acc: 0.9792
Epoch 48/1000
 - 30s - loss: 0.0340 - acc: 0.9899 - val_loss: 0.1107 - val_acc: 0.9760
Epoch 49/1000
 - 30s - loss: 0.0294 - acc: 0.9902 - val_loss: 0.1225 - val_acc: 0.9750
Epoch 50/1000
 - 30s - loss: 0.0248 - acc: 0.9916 - val_loss: 0.1109 - val_acc: 0.9760
Epoch 51/1000
 - 31s - loss: 0.0332 - acc: 0.9894 - val_loss: 0.1103 - val_acc: 0.9760
Epoch 52/1000
 - 30s - loss: 0.0311 - acc: 0.9904 - val_loss: 0.0892 - val_acc: 0.9865
Epoch 53/1000
 - 30s - loss: 0.0259 - acc: 0.9913 - val_loss: 0.0760 - val_acc: 0.9833
Epoch 54/1000
 - 30s - loss: 0.0162 - acc: 0.9946 - val_loss: 0.1119 - val_acc: 0.9812
dict_keys(['val_loss', 'acc', 'val_acc', 'loss'])
[[371   4   2   0   3   2]
 [  1 419   2   0   1   0]
 [  2   3 401   4   1   0]
 [  0   1   0 394   1   0]
 [  0   9   0   0 395   0]
 [  1  11   1   0   6 365]]
[[0.97120419 0.0104712  0.0052356  0.         0.0078534  0.0052356 ]
 [0.00236407 0.99054374 0.00472813 0.         0.00236407 0.        ]
 [0.00486618 0.00729927 0.9756691  0.00973236 0.00243309 0.        ]
 [0.         0.00252525 0.         0.99494949 0.00252525 0.        ]
 [0.         0.02227723 0.         0.         0.97772277 0.        ]
 [0.00260417 0.02864583 0.00260417 0.         0.015625   0.95052083]]
metrics: ['loss', 'acc']
Test score: [0.10043511533135946, 0.9770833333333333]
Test loss: 0.10043511533135946
Test accuracy: 0.9770833333333333
Saving model to disk 

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
time_distributed_6 (TimeDist (None, 58, 64)            78400     
_________________________________________________________________
gru_output (GRU)             (None, 128)               74112     
_________________________________________________________________
dropout_12 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_18 (Dense)             (None, 6)                 774       
=================================================================
Total params: 153,286
Trainable params: 153,286
Non-trainable params: 0
_________________________________________________________________
None
